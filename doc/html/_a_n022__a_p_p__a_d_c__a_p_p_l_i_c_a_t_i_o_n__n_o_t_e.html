<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="ADC_Page"></a>
APP ADC Module Application Note    </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.1</b></center><p><br />
 </p><center><b>2023/05/29</b></center> <div style="page-break-after: always;"></div><h2><a class="anchor" id="ADC_Rev"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.0.0.0  </td><td class="markdownTableBodyCenter">2021/10/21  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.1  </td><td class="markdownTableBodyCenter">2023/05/29  </td><td class="markdownTableBodyCenter">Revise Format   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2>Contents</h2>
<ul>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Rev">Revision History</a></li>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Table_List">Table List</a></li>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Figure_List">Figure List</a></li>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Glossary">Glossary</a></li>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Introduction">1 Introduction</a></li>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Usage">2 ADC API Usage</a><ul>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Read_IO">2.1 ADC_Interrupt_Handler</a></li>
<li><a class="el" href="_a_n022__a_p_p__a_d_c__a_p_p_l_i_c_a_t_i_o_n__n_o_t_e.html#ADC_Handle_Message">2.2 ADC_Handle_Message</a> <div style="page-break-after: always;"></div></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="ADC_Table_List"></a>
Table List</h2>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="ADC_Figure_List"></a>
Figure List</h2>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="ADC_Glossary"></a>
Glossary</h2>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="ADC_Introduction"></a>
1 Introduction</h2>
<p>The purpose of this document is to give an overview of the app adc module for customer. The document describes how to use adc module in app project. The source code consists of <b>APP_ADC</b> part. The details will be described in the following sections. </p><div style="page-break-after: always;"></div><h2><a class="anchor" id="ADC_Usage"></a>
2 ADC API Usage</h2>
<p>The purpose of this chapter is to give an overview of ADC api. The source code is in sdk\src\sample\rws\app_adc.c.</p>
<h3><a class="anchor" id="ADC_Read_IO"></a>
2.1 ADC_Interrupt_Handler</h3>
<p>User can read adc io on specific pin in the following API. </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code" href="group___a_u_d_i_o___a_d_c___exported___functions.html#ga4651f1c1483631717d97b3c49bc7a2e8">app_adc_enable_read_adc_io</a>(uint8_t input_pin)</div><div class="line">{</div><div class="line">    <span class="keywordtype">bool</span> ret = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group___a_d_c___exported___constants.html#gac996821799d76a367a1ff01c7ee5ab81">IS_ADC_CHANNEL</a>(input_pin))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">goto</span> exit;</div><div class="line">    }</div><div class="line"></div><div class="line">    target_io_pin = input_pin;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (is_adc_mgr_ever_registered)</div><div class="line">    {</div><div class="line">        <a class="code" href="group__x3e___a_d_c___m_a_n_a_g_e_r___exported___functions.html#gaa50b41c4821dcddbae2a2d868ceb7eb9">adc_mgr_enable_req</a>(application_key_adc_channel_index);</div><div class="line">        ret = <span class="keyword">true</span>;</div><div class="line">        <span class="keywordflow">goto</span> exit;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="group___p_i_n_m_u_x___exported___functions.html#ga38de86a8ea4d49c04e681494cc1c69cc">Pad_Config</a>(input_pin, <a class="code" href="group__x3e___p_a_d___mode.html#gga2cc156cba11040bcf54db2efeb9cb587a63d53e3c9ddf88d4806c1f7aa539564c">PAD_SW_MODE</a>, <a class="code" href="group__x3e___p_a_d___power___mode.html#ggac2e804c73a9d287080d1cf1207e6a177a64ef7041a073bac1e848da51333064e0">PAD_IS_PWRON</a>, <a class="code" href="group__x3e___p_a_d___pull___mode.html#ggaed6ddbb1abccbd7d16dd3dcb8319f475ace4bff5003037646cf8dd9c1ee4dc7d1">PAD_PULL_NONE</a>, <a class="code" href="group__x3e___p_a_d___output___config.html#ggacfc9e3ea370eb8401828c4b97c110dd0addca868800d517c0513e6a87c3350a00">PAD_OUT_DISABLE</a>, <a class="code" href="group__x3e___p_a_d___output___value.html#gga1bbbfd046e26ccb142c1b42f1d4dccd7a05d2e6f1ea0162d1d61ab077a5e988a5">PAD_OUT_LOW</a>);</div><div class="line">    <a class="code" href="group___p_i_n_m_u_x___exported___functions.html#gaa1159cec0022cf2643ca6b374ffed93b">Pad_PowerOrShutDownValue</a>(input_pin, 0);</div><div class="line"></div><div class="line">    <a class="code" href="group___h_a_l__87x3d___s_y_s_t_e_m___s_t_a_t_u_s___a_p_i___exported___functions.html#gae59e9a0cb8eb9fdd7d57c9aabb79174d">sys_hall_set_rglx_auxadc</a>(input_pin);</div><div class="line"></div><div class="line">    <a class="code" href="struct_a_d_c___init_type_def.html">ADC_InitTypeDef</a> ADC_InitStruct;</div><div class="line">    <a class="code" href="group__x3e___a_d_c___exported___functions.html#gae11856cf4a6ae92766f91247c8811cd3">ADC_StructInit</a>(&amp;ADC_InitStruct);</div><div class="line">    ADC_InitStruct.<a class="code" href="struct_a_d_c___init_type_def.html#a3cae8c624cc26a05bbf63b2ea912f06c">adcClock</a> = <a class="code" href="group___a_d_c___clock___config.html#gac583321cd44741a818ebc94cf4306e71">ADC_CLK_39K</a>;</div><div class="line">    ADC_InitStruct.<a class="code" href="struct_a_d_c___init_type_def.html#a02b2be7b8ce086893453d390c5fdcf1d">bitmap</a> = 0x1;</div><div class="line">    ADC_InitStruct.<a class="code" href="struct_a_d_c___init_type_def.html#a056154dd5de8b77c68387fdfcd339ae8">schIndex</a>[0] = <a class="code" href="group___a_d_c__schedule__table.html#ga056869deda8f3480fd27e806f2e7799a">EXT_SINGLE_ENDED</a>(input_pin);</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (!<a class="code" href="group__x3e___a_d_c___m_a_n_a_g_e_r___exported___functions.html#ga2be5a7b77f49c65671bf25891c48e6f4">adc_mgr_register_req</a>(&amp;ADC_InitStruct,</div><div class="line">                              (<a class="code" href="group__x3d___a_d_c___m_a_n_a_g_e_r___exported___types.html#ga8a66d0cddd729f870ffe7df4d6fc7ce1">adc_callback_function_t</a>)<a class="code" href="group___a_u_d_i_o___a_d_c___exported___functions.html#ga368e2acb9a85d77e93a290180baa74ec">app_adc_interrupt_handler</a>,</div><div class="line">                              &amp;application_key_adc_channel_index))</div><div class="line">    {</div><div class="line">        <span class="keywordflow">goto</span> exit;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        is_adc_mgr_ever_registered = <span class="keyword">true</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="group__x3e___a_d_c___m_a_n_a_g_e_r___exported___functions.html#gaa50b41c4821dcddbae2a2d868ceb7eb9">adc_mgr_enable_req</a>(application_key_adc_channel_index);</div><div class="line"></div><div class="line">exit:</div><div class="line">    <a class="code" href="group__x3d___t_r_a_c_e.html#ga56829314bea353851fa9e5bbaf8d3fa7">APP_PRINT_TRACE4</a>(<span class="stringliteral">&quot;app_adc_enable_read_adc_io: ret %d, input_pin %d, ever_registered %d, adc_channel_index %d&quot;</span>,</div><div class="line">                     ret, input_pin, is_adc_mgr_ever_registered, application_key_adc_channel_index);</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="ADC_Handle_Message"></a>
2.2 ADC_Handle_Message</h3>
<p>APP will handle adc message and report adc data in the following API. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___a_u_d_i_o___a_d_c___exported___functions.html#ga368e2acb9a85d77e93a290180baa74ec">app_adc_interrupt_handler</a>(<span class="keywordtype">void</span> *pvPara, uint32_t int_status)</div><div class="line">{</div><div class="line">    uint16_t adc_data;</div><div class="line">    uint16_t final_value[2];</div><div class="line">    uint8_t evt_param[4] = {0xFF, 0xFF, 0xFF, 0xFF};</div><div class="line"></div><div class="line">    <a class="code" href="group__x3d___a_d_c___m_a_n_a_g_e_r___exported___functions.html#ga30c669478504a2ad95d346e736262a97">adc_mgr_read_data_req</a>(application_key_adc_channel_index, &amp;adc_data, 0x0001);</div><div class="line"></div><div class="line">    final_value[0]  = <a class="code" href="group__x3e___a_d_c___exported___functions.html#gaf80fe38291ff9c94eb5ffb552f164d4e">ADC_GetHighBypassRes</a>(adc_data,</div><div class="line">                                           <a class="code" href="group___a_d_c__schedule__table.html#ga056869deda8f3480fd27e806f2e7799a">EXT_SINGLE_ENDED</a>(target_io_pin));</div><div class="line"></div><div class="line">    evt_param[0] = (uint8_t) final_value[0];</div><div class="line">    evt_param[1] = (uint8_t)(final_value[0] &gt;&gt; 8);</div><div class="line">    <a class="code" href="group__x3d___t_r_a_c_e.html#ga56829314bea353851fa9e5bbaf8d3fa7">APP_PRINT_TRACE4</a>(<span class="stringliteral">&quot;app_adc_interrupt_handler: int_status: %d, adc_data = 0x%x, Final result = 0x%02X %02X&quot;</span>,</div><div class="line">                     int_status, adc_data,</div><div class="line">                     evt_param[1], evt_param[0]);</div><div class="line"></div><div class="line">    <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gab68a0f6aaed4553d0c5bad7608f434dc">app_report_event</a>(cmd_path, <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gga7726a52eb69945b78d3a5a1463a839c7a5151fd00d6b82a72ea6c405ccb8a6c13">EVENT_REPORT_PAD_VOLTAGE</a>, app_idx, evt_param, <span class="keyword">sizeof</span>(evt_param));</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
