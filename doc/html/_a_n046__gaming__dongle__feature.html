<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="Gaming_Dongle_Feature_Page"></a>
Gaming Dongle Feature Application Note    </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.3</b></center><p><br />
 </p><center><b>2023/07/31</b></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Doc_Rev"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V2.1.1.0  </td><td class="markdownTableBodyCenter">2021/09/23  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V2.1.1.1  </td><td class="markdownTableBodyCenter">2022/07/21  </td><td class="markdownTableBodyCenter">Revise naming   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V2.1.1.2  </td><td class="markdownTableBodyCenter">2022/08/09  </td><td class="markdownTableBodyCenter">Optimize content   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.3  </td><td class="markdownTableBodyCenter">2023/07/31  </td><td class="markdownTableBodyCenter">Change version number to 2 digits &amp; Optimize content   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2>Contents</h2>
<ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Doc_Rev">Revision History</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Doc_Table_List">Table List</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Doc_Figure_List">Figure List</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Doc_Glossary">Glossary</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Dongle_Feature_Introduction">1 Introduction</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Dongle_Feature_Enable">2 Enable Gaming Dongle Feature</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#How_to_Identify">3 How to Identify</a><ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Headset_Identify_Dongle">3.1 How Headset to Identify Dongle</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Dongle_Identify_Headset">3.2 How Dongle to Identify Headset</a></li>
</ul>
</li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Private_SPP_Channel_Data_Format">4 Private SPP Channel &amp; SPP Data Format</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Voice_over_SPP">5 Voice over SPP</a><ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Flow_Chart_of_Starting_Mic_Recording">5.1 Flow Chart of Starting Mic Recording</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Flow_Chart_of_Stopping_Mic_Recording">5.2 Flow Chart of Stopping Mic Recording</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Formats_of_SPP_Voice">5.3 Data Formats of Command and Voice Packet</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Parameters_of_Voice_Data">5.4 Parameters of Voice Data</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#MicMute_Toggle_LED">5.5 Microphone Mute/Unmute LED</a></li>
</ul>
</li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Mode_for_Dongle">6 Low-Latency Gaming Mode</a><ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Enter_or_Exit_Gaming_Mode">6.1 Enter/Exit Low-Latency Gaming Mode</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Format_of_Gaming_Mode_commands">6.2 Gaming Mode Command Format</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Other_gaming_mode_related_behaviors">6.3 Other Low-Latency Gaming Mode Behaviors</a></li>
</ul>
</li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Game_Chat_Volume_Headset_Control">7 Game-Chat Volume Control</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Dual_Mode_Support">8 Dual-Mode</a><ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#How_Setup_Dual_Mode">8.1 How to Setup Dual Mode</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Pre_Pair_Up_Flow">8.2 Pre-pair Up Dongle and Headset</a></li>
</ul>
</li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Audio_Source_Switch">9 Dongle/BT Audio Source Switch</a><ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#How_Setup_Source_Switch">9.1 How to Setup Dongle/BT Audio Source Switch</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Audio_Source_Switch_Implement_Description">9.2 Implement Description</a></li>
</ul>
</li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Dual_Mode_Multi_Pairing">10 Dual Mode Multi-pairing</a><ul>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#How_Setup_Multi_Pairing">10.1 How to Setup Dual Mode Multi-pairing</a></li>
<li><a class="el" href="_a_n046__gaming__dongle__feature.html#Multi_Pairing_More_Description">10.2 More Description</a></li>
</ul>
</li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Doc_Table_List"></a>
Table List</h2>
<ul>
<li><a href="#table_3_1">Table 3-1 EIR Data Format</a></li>
<li><a href="#table_4_1">Table 4-1 SPP Data Format</a></li>
<li><a href="#table_5_1">Table 5-1 Turn On/Off Headset's Mircophone Command Format</a></li>
<li><a href="#table_5_2">Table 5-2 Voice Packet Data Format</a></li>
<li><a href="#table_5_3">Table 5-3 Parameters of Voice Data</a></li>
<li><a href="#table_6_1">Table 6-1 Gaming Mode Commonad Initiated by Headset</a></li>
<li><a href="#table_6_2">Table 6-2 Gaming Mode Commonad Sent by Dongle</a></li>
<li><a href="#table_7_1">Table 7-1 Volume Setting Command Sent by Headset</a></li>
<li><a href="#table_7_2">Table 7-2 Volume Notification Command Sent by Dongle</a></li>
<li><a href="#table_8_1">Table 8-1 Dual Mode Setting and Expected Result (Disable Multi-link)</a></li>
<li><a href="#table_8_2">Table 8-2 Dual Mode Setting and Expected Result (Enable Multi-link)</a></li>
<li><a href="#table_10_1">Table 10-1 Multi-Pairing Expected Result</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Doc_Figure_List"></a>
Figure List</h2>
<ul>
<li><a href="#figure_5_1">Figure 5-1 Start mic recording</a></li>
<li><a href="#figure_5_2">Figure 5-2 Stop mic recording</a></li>
<li><a href="#figure_5_3">Figure 5-3 Key mmi to mute/unmte microphone</a></li>
<li><a href="#figure_5_4">Figure 5-4 Feautre setting of output indication 3</a></li>
<li><a href="#figure_5_5">Figure 5-5 Pinmux setting of output indication 3</a></li>
<li><a href="#figure_8_1">Figure 8-1 Dual mode setting in headset (General subtab)</a></li>
<li><a href="#figure_8_2">Figure 8-2 Dual mode setting in dongle (Dongle subtab)</a></li>
<li><a href="#figure_8_3">Figure 8-3 Key mmi to switch mode</a></li>
<li><a href="#figure_8_4">Figure 8-4 Exit/Enter 2.4G mode ringtone setting</a></li>
<li><a href="#figure_8_5">Figure 8-5 Power on in BT mode ringtone setting</a></li>
<li><a href="#figure_9_1">Figure 9-1 Audio source switch setting (General subtab)</a></li>
<li><a href="#figure_9_2">Figure 9-2 Audio source switch key setting</a></li>
<li><a href="#figure_9_3">Figure 9-3 Audio source switch ringtone setting</a></li>
<li><a href="#figure_10_1">Figure 10-1 Figure 10-1 Multi-Pairing setting (General subtab)</a></li>
<li><a href="#figure_10_2">Figure 10-2 Figure 10-2 Pairing mode switch key setting</a></li>
<li><a href="#figure_10_3">Figure 10-3 Figure 10-3 Multi-Pairing ringtone setting</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Doc_Glossary"></a>
Glossary</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Terms  </th><th class="markdownTableHeadCenter">Definitions   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Dongle  </td><td class="markdownTableBodyCenter">Gaming dongle   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">2.4G  </td><td class="markdownTableBodyCenter">Wireless connection with dongle   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">SPP  </td><td class="markdownTableBodyCenter">Serial Port Profile   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">DID  </td><td class="markdownTableBodyCenter">Declaration Identification   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">VID  </td><td class="markdownTableBodyCenter">Vendor Identification   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">PID  </td><td class="markdownTableBodyCenter">Product Identification   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">EIR  </td><td class="markdownTableBodyCenter">Extended Inquiry Response   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">UUID  </td><td class="markdownTableBodyCenter">Universally Unique Identifier   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">APT  </td><td class="markdownTableBodyCenter">Audio Passthrough   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">UAC  </td><td class="markdownTableBodyCenter">USB Audio Class   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">MMI  </td><td class="markdownTableBodyCenter">Man-Machine Interface   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Dongle_Feature_Introduction"></a>
1 Introduction</h2>
<p>This feature is a combination solution for low-latency media playing. <br />
 It is composed of two portions: headset and dongle.</p>
<p>This document would introduce how headset and dongle to identify each other. <br />
 Besides, it would introduce major features in this combination solution: <br />
</p><ul>
<li>Voice over SPP</li>
<li>Low-latency gaming mode</li>
<li>Gaming-chat volume control</li>
<li>Dual-mode</li>
<li>Audio source switch</li>
<li>Multi-pairing</li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Dongle_Feature_Enable"></a>
2 Enable Gaming Dongle Feature</h2>
<p>Define and set both F_APP_COMMON_DONGLE_SUPPORT and F_APP_GAMING_DONGLE_SUPPORT to 1 in app_flags.h:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#undef F_APP_COMMON_DONGLE_SUPPORT</span></div><div class="line"><span class="preprocessor">#define F_APP_COMMON_DONGLE_SUPPORT                 1</span></div><div class="line"><span class="preprocessor">#undef F_APP_GAMING_DONGLE_SUPPORT</span></div><div class="line"><span class="preprocessor">#define F_APP_GAMING_DONGLE_SUPPORT                 1</span></div></div><!-- fragment --><div style="page-break-after: always;"></div><h2><a class="anchor" id="How_to_Identify"></a>
3 How to Identify</h2>
<h3><a class="anchor" id="Headset_Identify_Dongle"></a>
3.1  How Headset to Identify Dongle</h3>
<p>Headset would parse DID information to identify dongle. <br />
 The VID of dongle should be 0x0bda and the PID should be 0x875a or 0x875b.</p>
<p>Notice: As long as headset adds dongle to paired record list, headset would keep it even doing factory reset.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_bt_policy_cback(<a class="code" href="group___b_t___b_t_m.html#ga60f938d2fe9ea1ac81e1bf400fbb5b03">T_BT_EVENT</a> event_type, <span class="keywordtype">void</span> *event_buf, uint16_t buf_len)</div><div class="line">{</div><div class="line">    ...</div><div class="line">    <span class="keywordflow">switch</span> (event_type)</div><div class="line">    {</div><div class="line">        ...</div><div class="line">        <span class="keywordflow">case</span>  <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a6bbae55a6e762c61de79376a2349fb36">BT_EVENT_DID_ATTR_INFO</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link = <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;did_attr_info.bd_addr);</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                ...</div><div class="line">#<span class="keywordflow">if</span> <a class="code" href="group___a_p_p___f_l_a_g_s.html#ga7f12ca0ce19d1586136507b6156370b4">F_APP_GAMING_DONGLE_SUPPORT</a></div><div class="line">                <span class="keywordflow">if</span> ((param-&gt;did_attr_info.vendor_id == 0x0bda) &amp;&amp;</div><div class="line">                    ((param-&gt;did_attr_info.product_id == 0x875a) || (param-&gt;did_attr_info.product_id == 0x875b)))</div><div class="line">                {</div><div class="line">                    memcpy(<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.connected_dongle_addr, param-&gt;did_attr_info.bd_addr, 6);</div><div class="line">                    app_bond_add_dongle_bond_info(param-&gt;acl_conn_success.bd_addr);</div><div class="line">                    app_audio_update_dongle_flag(<span class="keyword">true</span>);</div><div class="line">                    ...</div><div class="line">                }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">            }</div><div class="line">            ...</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        ...</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> app_audio_update_dongle_flag(<span class="keywordtype">bool</span> is_dongle)</div><div class="line">{</div><div class="line">    <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#add2ad2bcc1338d9e647512d708d3837a">remote_is_dongle</a> = is_dongle;</div><div class="line">    ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> app_bond_add_dongle_bond_info(uint8_t *bd_addr)</div><div class="line">{</div><div class="line">    <a class="code" href="group___b_t___b_o_n_d.html#gab518c31dd6edd77fddabc12a4d51b628">bt_bond_flag_add</a>(bd_addr, <a class="code" href="group___a_p_p___b_o_n_d.html#gab373b3671fd98891d2dbb440b5e3ee71">BOND_FLAG_DONGLE</a>);</div><div class="line">    ...</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Dongle_Identify_Headset"></a>
3.2  How Dongle to Identify Headset</h3>
<p>Dongle would parse EIR information to identify headset. <br />
 Headset would set EIR by app_dongle_common_set_ext_eir() when receiving stack is ready event.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_dongle_common_device_event_cback(uint32_t event, <span class="keywordtype">void</span> *msg)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span> (event_type)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___a_p_p___d_e_v_i_c_e___exported___types.html#ggab2829854a3f48d833bd5223cfd8e2013af00e834d5f17981e96a8a6db06d4832c">APP_DEVICE_IPC_EVT_STACK_READY</a>:</div><div class="line">        {</div><div class="line">            app_dongle_common_set_ext_eir();</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    ...</div><div class="line">    }</div><div class="line">    ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_dongle_common_set_ext_eir(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    uint8_t p_eir[10];</div><div class="line"></div><div class="line">    p_eir[0] = 9; <span class="comment">/* length */</span></div><div class="line">    p_eir[1] = 0xFF;</div><div class="line">    p_eir[2] = 0x5D;</div><div class="line">    p_eir[3] = 0x00;</div><div class="line">    p_eir[4] = 0x08;</div><div class="line">    p_eir[5] = (<a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#ga8abebda5e5684f156a3b260df6428b61">remote_session_role_get</a>() == <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#ggad48900c988433e8bd9e07b08a225fdf4a673a27baaad47fd731a4458b2250a6a6">REMOTE_SESSION_ROLE_SINGLE</a>) ? 0x02 : 0x03;</div><div class="line">    p_eir[6] = 0x0;</div><div class="line"></div><div class="line">    <span class="comment">//Set pairing ID</span></div><div class="line">    p_eir[7] = (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#af94a7f2435052671a1eb336b7f320955">rws_custom_uuid</a> &gt;&gt; 8);</div><div class="line">    p_eir[8] = <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#af94a7f2435052671a1eb336b7f320955">rws_custom_uuid</a> &amp; 0xFF;</div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">        bit 1~0: Set SPP Voice Sample Rate.</span></div><div class="line"><span class="comment">        bit   2: Set Multilink feature bit.</span></div><div class="line"><span class="comment">        bit 7~3: rsv.</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    p_eir[9] = <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a8cd72eddf59d47cd3db58b283fb059de">spp_voice_smaple_rate</a> &amp; 0x03;</div><div class="line">    p_eir[9] |= <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a47f24c2f2ebe65db84a6a5a37bf9021a">enable_multi_link</a> &lt;&lt; 2;</div><div class="line"></div><div class="line">    <a class="code" href="group___g_a_p___b_r_e_d_r.html#ga0fde5e14a3158f7ed117be25737e8342">gap_br_set_ext_eir</a>(&amp;p_eir[0], 10);</div><div class="line">}</div></div><!-- fragment --><p>Detail description about data format of EIR is shown in the table below:</p>
<center><div id="table_3_1"><b>Table 3-1 EIR Data Format</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x09 </td><td>Payload length  </td></tr>
<tr>
<td>Byte 1 </td><td>ALL </td><td>0xFF </td><td>Manufacturer Specific  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>0x5D </td><td></td></tr>
<tr>
<td>Byte 3 </td><td>ALL </td><td>0x00 </td><td></td></tr>
<tr>
<td>Byte 4 </td><td>ALL </td><td>0x08 </td><td></td></tr>
<tr>
<td rowspan="4">Byte 5 </td><td>BIT 0 </td><td>0 </td><td>0: Stereo <br />
 1: TWS  </td></tr>
<tr>
<td>BIT 1 </td><td>1 </td><td></td></tr>
<tr>
<td>BIT 2 </td><td>0 </td><td>0: Support microphone <br />
 1: Not support microphone  </td></tr>
<tr>
<td>BIT [3~7] </td><td>0 </td><td>Reserved  </td></tr>
<tr>
<td>Byte 6 </td><td>ALL </td><td>0x00 </td><td></td></tr>
<tr>
<td>Byte [7~8] </td><td>ALL </td><td>Pairing ID </td><td>This value would be set via MCU config tool in RWS subtab. <br />
 <div class="image">
<img src="DONGLE_RWS_PARING_ID.png" alt="DONGLE_RWS_PARING_ID.png"/>
</div>
   </td></tr>
<tr>
<td rowspan="3">Byte 9 </td><td>BIT [0~1] </td><td>Sample rate used in voice over SPP </td><td>0: 16K <br />
 1: 32K <br />
 2&amp;3 : Reserved <br />
 This value would be set via MCU config tool in Audio subtab.<br />
 <div class="image">
<img src="SPP_Voice_Sample_Rate_setting.png" alt="SPP_Voice_Sample_Rate_setting.png"/>
</div>
   </td></tr>
<tr>
<td>BIT 2 </td><td>Multi-link support </td><td>0: Disable Multi-link support <br />
 1: Enable Multi-link support <br />
 This value would be set via MCU config tool in General subtab.<br />
 <div class="image">
<img src="ui_option_multi_link_support.png" alt="ui_option_multi_link_support.png"/>
</div>
   </td></tr>
<tr>
<td>BIT [3~7] </td><td>0 </td><td>Reserved  </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Private_SPP_Channel_Data_Format"></a>
4 Private SPP Channel &amp; SPP Data Format</h2>
<p>Headset communicates with dongle via SPP on channel RFC_SPP_DONGLE_CHANN_NUM.</p>
<p>The SPP service UUID is defined in dongle_service_class_uuid128.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define RFC_SPP_DONGLE_CHANN_NUM        17</span></div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> uint8_t dongle_service_class_uuid128[16] =</div><div class="line">{</div><div class="line">    0x12, 0xA2, 0x4D, 0x2E, 0xFE, 0x14, 0x48, 0x8e, 0x93, 0xD2, 0x17, 0x3C, 0x5A, 0x01, 0x00, 0x00</div><div class="line">};</div></div><!-- fragment --><p>The SPP data transmitted between headset and gaming dongle has a specific format as shown in the table below.</p>
<center><div id="table_4_1"><b>Table 4-1 SPP Data Format</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th>Byte </th><th>Bit </th><th>Description </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>SPP data start byte </td><td>Value is 0x52  </td></tr>
<tr>
<td rowspan="2">Byte 1 </td><td>BIT [0~1] </td><td>Data type </td><td>0: Voice packet <br />
 1: Command packet <br />
 2&amp;3: Reserved  </td></tr>
<tr>
<td>BIT [2~7] </td><td></td><td>NOT used now  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>Payload length </td><td></td></tr>
<tr>
<td>Byte [3 ~ (len+2)] </td><td>ALL </td><td>Payload </td><td></td></tr>
<tr>
<td>Byte (len+3) </td><td>ALL </td><td>SPP data stop byte </td><td>Value is 0x54  </td></tr>
</table>
<p>Current used command type: </p><div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line">{</div><div class="line">    DONGLE_CMD_SET_GAMING_MOE           = 0x01,</div><div class="line">    DONGLE_CMD_REQUEST_GAMING_MOE       = 0x02,</div><div class="line">    DONGLE_CMD_REQ_OPEN_MIC             = 0x03,</div><div class="line">    DONGLE_CMD_SET_VOL_BALANCE          = 0x06,</div><div class="line">    DONGLE_CMD_CTRL_RAW_DATA            = 0x08,</div><div class="line">    DONGLE_CMD_PASS_THROUGH_DATA        = 0x10,</div><div class="line">    DONGLE_CMD_CFU_DATA                 = 0x11,</div><div class="line">    DONGLE_CMD_MTE_DATA                 = 0x12,</div><div class="line">    DONGLE_CMD_VP_UPDATE_DATA           = 0x13,</div><div class="line">} T_APP_DONGLE_CMD;</div></div><!-- fragment --><div style="page-break-after: always;"></div><h2><a class="anchor" id="Voice_over_SPP"></a>
5 Voice over SPP</h2>
<h3><a class="anchor" id="Flow_Chart_of_Starting_Mic_Recording"></a>
5.1 Flow Chart of Starting Mic Recording</h3>
<p>Due to voice over SPP is conflicts with APT. As a result, APT should be turned off before recording.</p>
<div class="image">
<img src="Flow_chart_of_enable_mic.png" alt="Flow_chart_of_enable_mic.png"/>
</div>
 <center><div id="figure_5_1"><b>Figure 5-1 Start mic recording</b></div></center><h3><a class="anchor" id="Flow_Chart_of_Stopping_Mic_Recording"></a>
5.2 Flow Chart of Stopping Mic Recording</h3>
<div class="image">
<img src="Flow_chart_of_disable_mic.png" alt="Flow_chart_of_disable_mic.png"/>
</div>
 <center><div id="figure_5_2"><b>Figure 5-2 Stop mic recording</b></div></center><h3><a class="anchor" id="Formats_of_SPP_Voice"></a>
5.3 Data Formats of Command and Voice Packet</h3>
<p>Headset's microphone would be turned on/off by dongle. <br />
 Dongle would send relevant commands to inform headset. <br />
 The command format is shown in the table below:</p>
<center><div id="table_5_1"><b>Table 5-1 Turn On/Off Headset's Mircophone Command Format</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th colspan="4">Dongle requestes to turn on/off headset's microphone  </th></tr>
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x52 </td><td>Data start byte  </td></tr>
<tr>
<td>Byte 1 </td><td>ALL </td><td>0x01 </td><td>Date type (Command packet)  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>0x02 </td><td>Payload length  </td></tr>
<tr>
<td>Byte 3 </td><td>ALL </td><td>0x03 </td><td>Command type <br />
 (Request to turn on/off microphone) </td></tr>
<tr>
<td>Byte 4 </td><td>ALL </td><td>0x1 or 0x0 </td><td>0x1: turn on microphone <br />
 0x0: turn off microphone  </td></tr>
<tr>
<td>Byte 5 </td><td>ALL </td><td>0x54 </td><td>Data stop byte  </td></tr>
</table>
<p>The format of voice packet transmitted from Headset to dongle is shown below:</p>
<center><div id="table_5_2"><b>Table 5-2 Voice Packet Data Format</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th colspan="4">Voice packets sent to gaming dongle  </th></tr>
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x52 </td><td>Data start byte  </td></tr>
<tr>
<td rowspan="2">Byte 1 </td><td>BIT [0~1] </td><td>0x00 </td><td>Date type (Voice packet)  </td></tr>
<tr>
<td>BIT [2~7] </td><td>0x0 </td><td>NOT used now  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>len </td><td>Payload length </td></tr>
<tr>
<td>Byte [3 ~ (len+2)] </td><td>ALL </td><td>voice data </td><td>Encoded microphone data from DSP  </td></tr>
<tr>
<td>Byte (len+3) </td><td>ALL </td><td>0x54 </td><td>Data stop byte  </td></tr>
</table>
<h3><a class="anchor" id="Parameters_of_Voice_Data"></a>
5.4 Parameters of Voice Data</h3>
<p>The voice data is SBC encoded and the SBC parameters are shown in the table below:</p>
<center><div id="table_5_3"><b>Table 5-3 Parameters of Voice Data</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<td>sample rate </td><td>16k/32k <br />
(According to MCU config tool)  </td></tr>
<tr>
<td>channel mode </td><td>Mono  </td></tr>
<tr>
<td>block length </td><td>16  </td></tr>
<tr>
<td>subband number </td><td>8  </td></tr>
<tr>
<td>allocation method </td><td>Loudness  </td></tr>
<tr>
<td>bitpool </td><td>22  </td></tr>
</table>
<h3><a class="anchor" id="MicMute_Toggle_LED"></a>
5.5 Microphone Mute/Unmute LED</h3>
<p>It is a feature in headset, it helps to show the the mute/unmute status of the microphone via led. <br />
</p>
<p>To switch microphone mute/unmute, a key should be set in MCU config tool.</p>
<div class="image">
<img src="MicMuteKey.png" alt="MicMuteKey.png"/>
</div>
 <center><div id="figure_5_3"><b>Figure 5-3 Key mmi to mute/unmte microphone</b></div></center><p>Besides, this feature is relied on output indication 3. <br />
 User should connect a led to the pin mapping to output indication 3. <br />
 The pin would be pulled high/low according to the setting when microphone is muted or unmuted.</p>
<div class="image">
<img src="MicMuteToggleLed.png" alt="MicMuteToggleLed.png"/>
</div>
 <center><div id="figure_5_4"><b>Figure 5-4 Feautre setting of output indication 3</b></div></center><div class="image">
<img src="OutputIndicationPinmux.png" alt="OutputIndicationPinmux.png"/>
</div>
 <center><div id="figure_5_5"><b>Figure 5-5 Pinmux setting of output indication 3</b></div></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="Gaming_Mode_for_Dongle"></a>
6 Low-Latency Gaming Mode</h2>
<p>Headset will be low-latency gaming mode when streaming device is dongle. </p>
<h3><a class="anchor" id="Enter_or_Exit_Gaming_Mode"></a>
6.1 Enter/Exit Low-Latency Gaming Mode</h3>
<p>To enter/exit low-latency gaming mode is initiated by headset, dongle would send corresponding command to headset. <br />
 However, we don't expect that headset is not at low-latency gaming mode when streaming device is dongle.</p>
<h3><a class="anchor" id="Format_of_Gaming_Mode_commands"></a>
6.2 Gaming Mode Command Format</h3>
<p>The following two tables are the SPP data format of command initiated by headset and command sent by dongle respectively.</p>
<center><div id="table_6_1"><b>Table 6-1 Gaming Mode Commonad Initiated by Headset</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th colspan="4">Command sent by headset  </th></tr>
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x52 </td><td>Data start byte  </td></tr>
<tr>
<td>Byte 1 </td><td>ALL </td><td>0x01 </td><td>Date type (Command packet)  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>0x02 </td><td>Payload length  </td></tr>
<tr>
<td>Byte 3 </td><td>ALL </td><td>0x02 </td><td>Command type <br />
 (Request Gaming Mode) </td></tr>
<tr>
<td>Byte 4 </td><td>ALL </td><td>0x1 or 0x0 </td><td>0x1: Enter gaming mode <br />
 0x0: Exit gaming mode  </td></tr>
<tr>
<td>Byte 5 </td><td>ALL </td><td>0x54 </td><td>Data stop byte  </td></tr>
</table>
<p><br />
</p>
<center><div id="table_6_2"><b>Table 6-2 Gaming Mode Commonad Sent by Dongle</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th colspan="4">Command sent by dongle  </th></tr>
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x52 </td><td>Data start byte  </td></tr>
<tr>
<td>Byte 1 </td><td>ALL </td><td>0x01 </td><td>Date type (Command packet)  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>0x02 </td><td>Payload length  </td></tr>
<tr>
<td>Byte 3 </td><td>ALL </td><td>0x01 </td><td>Command type <br />
 (Set Gaming Mode) </td></tr>
<tr>
<td>Byte 4 </td><td>ALL </td><td>0x1 or 0x0 </td><td>0x1: Enter gaming mode <br />
 0x0: Exit gaming mode  </td></tr>
<tr>
<td>Byte 5 </td><td>ALL </td><td>0x54 </td><td>Data stop byte  </td></tr>
</table>
<h3><a class="anchor" id="Other_gaming_mode_related_behaviors"></a>
6.3 Other Low-Latency Gaming Mode Behaviors</h3>
<ol type="1">
<li>When headset connectes to dongle, dongle will send exit gaming mode command after A2DP open message.</li>
<li>Headset will not enter sniff mode in low-latency gaming mode.</li>
<li>Headset will exit low-latency gaming mode when dongle link is disconnected.</li>
</ol>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Game_Chat_Volume_Headset_Control"></a>
7 Game-Chat Volume Control</h2>
<p>This feature allows user to adjust the volume of game/chat individually. Therefore, dongle must support dual UAC. <br />
 The following two tables are the SPP data format of command sent by headset and command sent by dongle respectively.</p>
<center><div id="table_7_1"><b>Table 7-1 Volume Setting Command Sent by Headset</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th colspan="4">Setting message sent by dongle  </th></tr>
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x52 </td><td>Data start byte  </td></tr>
<tr>
<td>Byte 1 </td><td>ALL </td><td>0x01 </td><td>Date type (Command packet)  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>0x04 </td><td>Payload length  </td></tr>
<tr>
<td>Byte 3 </td><td>ALL </td><td>0x06 </td><td>Command type <br />
 (Set volume balance) </td></tr>
<tr>
<td>Byte 4 </td><td>ALL </td><td>0x0: Ack <br />
 0x2: Update </td><td>message type  </td></tr>
<tr>
<td>Byte 5 </td><td>ALL </td><td>0x0~ 0x64 </td><td>gaming volume level  </td></tr>
<tr>
<td>Byte 6 </td><td>ALL </td><td>0x0~ 0x64 </td><td>chat volume level  </td></tr>
<tr>
<td>Byte 7 </td><td>ALL </td><td>0x54 </td><td>Data stop byte  </td></tr>
</table>
<p><br />
</p>
<center><div id="table_7_2"><b>Table 7-2 Volume Notification Command Sent by Dongle</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<th colspan="4">Notification message sent by dongle  </th></tr>
<tr>
<th>Byte </th><th>Bit </th><th>Value </th><th>Notes  </th></tr>
<tr>
<td>Byte 0 </td><td>ALL </td><td>0x52 </td><td>Data start byte  </td></tr>
<tr>
<td>Byte 1 </td><td>ALL </td><td>0x01 </td><td>Date type (Command packet)  </td></tr>
<tr>
<td>Byte 2 </td><td>ALL </td><td>0x04 </td><td>Payload length  </td></tr>
<tr>
<td>Byte 3 </td><td>ALL </td><td>0x06 </td><td>Command type <br />
 (Set volume balance) </td></tr>
<tr>
<td>Byte 4 </td><td>ALL </td><td>0x1: Inform </td><td>message type  </td></tr>
<tr>
<td>Byte 5 </td><td>ALL </td><td>0x0~ 0x64 </td><td>gaming volume level  </td></tr>
<tr>
<td>Byte 6 </td><td>ALL </td><td>0x0~ 0x64 </td><td>chat volume level  </td></tr>
<tr>
<td>Byte 7 </td><td>ALL </td><td>0x54 </td><td>Data stop byte  </td></tr>
</table>
<p>API: app_dongle_update_volume_balance() is used to update volume balance information recorded in headset to dongle. <br />
 Parameters gaming_level and chat_level stand for the volume of game and the volume of chat respectively. The range of gaming_level and chat_level is 0~100, which stands for 0% ~ 100%.</p><ul>
<li>usage example: <div class="fragment"><div class="line">app_dongle_update_volume_balance(gaming_level, chat_level);</div></div><!-- fragment --></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Dual_Mode_Support"></a>
8 Dual-Mode</h2>
<p>Since enable this feature, two modes named 2.4G mode and BT mode are available in headset. <br />
 <b>2.4G mode</b>: Headset ONLY could be searched and connected by dongle. <br />
 <b>BT mode</b>: All bluetooth devices except dongle could search and connect to headset. <br />
</p>
<p>Following tables summarize the combination and expected result.</p>
<center><div id="table_8_1"><b>Table 8-1 Dual Mode Setting and Expected Result (Disable Multi-link)</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<td colspan="2" rowspan="2"></td><th colspan="3">Headset   </th></tr>
<tr>
<th>Disable dual mode </th><th>Enable dual mode - 2.4G mode </th><th>Enable dual mode - BT mode  </th></tr>
<tr>
<th rowspan="2">Dongle </th><th>Disable dual mode </th><td>Headset could be connected by dongle or other bluetooth devices </td><td align="center">Not support this case </td><td align="center">Not support this case  </td></tr>
<tr>
<th>Enable dual mode </th><td align="center">Not support this case </td><td>Headset ONLY could be connected by dongle </td><td>Headset could be connected by bluetooth devices except dongle  </td></tr>
</table>
<p><br />
</p>
<center><div id="table_8_2"><b>Table 8-2 Dual Mode Setting and Expected Result (Enable Multi-link)</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<td colspan="2" rowspan="2"></td><th colspan="3">Headset   </th></tr>
<tr>
<th>Disable dual mode </th><th>Enable dual mode - 2.4G mode only </th><th>Enable dual mode - 2.4G + BT mode  </th></tr>
<tr>
<th rowspan="2">Dongle </th><th>Disable dual mode </th><td>Headset could be connected by dongle or other bluetooth devices </td><td align="center">Not support this case </td><td align="center">Not support this case  </td></tr>
<tr>
<th>Enable dual mode </th><td align="center">Not support this case </td><td>Headset ONLY could be connected by dongle </td><td>Headset could be connected by dongle or other bluetooth devices  </td></tr>
</table>
<div style="page-break-after: always;"></div><h3><a class="anchor" id="How_Setup_Dual_Mode"></a>
8.1 How to Setup Dual Mode</h3>
<p>Users could find out option in MCU config tool. </p><div class="image">
<img src="dual_mode_option_in_earphone.png" alt="dual_mode_option_in_earphone.png"/>
</div>
 <center><div id="figure_8_1"><b>Figure 8-1 Dual mode setting in headset (General subtab)</b></div></center><p><br />
</p>
<div class="image">
<img src="dual_mode_option_in_gaming_dongle.png" alt="dual_mode_option_in_gaming_dongle.png"/>
</div>
 <center><div id="figure_8_2"><b>Figure 8-2 Dual mode setting in dongle (Dongle subtab)</b></div></center><div style="page-break-after: always;"></div><p> In order to switch mode, a key should be set in MCU config tool. </p><div class="image">
<img src="dual_mode_switch_key_setting.png" alt="dual_mode_switch_key_setting.png"/>
</div>
 <center><div id="figure_8_3"><b>Figure 8-3 Key mmi to switch mode</b></div></center><p>Besides, user could setup ringtones in MCU config tool. It helps to distinguish headset in which mode. </p><div class="image">
<img src="dual_mode_exit_enter_dongle_mode.png" alt="dual_mode_exit_enter_dongle_mode.png"/>
</div>
 <center><div id="figure_8_4"><b>Figure 8-4 Exit/Enter 2.4G mode ringtone setting</b></div></center><div class="image">
<img src="dual_mode_bt_pwr_on.png" alt="dual_mode_bt_pwr_on.png"/>
</div>
 <center><div id="figure_8_5"><b>Figure 8-5 Power on in BT mode ringtone setting</b></div></center><h3><a class="anchor" id="Pre_Pair_Up_Flow"></a>
8.2 Pre-pair Up Dongle and Headset</h3>
<p>In order to speed up pair up process, we provide a pre-pair up flow. <br />
 As long as user writes the last three bytes of headset's MAC address in dongle, dongle would ONLY connect to the headset with the specific last three bytes MAC address.</p>
<div class="fragment"><div class="line"><span class="comment">//used to record last three bytes MAC addres for pre-pair up process</span></div><div class="line"><a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="group___a_p_p___c_f_g.html#gaf91498eb5d0e7665e81f90adc4e6170f">saved_id</a></div></div><!-- fragment --><div style="page-break-after: always;"></div><h2><a class="anchor" id="Audio_Source_Switch"></a>
9 Dongle/BT Audio Source Switch</h2>
<p>This feature allows user to specify which streaming device to play media. </p>
<h3><a class="anchor" id="How_Setup_Source_Switch"></a>
9.1 How to Setup Dongle/BT Audio Source Switch</h3>
<p>Users could find out option in MCU config tool. <br />
 Notice: the option "Enable Multilink Support" in General Tab should be checked. </p><div class="image">
<img src="source_switch_option_in_earphone.png" alt="source_switch_option_in_earphone.png"/>
</div>
 <center><div id="figure_9_1"><b>Figure 9-1 Audio source switch setting (General subtab)</b></div></center><p>Define and set both F_APP_GAMING_DONGLE_SUPPORT and F_APP_24G_BT_AUDIO_SOURCE_CTRL_SUPPORT to 1 in app_flags.h: </p><div class="fragment"><div class="line"><span class="preprocessor">#undef F_APP_GAMING_DONGLE_SUPPORT</span></div><div class="line"><span class="preprocessor">#define F_APP_GAMING_DONGLE_SUPPORT                 1</span></div><div class="line"><span class="preprocessor">#undef F_APP_24G_BT_AUDIO_SOURCE_CTRL_SUPPORT</span></div><div class="line"><span class="preprocessor">#define F_APP_24G_BT_AUDIO_SOURCE_CTRL_SUPPORT      1</span></div></div><!-- fragment --><div style="page-break-after: always;"></div><p>In order to switch source between dongle and BT device, a key should be set in MCU config tool. </p><div class="image">
<img src="source_switch_key_setting.png" alt="source_switch_key_setting.png"/>
</div>
 <center><div id="figure_9_2"><b>Figure 9-2 Audio source switch key setting</b></div></center><p>Besides, user could setup ringtones in MCU config tool. It helps users to distinguish source is selected to which device. </p><div class="image">
<img src="source_switch_tone.png" alt="source_switch_tone.png"/>
</div>
 <center><div id="figure_9_3"><b>Figure 9-3 Audio source switch ringtone setting</b></div></center><h3><a class="anchor" id="Audio_Source_Switch_Implement_Description"></a>
9.2 Implement Description</h3>
<p>In order to achieve this feature, headset would ONLY connect AVRCP and A2DP with selected device.</p>
<p>For instance, if headset connects to dongle and BT device simultaneously. User selects allowed source to dongle, headset would disconnect AVRCP and A2DP with BT device and connect AVRCP and A2DP with dongle.</p>
<p>If headset is not connected with two device, user presses switch key, headset still would do corresponding action.</p>
<div class="fragment"><div class="line"><span class="comment">//used to records currently allowed audio source</span></div><div class="line"><a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a3d18af376c8e61838b4ebde128664c01">allowed_source</a></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line">{</div><div class="line">    ALLOWED_SOURCE_DONGLE   = 0x00,  <span class="comment">// dongle</span></div><div class="line">    ALLOWED_SOURCE_BT       = 0x01,  <span class="comment">// other BT devices</span></div><div class="line">} T_ALLOWED_SOURCE;</div></div><!-- fragment --><div style="page-break-after: always;"></div><h2><a class="anchor" id="Dual_Mode_Multi_Pairing"></a>
10 Dual Mode Multi-pairing</h2>
<p>Since enable this feature, pairing mode would become 2.4G pairing mode and BT pairing mode. <br />
 Notice: this feature ONLY takes effect when headset is 2.4G + BT mode. </p>
<h3><a class="anchor" id="How_Setup_Multi_Pairing"></a>
10.1 How to Setup Dual Mode Multi-pairing</h3>
<p>Notice: the option "Enable Multilink Support" and "Enable Dongle Dual Mode" in General subtab should be checked. </p><div class="image">
<img src="multi_pairing_option_in_earphone.png" alt="multi_pairing_option_in_earphone.png"/>
</div>
 <center><div id="figure_10_1"><b>Figure 10-1 Multi-Pairing setting (General subtab)</b></div></center><p>Define and set both F_APP_GAMING_DONGLE_SUPPORT and F_APP_DONGLE_MULTI_PAIRING to 1 in app_flags.h: </p><div class="fragment"><div class="line"><span class="preprocessor">#undef F_APP_GAMING_DONGLE_SUPPORT</span></div><div class="line"><span class="preprocessor">#define F_APP_GAMING_DONGLE_SUPPORT     1</span></div><div class="line"><span class="preprocessor">#undef F_APP_DONGLE_MULTI_PAIRING</span></div><div class="line"><span class="preprocessor">#define F_APP_DONGLE_MULTI_PAIRING      1</span></div></div><!-- fragment --><div style="page-break-after: always;"></div><p>In order to switch pairing mode, a key should be set in MCU config tool. </p><div class="image">
<img src="multi_pairing_key_setting.png" alt="multi_pairing_key_setting.png"/>
</div>
 <center><div id="figure_10_2"><b>Figure 10-2 Pairing mode switch key setting</b></div></center><p>Besides, user could setup ringtones in MCU config tool. It helps users to distinguish which pairing mode is currently activated. </p><div class="image">
<img src="multi_pairing_tone.png" alt="multi_pairing_tone.png"/>
</div>
 <center><div id="figure_10_3"><b>Figure 10-3 Multi-Pairing ringtone setting</b></div></center><h3><a class="anchor" id="Multi_Pairing_More_Description"></a>
10.2 More Description</h3>
<p>If headset enters dongle pairing mode (default setting), users could switch to BT pairing mode via key. It means users could select which kind of device could search and connect to headset.</p>
<center><div id="table_10_1"><b>Table 10-1 Multi-Pairing Expected Result</b></div></center> <table border="1" align="center" style="border-collapse: collapse">
<tr>
<td colspan="2" rowspan="2"></td><th colspan="2">Headset   </th></tr>
<tr>
<th>Dongle pairing mode </th><th>BT pairing mode  </th></tr>
<tr>
<th rowspan="2">Device </th><th>Dongle </th><td>Dongle could find out and connect headset </td><td>Dongle could not find out headset  </td></tr>
<tr>
<th>BT devices except dongle </th><td>BT devices could not find out headset </td><td>BT devices could find out and connect headset  </td></tr>
</table>
<p>When app_cfg_nv.is_bt_pairing is true, it means current activated pairing mode is BT pairing mode. </p><div class="fragment"><div class="line"><span class="comment">//used to records currently pairing mode</span></div><div class="line"><a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#af85bbe4a46d3e7ab0cf7339cb2e898e5">is_bt_pairing</a></div></div><!-- fragment --> </div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
