<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="HFP_USER_MANU"></a>
HFP Application Note </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.1</b></center><p><br />
 </p><center><b>2023/06/07</b></center> <div style="page-break-after: always;"></div><h2><a class="anchor" id="HFP_Revision_History"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.0.0.0  </td><td class="markdownTableBodyCenter">2021/10/21  </td><td class="markdownTableBodyCenter">Stable release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.1  </td><td class="markdownTableBodyCenter">2023/06/07  </td><td class="markdownTableBodyCenter">Change version number to 2 digits   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="HFP_Content"></a>
Contents</h2>
<ul>
<li><a class="el" href="_h_f_p.html#HFP_Revision_History">Revision History</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Table_List">Table List</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Figure_List">Figure List</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Glossary">Glossary</a></li>
<li><a class="el" href="_h_f_p.html#HFP_HSP_Intro">1 Introduction</a><ul>
<li><a class="el" href="_h_f_p.html#HFP_role_feature">1.1 HFP/HSP Role Featrues</a></li>
<li><a class="el" href="_h_f_p.html#HFP_profile_stack">1.2 HFP/HSP Profile Stack</a></li>
<li><a class="el" href="_h_f_p.html#HFP_uuid">1.3 HFP/HSP UUID</a></li>
<li><a class="el" href="_h_f_p.html#HFP_feature">1.4 HFP/HSP Features</a></li>
<li><a class="el" href="_h_f_p.html#HFP_service_chann">1.5 HFP/HSP Service Channel</a></li>
</ul>
</li>
<li><a class="el" href="_h_f_p.html#HFP_API">2 HFP API Introduction</a><ul>
<li><a class="el" href="_h_f_p.html#HFP_Init">2.1 HFP Init</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Connect">2.2 HFP Connect</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Command">2.3 HFP Command</a></li>
</ul>
</li>
<li><a class="el" href="_h_f_p.html#HFP_HSP_Code_Ov">3 Source Code Overview</a><ul>
<li><a class="el" href="_h_f_p.html#HFP_Initialization">3.1 Initialization</a></li>
<li><a class="el" href="_h_f_p.html#HFP_SDP_Record">3.2 HFP/HSP SDP Record</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Profile_Initialization">3.3 HFP/HSP Profile Initialization</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Profile_Link_Back">3.4 HFP/HSP Profile Link Back</a></li>
<li><a class="el" href="_h_f_p.html#HFP_Profile_Profile_Callback_Handler">3.5 HFP/HSP Profile Callback Handler</a> <div style="page-break-after: always;"></div></li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="HFP_Table_List"></a>
Table List</h2>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="HFP_Figure_List"></a>
Figure List</h2>
<ul>
<li><a href="#figure_1_1">Figure 1-1 HFP Proifle Roles</a></li>
<li><a href="#figure_1_2">Figure 1-2 HSP Proifle Roles</a></li>
<li><a href="#figure_1_3">Figure 1-3 HFP Profile Stack</a></li>
<li><a href="#figure_1_4">Figure 1-4 HSP Profile Stack</a></li>
<li><a href="#figure_1_5">Figure 1-5 HFP Version 1.7.0 Features</a></li>
<li><a href="#figure_1_6">Figure 1-6 HFP version 1.7.0 SDP Features Map</a></li>
<li><a href="#figure_1_7">Figure 1-7 HSP Version 1.2 Features</a></li>
<li><a href="#figure_1_8">Figure 1-8 HSP Version 1.2 SDP Features Map</a></li>
<li><a href="#figure_2_1">Figure 2-1 HFP Connect Request</a></li>
<li><a href="#figure_2_2">Figure 2-2 HFP Disconnect Request</a></li>
<li><a href="#figure_2_3">Figure 2-3 HFP Connect Confirm</a></li>
<li><a href="#figure_2_4">Figure 2-4 HFP Send Vnd AT Cmd Req</a></li>
<li><a href="#figure_2_5">Figure 2-5 HFP Dial With Number Req</a></li>
<li><a href="#figure_2_6">Figure 2-6 HFP Dial Last Number Req</a></li>
<li><a href="#figure_2_7">Figure 2-7 HFP Call Answer Req</a></li>
<li><a href="#figure_2_8">Figure 2-8 HFP Call Terminate Req</a></li>
<li><a href="#figure_2_9">Figure 2-9 HFP Release Held Or Waiting Call Req</a></li>
<li><a href="#figure_2_10">Figure 2-10 HFP Release Active Call Accept Held Or Waiting Call Req</a></li>
<li><a href="#figure_2_11">Figure 2-11 HFP Hold Active Call Accept Held Or Waiting Call Req</a></li>
<li><a href="#figure_2_12">Figure 2-12 HFP Join Two Calls Req</a></li>
<li><a href="#figure_2_13">Figure 2-13 HFP Audio Connect Req</a></li>
<li><a href="#figure_2_14">Figure 2-14 HFP Audio Disconnect Req</a></li>
<li><a href="#figure_2_15">Figure 2-15 HFP Voice Recognition Enable Req</a></li>
<li><a href="#figure_2_16">Figure 2-16 HFP Voice Recognition Disable Req</a></li>
<li><a href="#figure_2_17">Figure 2-17 HFP Speaker Gain Jevel Report</a></li>
<li><a href="#figure_2_18">Figure 2-18 HFP Microphone Gain Jevel Report</a></li>
<li><a href="#figure_2_19">Figure 2-19 HFP Network Operator Name Query</a></li>
<li><a href="#figure_2_20">Figure 2-20 HFP Subscriber Number Query</a> <div style="page-break-after: always;"></div></li>
</ul>
<h2><a class="anchor" id="HFP_Glossary"></a>
Glossary</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Terms  </th><th class="markdownTableHeadCenter">Definitions   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">HFP  </td><td class="markdownTableBodyCenter">Hands-Free Profile   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="HFP_HSP_Intro"></a>
1 Introduction</h2>
<p>The purpose of this document is to give an overview of the HFP HF and HSP HS application based on HFP/HSP profile.</p>
<h3><a class="anchor" id="HFP_role_feature"></a>
1.1 HFP/HSP Role Featrues</h3>
<ul>
<li>Audio Gateway (AG) - This is the device that is the gateway of the audio, both for input and output. Typical devices acting as Audio Gateways are cellular phones.</li>
<li>Hands-Free unit (HF) - This is the device acting as the Audio Gateway's remote audio input and output mechanism. It also provides some remote control means. <div class="image">
<img src="hfp_roles.jpg" alt="hfp_roles.jpg"/>
</div>
 <center><div id="figure_1_1"><b>Figure 1-1 HFP Proifle Roles</b></div></center></li>
</ul>
<p><br />
</p><ul>
<li>Audio Gateway (AG) - This device acts as either the end point, or a relay, for telephony quality audio, which is typically two-way. Exemplary devices acting as Audio Gateways are cellular phones and personal computers.</li>
<li>Headset (HS) - This device provides the Audio Gateway's remote audio input and output mechanism. <div class="image">
<img src="hsp_roles.jpg" alt="hsp_roles.jpg"/>
</div>
 <center><div id="figure_1_2"><b>Figure 1-2 HSP Proifle Roles</b></div></center></li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="HFP_profile_stack"></a>
1.2 HFP/HSP Profile Stack</h3>
<ul>
<li>As indicated in Figure 1-3, the Hands-Free Profile is dependent upon both the Serial Port Profile and the Generic Access Profile. <div class="image">
<img src="hfp_profile_stack.jpg" alt="hfp_profile_stack.jpg"/>
</div>
 <center><div id="figure_1_3"><b>Figure 1-3 HFP Profile Stack</b></div></center></li>
</ul>
<p><br />
</p><ul>
<li>Figure 1-4 shows the protocols and entities used in this profile. <div class="image">
<img src="hsp_profile_stack.jpg" alt="hsp_profile_stack.jpg"/>
</div>
 <center><div id="figure_1_4"><b>Figure 1-4 HSP Profile Stack</b></div></center></li>
<li>The Controller, HCI, and L2CAP are the OSI layer 1 and 2 Bluetooth protocols. RFCOMM is the Bluetooth adaptation of GSM TS 07.10. SDP is the Bluetooth Service Discovery Protocol. Headset Profile and AT CMD are the entities responsible for headset specific control signaling, which is AT command based.</li>
</ul>
<h3><a class="anchor" id="HFP_uuid"></a>
1.3 HFP/HSP UUID</h3>
<ul>
<li>Universally Unique Identifier(UUID) is a universally unique identifier that is guaranteed to be unique across all space and all time. UUIDs can be independently created in a distributed fashion. No central registry of assigned UUIDs is required. A UUID is a 128-bit value.</li>
<li>The full 128-bit value of a 16-bit or 32-bit UUID may be computed by a simple arithmetic operation:<ul>
<li>128_bit_value = 16_bit_value * 296 + Bluetooth_Base_UUID</li>
<li>128_bit_value = 32_bit_value * 296 + Bluetooth_Base_UUID</li>
<li>The Base UUID(Bluetooth_Base_UUID) is used for calculating 128-bit UUIDs from 'short UUIDs' (uuid16 and uuid32) as described in the SDP Specification: 00000000-0000-1000-8000-00805F9B34FB</li>
<li>A 16-bit UUID may be converted to 32-bit UUID format by zero-extending the 16-bit value to 32-bits. An equivalent method is to add the 16-bit UUID value toa zero-valued 32-bit UUID.</li>
</ul>
</li>
<li>Blutetooth SDP UUID numbers is defined in <a href="https://www.bluetooth.com/specifications/assigned-numbers/service-discovery/">https://www.bluetooth.com/specifications/assigned-numbers/service-discovery/</a>.</li>
<li>HFP HF and HSP HS UUID registration is refered in <b>hfp_sdp_record</b> and <b>hsp_sdp_record</b>.</li>
</ul>
<h3><a class="anchor" id="HFP_feature"></a>
1.4 HFP/HSP Features</h3>
<ul>
<li>Framework supports HFP version 1.7.0 and features is shown as below. <div class="image">
<img src="hfp_features.jpg" alt="hfp_features.jpg"/>
</div>
 <center><div id="figure_1_5"><b>Figure 1-5 HFP Version 1.7.0 Features</b></div></center></li>
<li>In the initialization procedure, the HF shall send the AT+BRSF=&lt;HF supported="" features&gt;=""&gt; command to the AG to both notify the AG of the supported features in the HF, as well as to retrieve the supported features in the AG using the +BRSF result code.</li>
<li>Framework supports codec negotiation and SCO, CVSD ESCO and mSBC ESCO codec types.</li>
<li>Meanwhile, HFP HF features should be registered in HFP HF SDP record <b>hfp_sdp_record</b> as well, shown as below. <div class="image">
<img src="hfp_sdp_features_map.jpg" alt="hfp_sdp_features_map.jpg"/>
</div>
 <center><div id="figure_1_6"><b>Figure 1-6 HFP Version 1.7.0 SDP Features Map</b></div></center></li>
</ul>
<p><br />
</p><ul>
<li>Framework supports HSP version 1.2 and features is shown as below. <div class="image">
<img src="hsp_features.jpg" alt="hsp_features.jpg"/>
</div>
 <center><div id="figure_1_7"><b>Figure 1-7 HSP Version 1.2 Features</b></div></center></li>
<li>Meanwhile, HSP HS features should be registered in HSP HS SDP record <b>hsp_sdp_record</b> as well, shown as below. <div class="image">
<img src="hsp_sdp_features_map.jpg" alt="hsp_sdp_features_map.jpg"/>
</div>
 <center><div id="figure_1_8"><b>Figure 1-8 HSP Version 1.2 SDP Features Map</b></div></center></li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="HFP_service_chann"></a>
1.5 HFP/HSP Service Channel</h3>
<ul>
<li>HFP HF and HSP HS service channel should be registered by <a class="el" href="group___a_p_p___h_f_p___exported___functions.html#ga285695ab08738af30133d0671df1c986">app_hfp_init</a>.</li>
<li>Meanwhile, HFP HF and HSP HS service channel should be initialized in <b>hfp_sdp_record</b> and <b>hsp_sdp_record</b> as well.</li>
<li><a class="el" href="group___a_p_p___s_d_p.html#gad1689512b71c3b290069179eb302d1fa">RFC_HFP_CHANN_NUM</a></li>
<li><a class="el" href="group___a_p_p___s_d_p.html#gabb70afb37ae340cc3c15bec08bf3cfba">RFC_HSP_CHANN_NUM</a> <div style="page-break-after: always;"></div></li>
</ul>
<h2><a class="anchor" id="HFP_API"></a>
2 HFP API  Introduction</h2>
<p>This manual describes the <b>HFP API definition</b>.</p>
<h3><a class="anchor" id="HFP_Init"></a>
2.1 HFP Init</h3>
<p>bool <a class="el" href="group___b_t___h_f_p.html#gac5ff71b36012c49cddd27ed626b46ee7" title="Initialize HFP profile. ">bt_hfp_init()</a> <br />
 Initialize HFP profile, and configure the maximum link number of hfp. Set hfp/hsp rfcomm channel number. Configure hfp supported features. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___a_p_p___h_f_p___exported___functions.html#ga285695ab08738af30133d0671df1c986">app_hfp_init</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="group___a_p_p___c_f_g.html#ga22ec8032c8e4b8b7843c186572dbc1c6">supported_profile_mask</a> &amp; (<a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a> | <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>))</div><div class="line">    {</div><div class="line">        <a class="code" href="group___b_t___h_f_p.html#gac5ff71b36012c49cddd27ed626b46ee7">bt_hfp_init</a>(<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="group___a_p_p___c_f_g.html#ga0068752eeb59d7a69018b1883fc198fc">hfp_link_number</a>, <a class="code" href="group___a_p_p___s_d_p.html#gad1689512b71c3b290069179eb302d1fa">RFC_HFP_CHANN_NUM</a>,</div><div class="line">                    <a class="code" href="group___a_p_p___s_d_p.html#gabb70afb37ae340cc3c15bec08bf3cfba">RFC_HSP_CHANN_NUM</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a6d2383c4916d25dfbbe8ed0243745285">hfp_brsf_capability</a>);</div><div class="line">        <a class="code" href="group___a_u_d_i_o___m_a_n_a_g_e_r___a_u_d_i_o.html#ga67189dab89dfb141cf0ada6529f057bd">audio_mgr_cback_register</a>(app_hfp_audio_cback);</div><div class="line">        <a class="code" href="group___b_t___b_t_m.html#gad5518472fde08b8e93d5fc9c40d72f85">bt_mgr_cback_register</a>(app_hfp_bt_cback);</div><div class="line">        <a class="code" href="group___a_p_p___r_e_l_a_y.html#ga3973f461a62ef1eadfe82daa3f18ce8e">app_relay_cback_register</a>(<a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, app_hfp_parse_cback,</div><div class="line">                                 <a class="code" href="group___a_p_p___r_e_l_a_y.html#gga8fe3ea47e0bf7256d6bca08cb28eeedea4ca1579f2d65fe93f803084aea3203ff">APP_MODULE_TYPE_HFP</a>, <a class="code" href="group___a_p_p___h_f_p.html#gga708dedcc14bed61c8c0207e5cdb27a99a6bf1203ed52ff2d161f462f8e9514316">APP_REMOTE_HFP_TOTAL</a>);</div><div class="line">        <a class="code" href="group___a_p_p___t_i_m_e_r.html#ga5d2a3ae9710b2036a2907647a1932f0f">app_timer_reg_cb</a>(app_hfp_timeout_cb, &amp;hfp_timer_id);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="HFP_Connect"></a>
2.2 HFP Connect</h3>
<p>bool <a class="el" href="group___b_t___h_f_p.html#gaa392b737bd411c981707e50b2827cb3b" title="Send an HFP or HSP connection request. ">bt_hfp_connect_req()</a> <br />
 Initiate a hfp connection to a remote device, as shown in Figure 2-1. </p><div class="image">
<img src="hfp_connect_request.PNG" alt="hfp_connect_request.PNG"/>
</div>
 <center><div id="figure_2_1"><b>Figure 2-1 HFP Connect Request</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga7b8cfc3a40356d92c722242c288d76d7" title="Send an HFP disconnection request. ">bt_hfp_disconnect_req()</a> <br />
 Request a hfp disconnection, as shown in Figure 2-2. </p><div class="image">
<img src="hfp_disconnect_request.PNG" alt="hfp_disconnect_request.PNG"/>
</div>
 <center><div id="figure_2_2"><b>Figure 2-2 HFP Disconnect Request</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga78c10422e9e66ba6b294e660dd70d1bf" title="Send an HFP connection confirmation. ">bt_hfp_connect_cfm()</a> <br />
 Accept or reject the incoming hfp connection from the remote device, as shown in Figure 2-3. </p><div class="image">
<img src="hfp_connect_confirm.PNG" alt="hfp_connect_confirm.PNG"/>
</div>
 <center><div id="figure_2_3"><b>Figure 2-3 HFP Connect Confirm</b></div></center><h3><a class="anchor" id="HFP_Command"></a>
2.3 HFP Command</h3>
<p>bool <a class="el" href="group___b_t___h_f_p.html#ga6a8a1cfcb92327d427f69438e3da9537" title="Send a vendor AT command request. ">bt_hfp_send_vnd_at_cmd_req()</a> <br />
 Send hfp vendor AT command, as shown in Figure 2-4. </p><div class="image">
<img src="hfp_send_vnd_at_cmd_req.PNG" alt="hfp_send_vnd_at_cmd_req.PNG"/>
</div>
 <center><div id="figure_2_4"><b>Figure 2-4 HFP Send Vnd AT Cmd Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga3f96418b4b24e51b8279db879123860b" title="Send a command to dial a specific phone number. ">bt_hfp_dial_with_number_req()</a> <br />
 Send a command to dial a specific phone number. As shown in Figure 2-5. </p><div class="image">
<img src="hfp_dial_with_number_req.PNG" alt="hfp_dial_with_number_req.PNG"/>
</div>
 <center><div id="figure_2_5"><b>Figure 2-5 HFP Dial With Number Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga2763ae10da773f0955fd841c3ccff7e3" title="Send a command to recalling the last number dialed by the remote device. ">bt_hfp_dial_last_number_req()</a> <br />
 Send a command to recalling the last number dialed by the remote device. As shown in Figure 2-6. </p><div class="image">
<img src="hfp_dial_last_number_req.PNG" alt="hfp_dial_last_number_req.PNG"/>
</div>
 <center><div id="figure_2_6"><b>Figure 2-6 HFP Dial Last Number Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#gaf20821cc695f7e78243b60e63f2719de" title="Send a command to answer the incoming call. ">bt_hfp_call_answer_req()</a> <br />
 Send a command to answer the incoming call. As shown in Figure 2-7. </p><div class="image">
<img src="hfp_call_answer_req.PNG" alt="hfp_call_answer_req.PNG"/>
</div>
 <center><div id="figure_2_7"><b>Figure 2-7 HFP Call Answer Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga2e8c307a7498ebdbc9dbe1c64c4c3ac2" title="Send a command to terminate the phone call. ">bt_hfp_call_terminate_req()</a> <br />
 Send a command to terminate the phone call. As shown in Figure 2-8. </p><div class="image">
<img src="hfp_call_terminate_req.PNG" alt="hfp_call_terminate_req.PNG"/>
</div>
 <center><div id="figure_2_8"><b>Figure 2-8 HFP Call Terminate Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga72f99c1fb7c9d52c1a41f761df49c00f" title="Send a command to query current call list. ">bt_hfp_current_call_list_req()</a> <br />
 Send a command to query current call list. bool <a class="el" href="group___b_t___h_f_p.html#gaef27c08e2704fdb32aed0ae884901dcd" title="Send a command to release held or waiting call. ">bt_hfp_release_held_or_waiting_call_req()</a> <br />
 Send a command to release held or waiting call. As shown in Figure 2-9. </p><div class="image">
<img src="hfp_release_held_or_waiting_call_req.PNG" alt="hfp_release_held_or_waiting_call_req.PNG"/>
</div>
 <center><div id="figure_2_9"><b>Figure 2-9 HFP Release Held Or Waiting Call Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga6e80247dd3909a4b184c5e1174866ae6" title="Send a command to release active call and accept held or waiting_call. ">bt_hfp_release_active_call_accept_held_or_waiting_call_req()</a> <br />
 Send a command to release active call and accept held or waiting_call. As shown in Figure 2-10. </p><div class="image">
<img src="hfp_release_active_call_accept_held_or_waiting_call_req.PNG" alt="hfp_release_active_call_accept_held_or_waiting_call_req.PNG"/>
</div>
 <center><div id="figure_2_10"><b>Figure 2-10 HFP Release Active Call Accept Held Or Waiting Call Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga9a00a2cd7ff160543ff63dc30e4a6eb5" title="Send a command to hold active call and accept held or waiting_call. ">bt_hfp_hold_active_call_accept_held_or_waiting_call_req()</a> <br />
 Send a command to hold active call and accept held or waiting_call. As shown in Figure 2-11. </p><div class="image">
<img src="hfp_hold_active_call_accept_held_or_waiting_call_req.PNG" alt="hfp_hold_active_call_accept_held_or_waiting_call_req.PNG"/>
</div>
 <center><div id="figure_2_11"><b>Figure 2-11 HFP Hold Active Call Accept Held Or Waiting Call Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga221657f3ed51ef73255546c798f422ac" title="Send a command to join two calls. ">bt_hfp_join_two_calls_req()</a> <br />
 Send a command to join two calls. As shown in Figure 2-12. </p><div class="image">
<img src="hfp_join_two_calls_req.PNG" alt="hfp_join_two_calls_req.PNG"/>
</div>
 <center><div id="figure_2_12"><b>Figure 2-12 HFP Join Two Calls Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#gafd3e199479bd18ccd3527765243a5a56" title="Send a request to creat audio connection. ">bt_hfp_audio_connect_req()</a> <br />
 Send a request to creat audio connection. As shown in Figure 2-13. </p><div class="image">
<img src="hfp_audio_connect_req.PNG" alt="hfp_audio_connect_req.PNG"/>
</div>
 <center><div id="figure_2_13"><b>Figure 2-13 HFP Audio Connect Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#gaa16c84a7c3670975f9820749f48dc5b6" title="Send a request to disconnect audio connection. ">bt_hfp_audio_disconnect_req()</a> <br />
 Send a request to disconnect audio connection. As shown in Figure 2-14. </p><div class="image">
<img src="hfp_audio_disconnect_req.PNG" alt="hfp_audio_disconnect_req.PNG"/>
</div>
 <center><div id="figure_2_14"><b>Figure 2-14 HFP Audio Disconnect Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#gad56b51b1a1a69b1068a551958e57d5a1" title="Send a command to enable voice recognition. ">bt_hfp_voice_recognition_enable_req()</a> <br />
 Send a command to enable voice recognition. As shown in Figure 2-15. </p><div class="image">
<img src="hfp_voice_recognition_enable_req.PNG" alt="hfp_voice_recognition_enable_req.PNG"/>
</div>
 <center><div id="figure_2_15"><b>Figure 2-15 HFP Voice Recognition Enable Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga639e30e49f71ce6a687621aa187bede1" title="Send a command to disable voice recognition. ">bt_hfp_voice_recognition_disable_req()</a> <br />
 Send a command to disable voice recognition. As shown in Figure 2-16. </p><div class="image">
<img src="hfp_voice_recognition_disable_req.PNG" alt="hfp_voice_recognition_disable_req.PNG"/>
</div>
 <center><div id="figure_2_16"><b>Figure 2-16 HFP Voice Recognition Disable Req</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga162f0cebd6c9f4526353fabdd3266556" title="Send a command to synchronize speaker gain level. ">bt_hfp_speaker_gain_level_report()</a> <br />
 Send a command to synchronize speaker gain level. As shown in Figure 2-17. </p><div class="image">
<img src="hfp_speaker_gain_level_report.PNG" alt="hfp_speaker_gain_level_report.PNG"/>
</div>
 <center><div id="figure_2_17"><b>Figure 2-17 HFP Speaker Gain Jevel Report</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga947a443206298d6a5b1fa50ff45cc061" title="Send a command to synchronize microphone gain level. ">bt_hfp_microphone_gain_level_report()</a> <br />
 Send a command to synchronize microphone gain level. As shown in Figure 2-18. </p><div class="image">
<img src="hfp_microphone_gain_level_report.PNG" alt="hfp_microphone_gain_level_report.PNG"/>
</div>
 <center><div id="figure_2_18"><b>Figure 2-18 HFP Microphone Gain Jevel Report</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga64340f082c571d3803072fe49003c101" title="Send a specific DTMF code to its network connection. ">bt_hfp_dtmf_code_transmit()</a> <br />
 Send a specific DTMF code to its network connection. bool <a class="el" href="group___b_t___h_f_p.html#ga6c4a6a185da0da437a948cdeab105793" title="Send a command to query the current network operator name. ">bt_hfp_network_operator_name_query()</a> <br />
 Send a command to query the current network operator name. As shown in Figure 2-19. </p><div class="image">
<img src="hfp_network_operator_name_query.PNG" alt="hfp_network_operator_name_query.PNG"/>
</div>
 <center><div id="figure_2_19"><b>Figure 2-19 HFP Network Operator Name Query</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#gaa7cdc05030e4a106f43e48657711e264" title="Send a command to query the AG subscriber number information. ">bt_hfp_subscriber_number_query()</a> <br />
 Send a command to query the AG subscriber number information. As shown in Figure 2-20. </p><div class="image">
<img src="hfp_subscriber_number_query.PNG" alt="hfp_subscriber_number_query.PNG"/>
</div>
 <center><div id="figure_2_20"><b>Figure 2-20 HFP Subscriber Number Query</b></div></center><p>bool <a class="el" href="group___b_t___h_f_p.html#ga6efbf4b48043494b09443dbdf2cf4020" title="Send a command to report current battery level. ">bt_hfp_batt_level_report()</a> <br />
 Send a command to report current battery level. bool <a class="el" href="group___b_t___h_f_p.html#gadd2a977454e19787ac582edbeea64f3c" title="Send a command to hold the phone call. ">bt_hfp_call_hold_req()</a> <br />
 Send a command to hold the phone call. bool <a class="el" href="group___b_t___h_f_p.html#gafd00251455c989c931325ac5de197e24" title="Send a command to accept the held phone call. ">bt_hfp_held_call_accept_req()</a> <br />
 Send a command to accept the held phone call. bool <a class="el" href="group___b_t___h_f_p.html#ga8d1b008051679f9251a2e55ef46fc43e" title="Send a command to release the held phone call. ">bt_hfp_held_call_release_req()</a> <br />
 Send a command to release the held phone call. </p><div style="page-break-after: always;"></div><h2><a class="anchor" id="HFP_HSP_Code_Ov"></a>
3 Source Code Overview</h2>
<p>The following sections describe important parts of HFP HF and HSP HS application.</p>
<h3><a class="anchor" id="HFP_Initialization"></a>
3.1 Initialization</h3>
<p>Main function is invoked when the application is powered on or the chip resets and performs the following initialization functions. </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="group___s_p_p___d_e_m_o___m_a_i_n.html#ga840291bc02cba5474a4cb46a9b9566fe">main</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    ......</div><div class="line">    <a class="code" href="group___o_s__87x3d___message.html#ga78583ff4df155099dbb1592bd71dedfb">os_msg_queue_create</a>(&amp;<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gae608acf4da9aeedaf885f18e8b91eefc">audio_io_queue_handle</a>, <a class="code" href="group___p_e_r_i_p_h___a_p_p___t_a_s_k.html#ga2f27fdd94800589c67000bd6fc3500bd">MAX_NUMBER_OF_IO_MESSAGE</a>, <span class="keyword">sizeof</span>(<a class="code" href="struct_t___i_o___m_s_g.html">T_IO_MSG</a>));</div><div class="line">    <a class="code" href="group___o_s__87x3d___message.html#ga78583ff4df155099dbb1592bd71dedfb">os_msg_queue_create</a>(&amp;<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#ga1dc336635d2a407d06df2101d4208c43">audio_evt_queue_handle</a>, MAX_NUMBER_OF_RX_EVENT, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>));</div><div class="line"></div><div class="line">    <a class="code" href="group___s_p_p___d_e_m_o___m_a_i_n.html#ga916f2adc2080b4fe88034086d107a8dc">board_init</a>();</div><div class="line"></div><div class="line">    bt_gap_init();</div><div class="line"></div><div class="line">    <a class="code" href="group___s_p_p___d_e_m_o___m_a_i_n.html#gae0e3245b704e5b87aba9ab8f4c8dbad0">framework_init</a>();</div><div class="line">    <a class="code" href="group___p_e_r_i_p_h___a_p_p___t_a_s_k.html#ga431d3b5cbaad02e4dba35c48dc7bd161">driver_init</a>();</div><div class="line"></div><div class="line">    ......</div><div class="line"></div><div class="line">    <a class="code" href="group___a_p_p___h_f_p___exported___functions.html#ga285695ab08738af30133d0671df1c986">app_hfp_init</a>();</div><div class="line"></div><div class="line">    <a class="code" href="group___a_p_p___s_d_p.html#gadf2652ddca810cbb476b4a54755acf56">app_sdp_init</a>();</div><div class="line"></div><div class="line">    ......</div><div class="line">    <a class="code" href="group___o_s__87x3e___task.html#gac6d28adc4486c67c033dcce58ca3f1d2">os_task_create</a>(&amp;<a class="code" href="group___p_e_r_i_p_h___a_p_p___t_a_s_k.html#gae5e66af33ac97474a05905b4cba5b529">app_task_handle</a>, <span class="stringliteral">&quot;app_task&quot;</span>, app_task, <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1024 * 4, 1);</div><div class="line">    ......</div><div class="line"></div><div class="line">    <a class="code" href="group___o_s__87x3e___schedule.html#ga3300197ad1a1b9d64a335dc4ffc0769f">os_sched_start</a>();</div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="HFP_SDP_Record"></a>
3.2 HFP/HSP SDP Record</h3>
<ul>
<li>HFP HF SDP local record <b>hfp_sdp_record</b> and HSP HS SDP local record <b>hsp_sdp_record</b> should be registered by legacy_add_sdp_record. <div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___a_p_p___s_d_p.html#gadf2652ddca810cbb476b4a54755acf56">app_sdp_init</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    ......</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="group___a_p_p___c_f_g.html#ga22ec8032c8e4b8b7843c186572dbc1c6">supported_profile_mask</a> &amp; <a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a>)</div><div class="line">    {</div><div class="line">        legacy_add_sdp_record((<span class="keywordtype">void</span> *)hfp_sdp_record);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="group___a_p_p___c_f_g.html#ga22ec8032c8e4b8b7843c186572dbc1c6">supported_profile_mask</a> &amp; <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>)</div><div class="line">    {</div><div class="line">        legacy_add_sdp_record((<span class="keywordtype">void</span> *)hsp_sdp_record);</div><div class="line">    }</div><div class="line">    ......</div><div class="line">}</div></div><!-- fragment --></li>
<li>For HFP HF, 16-bit UUID 0x111E <a class="el" href="group___b_t___t_y_p_e_s.html#ga269b7d3ec23604d90525e8f7a54d4f72">UUID_HANDSFREE</a> is reserved, meanwhile, for HSP HS, 16-bit UUID 0x1108 <a class="el" href="group___b_t___t_y_p_e_s.html#gaab29773b6da2cd6ff4f1878f9237262a">UUID_HEADSET</a> is reserved. <div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> uint8_t hfp_sdp_record[] =</div><div class="line">{</div><div class="line">    <span class="comment">//total length</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x37,<span class="comment">//0x59,</span></div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_SRV_CLASS_ID_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gae6e31379df951f323d24e4f8b85d42d3">SDP_ATTR_SRV_CLASS_ID_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#gae6e31379df951f323d24e4f8b85d42d3">SDP_ATTR_SRV_CLASS_ID_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,          <span class="comment">//0x35</span></div><div class="line">    0x06,                                   <span class="comment">//6bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                     <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga269b7d3ec23604d90525e8f7a54d4f72">UUID_HANDSFREE</a> &gt;&gt; 8), <span class="comment">//0x111E</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga269b7d3ec23604d90525e8f7a54d4f72">UUID_HANDSFREE</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                     <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga7bf9bc63c96e6ff02a851274ce71d5fd">UUID_GENERIC_AUDIO</a> &gt;&gt; 8),  <span class="comment">//0x1203</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga7bf9bc63c96e6ff02a851274ce71d5fd">UUID_GENERIC_AUDIO</a>),</div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_PROTO_DESC_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga3e3afe98f67b0f02ee51ca67e2d257b6">SDP_ATTR_PROTO_DESC_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga3e3afe98f67b0f02ee51ca67e2d257b6">SDP_ATTR_PROTO_DESC_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,          <span class="comment">//0x35</span></div><div class="line">    0x0C,                                   <span class="comment">//12bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,      <span class="comment">//0x35</span></div><div class="line">    0x03,                               <span class="comment">//3bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                 <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga847ad44f6d4c69761ac39371da15020d">UUID_L2CAP</a> &gt;&gt; 8),     <span class="comment">//0x0100</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga847ad44f6d4c69761ac39371da15020d">UUID_L2CAP</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,      <span class="comment">//0x35</span></div><div class="line">    0x05,                               <span class="comment">//5bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                 <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gae79453f41389da4c5f2bdd1b31814dd0">UUID_RFCOMM</a> &gt;&gt; 8),   <span class="comment">//0x0003</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gae79453f41389da4c5f2bdd1b31814dd0">UUID_RFCOMM</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,           <span class="comment">//0x08</span></div><div class="line">    <a class="code" href="group___a_p_p___s_d_p.html#gad1689512b71c3b290069179eb302d1fa">RFC_HFP_CHANN_NUM</a>,  <span class="comment">//0x02</span></div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_PROFILE_DESC_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga4aa7aa3090459d3056faa878fcfde257">SDP_ATTR_PROFILE_DESC_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga4aa7aa3090459d3056faa878fcfde257">SDP_ATTR_PROFILE_DESC_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,          <span class="comment">//0x35</span></div><div class="line">    0x08,                                   <span class="comment">//8 bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,      <span class="comment">//0x35</span></div><div class="line">    0x06,                               <span class="comment">//6 bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                 <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga269b7d3ec23604d90525e8f7a54d4f72">UUID_HANDSFREE</a> &gt;&gt; 8), <span class="comment">//0x111E</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga269b7d3ec23604d90525e8f7a54d4f72">UUID_HANDSFREE</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,           <span class="comment">//0x09</span></div><div class="line">    (uint8_t)(0x0107 &gt;&gt; 8),     <span class="comment">//version number default hf1.7</span></div><div class="line">    (uint8_t)(0x0107),</div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_BROWSE_GROUP_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga4b6cf5cf717a8c0f70bfe4df57f0fbfa">SDP_ATTR_BROWSE_GROUP_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga4b6cf5cf717a8c0f70bfe4df57f0fbfa">SDP_ATTR_BROWSE_GROUP_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x03,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga089c7a7d51a97c5a4e47136ba1dcbadf">UUID_PUBLIC_BROWSE_GROUP</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga089c7a7d51a97c5a4e47136ba1dcbadf">UUID_PUBLIC_BROWSE_GROUP</a>,</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">        //attribute SDP_ATTR_LANG_BASE_ATTR_ID_LIST...it is used for SDP_ATTR_SRV_NAME</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_ATTR_LANG_BASE_ATTR_ID_LIST &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_ATTR_LANG_BASE_ATTR_ID_LIST,</span></div><div class="line"><span class="comment">        SDP_DATA_ELEM_SEQ_HDR,</span></div><div class="line"><span class="comment">        0x09,</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_LANG_ENGLISH &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_LANG_ENGLISH,</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_CHARACTER_UTF8 &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_CHARACTER_UTF8,</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_BASE_LANG_OFFSET &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_BASE_LANG_OFFSET,</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">        //attribute SDP_ATTR_SRV_NAME</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)((SDP_ATTR_SRV_NAME + SDP_BASE_LANG_OFFSET) &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_ATTR_SRV_NAME + SDP_BASE_LANG_OFFSET),</span></div><div class="line"><span class="comment">        SDP_STRING_HDR,                             //0x25 text string</span></div><div class="line"><span class="comment">        0x0F,                                   //15 bytes</span></div><div class="line"><span class="comment">        0x48, 0x61, 0x6e, 0x64, 0x73, 0x2d, 0x66, 0x72, 0x65, 0x65,</span></div><div class="line"><span class="comment">        0x20, 0x75, 0x6e, 0x69, 0x74, //&quot;Hands-free unit&quot;</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    <span class="comment">//attribute SDP_ATTR_SUPPORTED_FEATURES</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)((<a class="code" href="group___b_t___t_y_p_e_s.html#ga1d91531d2bd55bfc1bd089e36ad45816">SDP_ATTR_SUPPORTED_FEATURES</a>) &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga1d91531d2bd55bfc1bd089e36ad45816">SDP_ATTR_SUPPORTED_FEATURES</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(0x003F &gt;&gt; 8),</div><div class="line">    (uint8_t)(0x003F)</div><div class="line">};</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> uint8_t hsp_sdp_record[] =</div><div class="line">{</div><div class="line">    <span class="comment">//total length</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x39,<span class="comment">//0x58,</span></div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_SRV_CLASS_ID_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gae6e31379df951f323d24e4f8b85d42d3">SDP_ATTR_SRV_CLASS_ID_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#gae6e31379df951f323d24e4f8b85d42d3">SDP_ATTR_SRV_CLASS_ID_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,          <span class="comment">//0x35</span></div><div class="line">    0x09,                                   <span class="comment">//6bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                     <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gaab29773b6da2cd6ff4f1878f9237262a">UUID_HEADSET</a> &gt;&gt; 8),       <span class="comment">//0x1108</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gaab29773b6da2cd6ff4f1878f9237262a">UUID_HEADSET</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                     <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga00d08bee3e03caa10d559649b0db9884">UUID_HEADSET_HS</a> &gt;&gt; 8),    <span class="comment">//0x1131</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga00d08bee3e03caa10d559649b0db9884">UUID_HEADSET_HS</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                     <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga7bf9bc63c96e6ff02a851274ce71d5fd">UUID_GENERIC_AUDIO</a> &gt;&gt; 8),  <span class="comment">//0x1203</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga7bf9bc63c96e6ff02a851274ce71d5fd">UUID_GENERIC_AUDIO</a>),</div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_PROTO_DESC_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga3e3afe98f67b0f02ee51ca67e2d257b6">SDP_ATTR_PROTO_DESC_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga3e3afe98f67b0f02ee51ca67e2d257b6">SDP_ATTR_PROTO_DESC_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,          <span class="comment">//0x35</span></div><div class="line">    0x0C,                                   <span class="comment">//12 bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,      <span class="comment">//0x35</span></div><div class="line">    0x03,                               </div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                 <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga847ad44f6d4c69761ac39371da15020d">UUID_L2CAP</a> &gt;&gt; 8),     <span class="comment">//0x0100</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga847ad44f6d4c69761ac39371da15020d">UUID_L2CAP</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x05,                               <span class="comment">//5 bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                 <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gae79453f41389da4c5f2bdd1b31814dd0">UUID_RFCOMM</a> &gt;&gt; 8),    <span class="comment">//0x0003</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gae79453f41389da4c5f2bdd1b31814dd0">UUID_RFCOMM</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,           <span class="comment">//0x08</span></div><div class="line">    <a class="code" href="group___a_p_p___s_d_p.html#gabb70afb37ae340cc3c15bec08bf3cfba">RFC_HSP_CHANN_NUM</a>,      <span class="comment">//0x01</span></div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_PROFILE_DESC_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga4aa7aa3090459d3056faa878fcfde257">SDP_ATTR_PROFILE_DESC_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga4aa7aa3090459d3056faa878fcfde257">SDP_ATTR_PROFILE_DESC_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,          <span class="comment">//0x35</span></div><div class="line">    0x08,                                   <span class="comment">//8 bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,      <span class="comment">//0x35</span></div><div class="line">    0x06,                               <span class="comment">//6 bytes</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,                     <span class="comment">//0x19</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gaab29773b6da2cd6ff4f1878f9237262a">UUID_HEADSET</a> &gt;&gt; 8),   <span class="comment">//0x1108</span></div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#gaab29773b6da2cd6ff4f1878f9237262a">UUID_HEADSET</a>),</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,               <span class="comment">//0x09</span></div><div class="line">    (uint8_t)(0x0102 &gt;&gt; 8),         <span class="comment">//version number default hs1.2</span></div><div class="line">    (uint8_t)(0x0102),</div><div class="line"></div><div class="line">    <span class="comment">//attribute SDP_ATTR_BROWSE_GROUP_LIST</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga4b6cf5cf717a8c0f70bfe4df57f0fbfa">SDP_ATTR_BROWSE_GROUP_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga4b6cf5cf717a8c0f70bfe4df57f0fbfa">SDP_ATTR_BROWSE_GROUP_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x03,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga089c7a7d51a97c5a4e47136ba1dcbadf">UUID_PUBLIC_BROWSE_GROUP</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga089c7a7d51a97c5a4e47136ba1dcbadf">UUID_PUBLIC_BROWSE_GROUP</a>,</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">        //attribute SDP_ATTR_LANG_BASE_ATTR_ID_LIST...it is used for SDP_ATTR_SRV_NAME</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_ATTR_LANG_BASE_ATTR_ID_LIST &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_ATTR_LANG_BASE_ATTR_ID_LIST,</span></div><div class="line"><span class="comment">        SDP_DATA_ELEM_SEQ_HDR,</span></div><div class="line"><span class="comment">        0x09,</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_LANG_ENGLISH &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_LANG_ENGLISH,</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_CHARACTER_UTF8 &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_CHARACTER_UTF8,</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_BASE_LANG_OFFSET &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)SDP_BASE_LANG_OFFSET,</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">        //attribute SDP_ATTR_SRV_NAME</span></div><div class="line"><span class="comment">        SDP_UNSIGNED_TWO_BYTE,</span></div><div class="line"><span class="comment">        (uint8_t)((SDP_ATTR_SRV_NAME + SDP_BASE_LANG_OFFSET) &gt;&gt; 8),</span></div><div class="line"><span class="comment">        (uint8_t)(SDP_ATTR_SRV_NAME + SDP_BASE_LANG_OFFSET),</span></div><div class="line"><span class="comment">        SDP_STRING_HDR,                             //0x25 text string</span></div><div class="line"><span class="comment">        0x0C,                               //12 bytes</span></div><div class="line"><span class="comment">        0x48, 0x65, 0x61, 0x64, 0x73, 0x65, 0x74, 0x20, 0x75, 0x6e,</span></div><div class="line"><span class="comment">        0x69, 0x74, //&quot;Headset unit&quot;</span></div><div class="line"><span class="comment">    */</span></div><div class="line">    <span class="comment">//attribute SDP_ATTR_RMT_AUDIO_VOL_CTRL</span></div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___t_y_p_e_s.html#ga353792b0144b8d2a6a3a9741606fe53f">SDP_ATTR_RMT_AUDIO_VOL_CTRL</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___t_y_p_e_s.html#ga353792b0144b8d2a6a3a9741606fe53f">SDP_ATTR_RMT_AUDIO_VOL_CTRL</a>,</div><div class="line">    <a class="code" href="group___b_t___t_y_p_e_s.html#ga43090da31dbfdb6dc618483d05701cad">SDP_BOOL_ONE_BYTE</a>,                       <span class="comment">//0x28</span></div><div class="line">    0x01                                    <span class="comment">//True</span></div><div class="line">};</div></div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="HFP_Profile_Initialization"></a>
3.3 HFP/HSP Profile Initialization</h3>
<ul>
<li>HFP HF and HSP HS could be initialized as follows.</li>
<li>HFP HF features is initialized in <b>app_cfg_const.hfp_brsf_capability</b>. <div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___a_p_p___h_f_p___exported___functions.html#ga285695ab08738af30133d0671df1c986">app_hfp_init</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="group___a_p_p___c_f_g.html#ga22ec8032c8e4b8b7843c186572dbc1c6">supported_profile_mask</a> &amp; (<a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a> | <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>))</div><div class="line">    {</div><div class="line">        <a class="code" href="group___b_t___h_f_p.html#gac5ff71b36012c49cddd27ed626b46ee7">bt_hfp_init</a>(<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="group___a_p_p___c_f_g.html#ga0068752eeb59d7a69018b1883fc198fc">hfp_link_number</a>, <a class="code" href="group___a_p_p___s_d_p.html#gad1689512b71c3b290069179eb302d1fa">RFC_HFP_CHANN_NUM</a>,</div><div class="line">                    <a class="code" href="group___a_p_p___s_d_p.html#gabb70afb37ae340cc3c15bec08bf3cfba">RFC_HSP_CHANN_NUM</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a6d2383c4916d25dfbbe8ed0243745285">hfp_brsf_capability</a>);</div><div class="line">        <a class="code" href="group___b_t___b_t_m.html#gad5518472fde08b8e93d5fc9c40d72f85">bt_mgr_cback_register</a>(app_hfp_bt_cback);</div><div class="line">        <a class="code" href="group___g_a_p___t_i_m_e_r.html#gaa69e621535dae6a916772dd46193a68c">gap_reg_timer_cb</a>(app_hfp_timeout_cb, &amp;hfp_timer_queue_id);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="HFP_Profile_Link_Back"></a>
3.4 HFP/HSP Profile Link Back</h3>
<ul>
<li>Firstly, HFP HF and HSP HS will call legacy_start_sdp_discov to discover the HFP and HSP SDP record in AG. <div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code" href="group___a_p_p___l_i_n_k_b_a_c_k.html#gabbbc1da595ad9b044ee61639998980af">linkback_profile_search_start</a>(uint8_t *bd_addr, uint32_t prof, <span class="keywordtype">bool</span> is_special,</div><div class="line">                                   <a class="code" href="union_t___l_i_n_k_b_a_c_k___s_e_a_r_c_h___p_a_r_a_m.html">T_LINKBACK_SEARCH_PARAM</a> *param)</div><div class="line">{</div><div class="line">    ......</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a>:</div><div class="line">        {</div><div class="line">            uuid.uuid_16 = <a class="code" href="group___b_t___t_y_p_e_s.html#ga70d6b0a8ef4d194cdbb488656e1dc18f">UUID_HANDSFREE_AUDIO_GATEWAY</a>;</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>:</div><div class="line">        {</div><div class="line">            uuid.uuid_16 = <a class="code" href="group___b_t___t_y_p_e_s.html#ga5ecd2d5c5ea85918c1dbd47d003add1a">UUID_HEADSET_AUDIO_GATEWAY</a>;</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    ......</div><div class="line">    <span class="keywordflow">if</span> (ret)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (legacy_start_sdp_discov(bd_addr, uuid_type, uuid) != <a class="code" href="group___g_a_p___common___exported___types.html#gga99268bc0507cd918edbd1c9d12c802aba517ae23e2fc4ffb7a6128b63e43a5afc">GAP_CAUSE_SUCCESS</a>)</div><div class="line">        {</div><div class="line">            ret = <span class="keyword">false</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line">    ......</div><div class="line">}</div></div><!-- fragment --></li>
<li>Then, HFP HF and HSP HS will initiate profile connection to AG by <a class="el" href="group___b_t___h_f_p.html#gaa392b737bd411c981707e50b2827cb3b">bt_hfp_connect_req</a>. <br />
 <b>Note:</b>If both devices initiate a connection at the same time, both channels shall be closed and each device shall wait a random time (not more than 1s and not less than 100ms) and then try to initiate the connection again. If it is known which device is the master, that device can re-try at once. <div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code" href="group___a_p_p___l_i_n_k_b_a_c_k.html#gaefeb99a31f16b9e630c9f301f33d5021">linkback_profile_connect_start</a>(uint8_t *bd_addr, uint32_t prof, <a class="code" href="struct_t___l_i_n_k_b_a_c_k___c_o_n_n___p_a_r_a_m.html">T_LINKBACK_CONN_PARAM</a> *param)</div><div class="line">{</div><div class="line">    ......</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a>:</div><div class="line">        ret = <a class="code" href="group___b_t___h_f_p.html#gaa392b737bd411c981707e50b2827cb3b">bt_hfp_connect_req</a>(bd_addr, param-&gt;<a class="code" href="struct_t___l_i_n_k_b_a_c_k___c_o_n_n___p_a_r_a_m.html#ace5623b10edbf3417840ed509e9614bb">server_channel</a>, <span class="keyword">true</span>);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>:</div><div class="line">        ret = <a class="code" href="group___b_t___h_f_p.html#gaa392b737bd411c981707e50b2827cb3b">bt_hfp_connect_req</a>(bd_addr, param-&gt;<a class="code" href="struct_t___l_i_n_k_b_a_c_k___c_o_n_n___p_a_r_a_m.html#ace5623b10edbf3417840ed509e9614bb">server_channel</a>, <span class="keyword">false</span>);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    ......</div><div class="line">}</div></div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="HFP_Profile_Profile_Callback_Handler"></a>
3.5 HFP/HSP Profile Callback Handler</h3>
<ul>
<li>For HFP HF and HSP HS, app_hfp_bt_cback function is used to handle BT Manager HFP HF and HSP HS related events. <div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_hfp_bt_cback(<a class="code" href="group___b_t___b_t_m.html#ga60f938d2fe9ea1ac81e1bf400fbb5b03">T_BT_EVENT</a> event_type, <span class="keywordtype">void</span> *event_buf, uint16_t buf_len)</div><div class="line">{</div><div class="line">    <a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html">T_BT_EVENT_PARAM</a> *param = event_buf;</div><div class="line">    <span class="keywordtype">bool</span> handle = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (event_type)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a7d2a1dc52fb12dec5742f8cbcf065a72">BT_EVENT_HFP_CONN_IND</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_conn_ind.bd_addr);</div><div class="line">            <span class="keywordflow">if</span> (p_link == <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                <a class="code" href="group___t_r_a_c_e.html#gaf20aac2fd019420214bcab2eadd15156">APP_PRINT_ERROR0</a>(<span class="stringliteral">&quot;app_hfp_bt_cback: no acl link found&quot;</span>);</div><div class="line">                <span class="keywordflow">return</span>;</div><div class="line">            }</div><div class="line">            <a class="code" href="group___b_t___h_f_p.html#ga78c10422e9e66ba6b294e660dd70d1bf">bt_hfp_connect_cfm</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, <span class="keyword">true</span>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a260fb5fa6196b0cca640a30c21b80e73">BT_EVENT_HFP_CONN_CMPL</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_conn_cmpl.bd_addr);</div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                uint8_t link_number;</div><div class="line">                uint8_t pair_idx;</div><div class="line"></div><div class="line">                p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#ad1e7efad522a4a716eb0c2de47864a18">call_id_type_check</a> = <span class="keyword">true</span>;</div><div class="line">                p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#aab0f79749e310456f2ed9732d9ae4898">call_id_type_num</a> = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">                <a class="code" href="group___b_t___b_o_n_d.html#gabd7e0cc969a6f8ab3a5203c394e62966">bt_bond_index_get</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, &amp;pair_idx);</div><div class="line">                <a class="code" href="group___b_t___h_f_p.html#ga162f0cebd6c9f4526353fabdd3266556">bt_hfp_speaker_gain_level_report</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx]);</div><div class="line">                <a class="code" href="group___b_t___h_f_p.html#ga947a443206298d6a5b1fa50ff45cc061">bt_hfp_microphone_gain_level_report</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, 0x0a);</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (app_src_status_hook == <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___a_p_p___h_f_p___exported___functions.html#ga6618e9121d2654925ae6bbe5dbb6ac13">app_hfp_batt_level_report</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>);</div><div class="line">                }</div><div class="line"></div><div class="line">                link_number = <a class="code" href="group___a_p_p___l_i_n_k.html#gae9c7b10e99d9b301c670648ff496e1e0">app_connected_profile_link_num</a>(<a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a> | <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>);</div><div class="line">                <span class="keywordflow">if</span> (link_number == 1)</div><div class="line">                {</div><div class="line">                    app_hfp_set_active_hf_index(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>);</div><div class="line">                    <a class="code" href="group___a_p_p___b_o_n_d.html#ga045abc13728a921bef309071328bf4d9">app_bond_set_priority</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a790da4b2b0fd0935efe47dc4aad8f147">br_link</a>[<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a03fba0e4e9598f1d4a632fc20a674dcf">first_hf_index</a>].<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a138135185d28d4e30105c39618fbd245">app_hf_state</a> == <a class="code" href="group___a_p_p___l_i_n_k.html#gga53404b285b3544df1665811c5895b438a2a895e3aa3395f44abda105ab6f965c6">APP_HF_STATE_STANDBY</a>)</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a03fba0e4e9598f1d4a632fc20a674dcf">first_hf_index</a> = p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a8b3cd3842b2a12c36296099602fe8cd0">last_hf_index</a> = p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>;</div><div class="line">                }</div><div class="line">                p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a138135185d28d4e30105c39618fbd245">app_hf_state</a> = <a class="code" href="group___a_p_p___l_i_n_k.html#gga53404b285b3544df1665811c5895b438a6e30000152ebd6f134dde2c6029ba0b8">APP_HF_STATE_CONNECTED</a>;</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a2e4e92442dda7112614cc76d14f7ee5b">BT_EVENT_HFP_CALL_STATUS</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_call_status.bd_addr);</div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a3bb53bb05ce52bd46410f7b8dfbbc7de">call_status</a> = param-&gt;bt_hfp_call_status.curr_status;</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> ((<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#ad18a656979222c3dde557379c467368b">enable_auto_answer_incoming_call</a> == 1) &amp;&amp;</div><div class="line">                    (p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a3bb53bb05ce52bd46410f7b8dfbbc7de">call_status</a> == BT_HFP_INCOMING_CALL_ONGOING))</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___g_a_p___t_i_m_e_r.html#ga90e208220b403c1622f5fc92a216ad55">gap_start_timer</a>(&amp;hfp_auto_answer_call, <span class="stringliteral">&quot;auto_answer_call&quot;</span>,</div><div class="line">                                    hfp_timer_queue_id, APP_HFP_TIMER_AUTO_ANSWER_CALL,</div><div class="line">                                    p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a1995fb4c5371f4141853c3bf1bfb979f">timer_hfp_auto_answer_call</a>);</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a3bb53bb05ce52bd46410f7b8dfbbc7de">call_status</a> == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>)</div><div class="line">                {</div><div class="line">                    p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#ad1e7efad522a4a716eb0c2de47864a18">call_id_type_check</a> = <span class="keyword">true</span>;</div><div class="line">                    p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#aab0f79749e310456f2ed9732d9ae4898">call_id_type_num</a> = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">                    app_hfp_disallow_enter_sniff_mode(<span class="keyword">false</span>);</div><div class="line">                }</div><div class="line"></div><div class="line">                <a class="code" href="group___a_p_p___h_f_p___exported___functions.html#gad2b6f496c1d95d3ae2f187c9ad4328a4">app_hfp_update_call_status</a>();</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="group___a_p_p___c_f_g.html#gabfb0c86126653790eb2fe7390d660496">bud_role</a> == <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#ggad48900c988433e8bd9e07b08a225fdf4a52f9edca7136cdeaabe8942e059fa05e">REMOTE_SESSION_ROLE_PRIMARY</a> ||</div><div class="line">                <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="group___a_p_p___c_f_g.html#gabfb0c86126653790eb2fe7390d660496">bud_role</a> == <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#ggad48900c988433e8bd9e07b08a225fdf4a673a27baaad47fd731a4458b2250a6a6">REMOTE_SESSION_ROLE_SINGLE</a>)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (param-&gt;bt_hfp_call_status.prev_status == BT_HFP_INCOMING_CALL_ONGOING &amp;&amp;</div><div class="line">                    param-&gt;bt_hfp_call_status.curr_status == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>)</div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a8d2121bf183e27d4948c88fd47683cc2">reject_call_by_key</a>)</div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a8d2121bf183e27d4948c88fd47683cc2">reject_call_by_key</a> = <span class="keyword">false</span>;</div><div class="line">                        <a class="code" href="group___a_p_p___m_m_i.html#gae6ee7d9fbb005ffecdb406cca1d6c24b">app_audio_tone_play</a>(<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a9237085b4f06879d0886f1a52b8236dc">tone_hf_call_reject</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">                    }</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (param-&gt;bt_hfp_call_status.prev_status == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a85f0b0a1b3b00478808a5fcc21d9397a">BT_HFP_CALL_ACTIVE</a> &amp;&amp;</div><div class="line">                    param-&gt;bt_hfp_call_status.curr_status == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>)</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___a_p_p___m_m_i.html#gae6ee7d9fbb005ffecdb406cca1d6c24b">app_audio_tone_play</a>(<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#aeb7af6c2386b07ead435b017cc2671a6">tone_hf_call_end</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (param-&gt;bt_hfp_call_status.prev_status != <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a85f0b0a1b3b00478808a5fcc21d9397a">BT_HFP_CALL_ACTIVE</a> &amp;&amp;</div><div class="line">                    param-&gt;bt_hfp_call_status.curr_status == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a85f0b0a1b3b00478808a5fcc21d9397a">BT_HFP_CALL_ACTIVE</a>)</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___a_p_p___m_m_i.html#gae6ee7d9fbb005ffecdb406cca1d6c24b">app_audio_tone_play</a>(<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#acb7d6f813b187995bd95ae33163ab8c2">tone_hf_call_active</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (param-&gt;bt_hfp_call_status.prev_status != BT_HFP_OUTGOING_CALL_ONGOING &amp;&amp;</div><div class="line">                    param-&gt;bt_hfp_call_status.curr_status == BT_HFP_OUTGOING_CALL_ONGOING)</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___a_p_p___m_m_i.html#gae6ee7d9fbb005ffecdb406cca1d6c24b">app_audio_tone_play</a>(<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#ae141af1a2d4f6b4d0c8b09e9906f0051">tone_hf_outgoing_call</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line">                }</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (param-&gt;bt_hfp_call_status.curr_status == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a85f0b0a1b3b00478808a5fcc21d9397a">BT_HFP_CALL_ACTIVE</a> ||</div><div class="line">                param-&gt;bt_hfp_call_status.curr_status == BT_HFP_INCOMING_CALL_ONGOING ||</div><div class="line">                param-&gt;bt_hfp_call_status.curr_status == BT_HFP_OUTGOING_CALL_ONGOING)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a5a4433108f08f2ffd04270d11849d57d">timer_auto_power_off_while_phone_connected_and_anc_apt_off</a>)</div><div class="line">                {</div><div class="line">                    app_auto_power_off_disable(<a class="code" href="group___a_p_p___d_e_v_i_c_e___exported___types.html#ga6d9608b85300372efdf22c89bce5abdfa8e9566d2d199dbb99a4764f191168c39">AUTO_POWER_OFF_MASK_SOURCE_LINK</a>);</div><div class="line">                }</div><div class="line"></div><div class="line">                <a class="code" href="group___a_p_p___r_o_l_e_s_w_a_p.html#ga003d68c5d79fb4c52bf2654b77a0a826">app_roleswap_state_machine</a>(ROLESWAP_EVENT_STREAM_CALL_START, 0, 0);</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (param-&gt;bt_hfp_call_status.curr_status == <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a5a4433108f08f2ffd04270d11849d57d">timer_auto_power_off_while_phone_connected_and_anc_apt_off</a>)</div><div class="line">                {</div><div class="line">                    app_auto_power_off_enable(<a class="code" href="group___a_p_p___d_e_v_i_c_e___exported___types.html#ga6d9608b85300372efdf22c89bce5abdfa8e9566d2d199dbb99a4764f191168c39">AUTO_POWER_OFF_MASK_SOURCE_LINK</a>,</div><div class="line">                                              <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a5a4433108f08f2ffd04270d11849d57d">timer_auto_power_off_while_phone_connected_and_anc_apt_off</a>);</div><div class="line">                }</div><div class="line"></div><div class="line">                <a class="code" href="group___a_p_p___r_o_l_e_s_w_a_p.html#ga003d68c5d79fb4c52bf2654b77a0a826">app_roleswap_state_machine</a>(ROLESWAP_EVENT_STREAM_CALL_STOP, 0, 0);</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aee1814f9e73f884cf9b22f48c63f2a82">BT_EVENT_HFP_SERVICE_STATUS</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_service_status.bd_addr);</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#aee4e8b3a4dc876136bfcd55aa5a87c71">service_status</a> = param-&gt;bt_hfp_service_status.status;</div><div class="line">                app_hfp_check_service_status();</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a350f8c8e2902ebd410b1daba9602b0bf">BT_EVENT_HFP_CALL_WAITING_IND</a>:</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aa35683c83c52d5b0dfd3d0cf87ac0b9f">BT_EVENT_HFP_CALLER_ID_IND</a>:</div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="group___a_p_p___c_f_g.html#gabfb0c86126653790eb2fe7390d660496">bud_role</a> == <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#ggad48900c988433e8bd9e07b08a225fdf4a673a27baaad47fd731a4458b2250a6a6">REMOTE_SESSION_ROLE_SINGLE</a>)</div><div class="line">            {</div><div class="line">                <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *br_link;</div><div class="line">                <a class="code" href="struct_t___a_p_p___l_e___l_i_n_k.html">T_APP_LE_LINK</a> *le_link;</div><div class="line">                <span class="keywordtype">char</span> *number;</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (event_type == <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aa35683c83c52d5b0dfd3d0cf87ac0b9f">BT_EVENT_HFP_CALLER_ID_IND</a>)</div><div class="line">                {</div><div class="line">                    br_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_caller_id_ind.bd_addr);</div><div class="line">                    number = (<span class="keywordtype">char</span> *)param-&gt;bt_hfp_caller_id_ind.number;</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    br_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_call_waiting_ind.bd_addr);</div><div class="line">                    number = (<span class="keywordtype">char</span> *)param-&gt;bt_hfp_call_waiting_ind.number;</div><div class="line">                }</div><div class="line"></div><div class="line">                le_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga090f40dc973aca241418d4bee0594c12">app_find_le_link_by_addr</a>(param-&gt;bt_pbap_caller_id_name.bd_addr);</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> (br_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">                {</div><div class="line">                    <span class="comment">/* Sanity check if BR/EDR TTS session is ongoing */</span></div><div class="line">                    <span class="keywordflow">if</span> (br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a38755635de9b8ecfe30070ca64558d38">cmd_set_enable</a> == <span class="keyword">true</span> &amp;&amp;</div><div class="line">                        br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a12d073a72871fca75a4f8bfb7ab43170">tts_handle</a> != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="comment">/* Sanity check if BLE TTS session is ongoing */</span></div><div class="line">                    <span class="keywordflow">if</span> (le_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp;</div><div class="line">                        le_link-&gt;<a class="code" href="struct_t___a_p_p___l_e___l_i_n_k.html#a38755635de9b8ecfe30070ca64558d38">cmd_set_enable</a> == <span class="keyword">true</span> &amp;&amp;</div><div class="line">                        le_link-&gt;<a class="code" href="struct_t___a_p_p___l_e___l_i_n_k.html#a12d073a72871fca75a4f8bfb7ab43170">tts_handle</a> != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#ad1e7efad522a4a716eb0c2de47864a18">call_id_type_check</a> == <span class="keyword">true</span>)</div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">if</span> (br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a087e2f6dc5d9eaf16961f3984f062df6">connected_profile</a> &amp; <a class="code" href="group___a_p_p___l_i_n_k.html#ga26fcc4e4a0497c6c789b70de17426485">PBAP_PROFILE_MASK</a>)</div><div class="line">                        {</div><div class="line">                            <span class="keywordflow">if</span> (<a class="code" href="group___b_t___p_b_a_p.html#ga3c5a93f2649a49a502a6da87488300c4">bt_pbap_vcard_listing_by_number_pull</a>(br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, number) == <span class="keyword">false</span>)</div><div class="line">                            {</div><div class="line">                                br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#ad1e7efad522a4a716eb0c2de47864a18">call_id_type_check</a> = <span class="keyword">false</span>;</div><div class="line">                                br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#aab0f79749e310456f2ed9732d9ae4898">call_id_type_num</a> = <span class="keyword">true</span>;</div><div class="line">                            }</div><div class="line">                        }</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                        {</div><div class="line">                            br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#ad1e7efad522a4a716eb0c2de47864a18">call_id_type_check</a> = <span class="keyword">false</span>;</div><div class="line">                            br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#aab0f79749e310456f2ed9732d9ae4898">call_id_type_num</a> = <span class="keyword">true</span>;</div><div class="line">                        }</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#ad1e7efad522a4a716eb0c2de47864a18">call_id_type_check</a> == <span class="keyword">false</span>)</div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">if</span> (br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#aab0f79749e310456f2ed9732d9ae4898">call_id_type_num</a> == <span class="keyword">true</span>)</div><div class="line">                        {</div><div class="line">                            uint8_t *data;</div><div class="line">                            uint16_t len;</div><div class="line"></div><div class="line">                            len = param-&gt;bt_pbap_caller_id_name.name_len + 3;</div><div class="line">                            data = <a class="code" href="group___o_s__87x3d___memory.html#ga08d79d2a875308455fdffbac5cb4ec67">os_mem_alloc</a>(<a class="code" href="group__x3e___m_e_m___c_o_n_f_i_g___exported___types.html#gga20f6fc28665b1bdf8326a4826ba69b77a53394a9ecf33e56adc53407220bae73d">RAM_TYPE_DATA_ON</a>, len);</div><div class="line">                            <span class="keywordflow">if</span> (data != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">                            {</div><div class="line">                                data[1] = <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#ga75e3da60abbbe2d46fc088dd8f910668">CALLER_ID_TYPE_NUMBER</a>;</div><div class="line">                                data[2] = param-&gt;bt_pbap_caller_id_name.name_len;</div><div class="line">                                memcpy(data + 3, param-&gt;bt_pbap_caller_id_name.name_ptr, param-&gt;bt_pbap_caller_id_name.name_len);</div><div class="line"></div><div class="line">                                <span class="keywordflow">if</span> (br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a087e2f6dc5d9eaf16961f3984f062df6">connected_profile</a> &amp; (<a class="code" href="group___a_p_p___l_i_n_k.html#ga565f4ea09776244c88b0d664e70f8c51">SPP_PROFILE_MASK</a> | <a class="code" href="group___a_p_p___l_i_n_k.html#ga121b2a223388f6710ce984ffc14bb59b">IAP_PROFILE_MASK</a>))</div><div class="line">                                {</div><div class="line">                                    data[0] = br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>;</div><div class="line"></div><div class="line">                                    <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gab68a0f6aaed4553d0c5bad7608f434dc">app_report_event</a>(<a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gga5d33818623af7687eff8863825004c35ad02df31c353532bddcf4743ad9d7725b">CMD_PATH_SPP</a>, <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gga7726a52eb69945b78d3a5a1463a839c7ad701e51a8ac05dd16f8aca7263f22e69">EVENT_CALLER_ID</a>, br_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>, data, len);</div><div class="line">                                }</div><div class="line">                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (le_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">                                {</div><div class="line">                                    data[0] = le_link-&gt;<a class="code" href="struct_t___a_p_p___l_e___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>;</div><div class="line"></div><div class="line">                                    <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gab68a0f6aaed4553d0c5bad7608f434dc">app_report_event</a>(<a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gga5d33818623af7687eff8863825004c35a2cfe9880e07a8da7b6433b13ee5639b4">CMD_PATH_LE</a>, <a class="code" href="group___a_p_p___r_e_p_o_r_t.html#gga7726a52eb69945b78d3a5a1463a839c7ad701e51a8ac05dd16f8aca7263f22e69">EVENT_CALLER_ID</a>, le_link-&gt;<a class="code" href="struct_t___a_p_p___l_e___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>, data, len);</div><div class="line">                                }</div><div class="line"></div><div class="line">                                <a class="code" href="group___o_s__87x3d___memory.html#ga9f49944885e39c41ea8232fba92cc5f3">os_mem_free</a>(data);</div><div class="line">                            }</div><div class="line">                        }</div><div class="line">                    }</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83af1917d89dad541d96db32e985628851a">BT_EVENT_HFP_RING_ALERT</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_ring_alert.bd_addr);</div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#acbb436b0b95ac25d702c5aca29db7a9f">is_inband_ring</a> = param-&gt;bt_hfp_ring_alert.is_inband;</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> ((<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a0b131e9394896f7a14c9536d6b7dc263">always_play_hf_incoming_tone_when_incoming_call</a> == <span class="keyword">false</span>) &amp;&amp;</div><div class="line">                    ((p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#acbb436b0b95ac25d702c5aca29db7a9f">is_inband_ring</a> == <span class="keyword">false</span>) ||</div><div class="line">                     (p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a> != active_hf_index))) <span class="comment">/* TODO check active sco link */</span></div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span> (hf_ring_active == <span class="keyword">false</span> &amp;&amp; p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a3bb53bb05ce52bd46410f7b8dfbbc7de">call_status</a> == BT_HFP_INCOMING_CALL_ONGOING)</div><div class="line">                    {</div><div class="line">                        hf_ring_active = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">                        app_hfp_ring_alert(p_link);</div><div class="line">                    }</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83ab4672d5b4ce596eaabba10b694fd7b30">BT_EVENT_HFP_SPK_VOLUME_CHANGED</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_spk_volume_changed.bd_addr);</div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (app_src_profile_hook)</div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span> ((<a class="code" href="group___a_p_p___h_f_p___exported___functions.html#gaef415e5a1bb0cf3dab1a460d3f48cf6b">app_hfp_get_call_status</a>() == BT_HFP_INCOMING_CALL_ONGOING) &amp;&amp; app_src_profile_hook())</div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">break</span>;</div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#afd3eb4ae2abac37a11e81b73b4a7282b">remote_session_state</a> == <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#gga3fafc6057a393641404e5040d6f0aca9a0d477163c2943e4e2aa3059ac6f26db4">REMOTE_SESSION_STATE_DISCONNECTED</a>)</div><div class="line">                {</div><div class="line">                    uint8_t pair_idx;</div><div class="line"></div><div class="line">                    <a class="code" href="group___b_t___b_o_n_d.html#gabd7e0cc969a6f8ab3a5203c394e62966">bt_bond_index_get</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, &amp;pair_idx);</div><div class="line"></div><div class="line">                    <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx] = (param-&gt;bt_hfp_spk_volume_changed.volume *</div><div class="line">                                                             <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.voice_out_volume_max +</div><div class="line">                                                             0x0f / 2) / 0x0f;</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (app_audio_vol_set_hook)</div><div class="line">                    {</div><div class="line">                        app_audio_vol_set_hook(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a39f70e8221d4fc61cbd963ea158f5272">sco_track_handle</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx]);</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">else</span></div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.<a class="code" href="struct_t___a_p_p___c_f_g___c_o_n_s_t.html#a83d86c558a207b13669fe7a137a99317">enable_rtk_charging_box</a>)</div><div class="line">                        {</div><div class="line">                            <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#ab05f3bc95325c660b0cb6a59e0a31136">local_in_case</a>)</div><div class="line">                            {</div><div class="line">                                app_adp_volume_mute();</div><div class="line">                            }</div><div class="line">                            <span class="keywordflow">else</span></div><div class="line">                            {</div><div class="line">                                audio_track_volume_set(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a39f70e8221d4fc61cbd963ea158f5272">sco_track_handle</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx]);</div><div class="line">                                <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a15e9ee63af9e1e95b610972adc6b90b7">voice_muted</a>)</div><div class="line">                                {</div><div class="line">                                    <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a15e9ee63af9e1e95b610972adc6b90b7">voice_muted</a> = <span class="keyword">false</span>;</div><div class="line">                                }</div><div class="line">                            }</div><div class="line">                        }</div><div class="line">                        <span class="keywordflow">else</span></div><div class="line">                        {</div><div class="line">                            audio_track_volume_set(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a39f70e8221d4fc61cbd963ea158f5272">sco_track_handle</a>, <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx]);</div><div class="line">                            <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a15e9ee63af9e1e95b610972adc6b90b7">voice_muted</a>)</div><div class="line">                            {</div><div class="line">                                <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a15e9ee63af9e1e95b610972adc6b90b7">voice_muted</a> = <span class="keyword">false</span>;</div><div class="line">                            }</div><div class="line">                        }</div><div class="line">                    }</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    uint8_t cmd_ptr[8];</div><div class="line">                    uint8_t pair_idx;</div><div class="line"></div><div class="line">                    <a class="code" href="group___b_t___b_o_n_d.html#gabd7e0cc969a6f8ab3a5203c394e62966">bt_bond_index_get</a>(p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, &amp;pair_idx);</div><div class="line">                    <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx] = (param-&gt;bt_hfp_spk_volume_changed.volume *</div><div class="line">                                                             <a class="code" href="group___a_p_p___c_f_g___exported___types.html#gae5da1e58b53e3ae552aafa6d26ade7a2">app_cfg_const</a>.voice_out_volume_max +</div><div class="line">                                                             0x0f / 2) / 0x0f;</div><div class="line">                    memcpy(&amp;cmd_ptr[0], p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, 6);</div><div class="line">                    cmd_ptr[6] = <a class="code" href="group___a_u_d_i_o___t_y_p_e.html#gga58d0e7dea1cb97d070b4535c99687442aaf15f46f952866ad95de479b386e9eb5">AUDIO_STREAM_TYPE_VOICE</a>;</div><div class="line">                    cmd_ptr[7] = <a class="code" href="group___a_p_p___c_f_g___exported___types.html#ga0063edee2b4c1c981d2db26ef6ff820a">app_cfg_nv</a>.<a class="code" href="struct_t___a_p_p___c_f_g___n_v.html#a11138dc3ab49060cb2f452d3c3f29f75">voice_gain_level</a>[pair_idx];</div><div class="line">                    <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#gabb6b79a86444ce0a4c07ef50147f4662">remote_sync_msg_relay</a>(<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a71ee7cfbfecc5356ca250f737f4df9f8">relay_handle</a>, <a class="code" href="group___a_p_p___a_u_d_i_o___exported___functions.html#gga05adeb416e34d22f4c156aa854695a61a46aa99a40ffb33ad00c4072a33d7102b">APP_REMOTE_MSG_HFP_VOLUME_SYNC</a>, cmd_ptr, 8,</div><div class="line">                                          <a class="code" href="group___r_e_m_o_t_e___c_o_n_t_r_o_l.html#gga3c3ff337bc7252c709cee6e8495078efafcba9650d813dbd1b86ffa3daaad5ec6">REMOTE_TIMER_HIGH_PRECISION</a>, 0, <span class="keyword">false</span>);</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83ae243ac611968ba0347d16baa1791ae1a">BT_EVENT_HFP_MIC_VOLUME_CHANGED</a>:</div><div class="line">        {</div><div class="line"></div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a9724a83efcc548be532cf105940434f5">BT_EVENT_HFP_DISCONN_CMPL</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;bt_hfp_disconn_cmpl.bd_addr);</div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (param-&gt;bt_hfp_disconn_cmpl.cause == (<a class="code" href="group___b_t___t_y_p_e_s.html#gae35728cf2b661cfdb28c841fed5a5ca3">HCI_ERR</a> | <a class="code" href="group___b_t___t_y_p_e_s.html#ga61cd296ae7351dc1b57466b814e78fde">HCI_ERR_CONN_ROLESWAP</a>))</div><div class="line">                {</div><div class="line">                    <span class="comment">//do nothing</span></div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    uint8_t i;</div><div class="line"></div><div class="line">                    p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a3bb53bb05ce52bd46410f7b8dfbbc7de">call_status</a> = <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>;</div><div class="line">                    p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a138135185d28d4e30105c39618fbd245">app_hf_state</a> = <a class="code" href="group___a_p_p___l_i_n_k.html#gga53404b285b3544df1665811c5895b438a2a895e3aa3395f44abda105ab6f965c6">APP_HF_STATE_STANDBY</a>;</div><div class="line">                    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a03fba0e4e9598f1d4a632fc20a674dcf">first_hf_index</a> == p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a1e6927fa1486224044e568f9c370519b">id</a>)</div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a03fba0e4e9598f1d4a632fc20a674dcf">first_hf_index</a> = <a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a8b3cd3842b2a12c36296099602fe8cd0">last_hf_index</a>;</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group___a_p_p___l_i_n_k.html#ga51f528a501ab0487c37c465106298105">MAX_BR_LINK_NUM</a>; i++)</div><div class="line">                    {</div><div class="line">                        <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a790da4b2b0fd0935efe47dc4aad8f147">br_link</a>[i].<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a087e2f6dc5d9eaf16961f3984f062df6">connected_profile</a> &amp; (<a class="code" href="group___a_p_p___l_i_n_k.html#ga9350dc5450acd9e6076db7f0335eed81">HFP_PROFILE_MASK</a> | <a class="code" href="group___a_p_p___l_i_n_k.html#ga94f008dab48d6c04e67c336effad9519">HSP_PROFILE_MASK</a>))</div><div class="line">                        {</div><div class="line">                            app_hfp_set_active_hf_index(<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a790da4b2b0fd0935efe47dc4aad8f147">br_link</a>[i].<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>);</div><div class="line">                            <a class="code" href="group___a_p_p___b_o_n_d.html#ga045abc13728a921bef309071328bf4d9">app_bond_set_priority</a>(<a class="code" href="group___a_p_p___m_a_i_n___exported___variables.html#gacfc09f2731e227125edccf8bcf944926">app_db</a>.<a class="code" href="struct_t___a_p_p___d_b.html#a790da4b2b0fd0935efe47dc4aad8f147">br_link</a>[i].<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>);</div><div class="line">                            <span class="keywordflow">break</span>;</div><div class="line">                        }</div><div class="line">                    }</div><div class="line"></div><div class="line">                    <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___h_f_p___exported___functions.html#gaef415e5a1bb0cf3dab1a460d3f48cf6b">app_hfp_get_call_status</a>() != <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>)</div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___a_p_p___h_f_p___exported___functions.html#gad2b6f496c1d95d3ae2f187c9ad4328a4">app_hfp_update_call_status</a>();</div><div class="line">                    }</div><div class="line">                }</div><div class="line"></div><div class="line">                <span class="keywordflow">if</span> ((param-&gt;bt_hfp_disconn_cmpl.cause &amp; ~<a class="code" href="group___b_t___t_y_p_e_s.html#gae35728cf2b661cfdb28c841fed5a5ca3">HCI_ERR</a>) != <a class="code" href="group___b_t___t_y_p_e_s.html#ga61cd296ae7351dc1b57466b814e78fde">HCI_ERR_CONN_ROLESWAP</a>)</div><div class="line">                {</div><div class="line">                    app_hfp_check_service_status();</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    ......</div><div class="line"></div><div class="line">    <span class="keywordflow">default</span>:</div><div class="line">        handle = <span class="keyword">false</span>;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (handle == <span class="keyword">true</span>)</div><div class="line">    {</div><div class="line">        <a class="code" href="group___t_r_a_c_e.html#ga81687b044a4d8600c4be891734f4839a">APP_PRINT_INFO1</a>(<span class="stringliteral">&quot;app_hfp_bt_cback: event_type 0x%04x&quot;</span>, event_type);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --></li>
<li>HFP HF and HSP HS all events <a class="el" href="group___b_t___b_t_m.html#ga60f938d2fe9ea1ac81e1bf400fbb5b03">T_BT_EVENT</a> are refered as below. <div class="fragment"><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a7d2a1dc52fb12dec5742f8cbcf065a72">BT_EVENT_HFP_CONN_IND</a>                             = 0x3400,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP connection complete \ref T_BT_EVENT_PARAM_HFP_CONN_CMPL.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a260fb5fa6196b0cca640a30c21b80e73">BT_EVENT_HFP_CONN_CMPL</a>                            = 0x3401,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP connection fail \ref T_BT_EVENT_PARAM_HFP_CONN_FAIL.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a4687c7b0080db92724ecc36815445a12">BT_EVENT_HFP_CONN_FAIL</a>                            = 0x3402,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP disconnected \ref T_BT_EVENT_PARAM_HFP_DISCONN_CMPL.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a9724a83efcc548be532cf105940434f5">BT_EVENT_HFP_DISCONN_CMPL</a>                         = 0x3403,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP speaker volume changed \ref T_BT_EVENT_PARAM_HFP_SPK_VOLUME_CHANGED.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83ab4672d5b4ce596eaabba10b694fd7b30">BT_EVENT_HFP_SPK_VOLUME_CHANGED</a>                   = 0x3404,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP microphone volume changed \ref T_BT_EVENT_PARAM_HFP_MIC_VOLUME_CHANGED.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83ae243ac611968ba0347d16baa1791ae1a">BT_EVENT_HFP_MIC_VOLUME_CHANGED</a>                   = 0x3405,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP call status change \ref T_BT_EVENT_PARAM_HFP_CALL_STATUS.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a2e4e92442dda7112614cc76d14f7ee5b">BT_EVENT_HFP_CALL_STATUS</a>                          = 0x3406,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP service status change \ref T_BT_EVENT_PARAM_HFP_SERVICE_STATUS.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aee1814f9e73f884cf9b22f48c63f2a82">BT_EVENT_HFP_SERVICE_STATUS</a>                       = 0x3407,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate the incoming caller phone number \ref T_BT_EVENT_PARAM_HFP_CALLER_ID_IND.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aa35683c83c52d5b0dfd3d0cf87ac0b9f">BT_EVENT_HFP_CALLER_ID_IND</a>                        = 0x3408,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate the network operator \ref T_BT_EVENT_PARAM_HFP_NETWORK_OPERATOR_IND.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83acd0387021ab79583efcb5e14b26c91ae">BT_EVENT_HFP_NETWORK_OPERATOR_IND</a>                 = 0x3409,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate the subscriber number \ref T_BT_EVENT_PARAM_HFP_SUBSCRIBER_NUMBER_IND.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a5cec945e9775959d7466b2ec976bcbe8">BT_EVENT_HFP_SUBSCRIBER_NUMBER_IND</a>                = 0x340a,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate the current calls \ref T_BT_EVENT_PARAM_HFP_CURRENT_CALL_LIST_IND.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a3d2457aa2e9384b789dd1d124955d230">BT_EVENT_HFP_CURRENT_CALL_LIST_IND</a>                = 0x340b,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate the call waiting \ref T_BT_EVENT_PARAM_HFP_CALL_WAITING_IND.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a350f8c8e2902ebd410b1daba9602b0bf">BT_EVENT_HFP_CALL_WAITING_IND</a>                     = 0x340c,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate the signal indicator \ref T_BT_EVENT_PARAM_HFP_SIGNAL_IND.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a2215ca381a9f5647087fa1500b93a4c9">BT_EVENT_HFP_SIGNAL_IND</a>                           = 0x340d,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">* \\brief Indicate the roam indicator \ref T_BT_EVENT_PARAM_HFP_ROAM_IND.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aa92233755b3dd0f56f8afdf8e22c6cff">BT_EVENT_HFP_ROAM_IND</a>                             = 0x340e,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">* \\brief Indicate the battery indicator \ref T_BT_EVENT_PARAM_HFP_BATTERY_IND.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a28a37ec304027fd744fea855c3e1b203">BT_EVENT_HFP_BATTERY_IND</a>                          = 0x340f,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">* \\brief Indicate remote AG supported features \ref T_BT_EVENT_PARAM_HFP_SUPPORTED_FEATURES_IND.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a1f8029e839074b847513df9a490e1203">BT_EVENT_HFP_SUPPORTED_FEATURES_IND</a>               = 0x3410,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP unknow AT event \ref T_BT_EVENT_PARAM_HFP_UNKNOW_AT_EVENT.</span></div><div class="line"><span class="comment"> */</span></div><div class="line">BT_EVENT_HFP_UNKNOW_AT_EVENT                      = 0x3411,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate HFP vendor AT command result \ref T_BT_EVENT_PARAM_HFP_VENDOR_AT_RESULT.</span></div><div class="line"><span class="comment"> */</span></div><div class="line">BT_EVENT_HFP_VENDOR_AT_RESULT                     = 0x3412,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate an incoming call \ref T_BT_EVENT_PARAM_HFP_RING_ALERT.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83af1917d89dad541d96db32e985628851a">BT_EVENT_HFP_RING_ALERT</a>                           = 0x3413,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate voice recognition activation \ref T_BT_EVENT_PARAM_HFP_VOICE_RECOGNITION_ACTIVATION.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a2849b522bddc94f84ce645003e88f356">BT_EVENT_HFP_VOICE_RECOGNITION_ACTIVATION</a>         = 0x3414,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate voice recognition deactivation \ref T_BT_EVENT_PARAM_HFP_VOICE_RECOGNITION_DEACTIVATION.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a6de66a4b7bd15d28f14a849d90dca1be">BT_EVENT_HFP_VOICE_RECOGNITION_DEACTIVATION</a>       = 0x3415,</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * \\brief Indicate dial with number result \ref T_BT_EVENT_PARAM_HFP_DIAL_WITH_NUMBER_RESULT.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a84924b7bc53e4addbf82bb8a84674a3d">BT_EVENT_HFP_DIAL_WITH_NUMBER_RESULT</a>              = 0x3416,</div></div><!-- fragment --></li>
<li>HFP/HSP profile connection requst should be confirmed when receives <a class="el" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a7d2a1dc52fb12dec5742f8cbcf065a72">BT_EVENT_HFP_CONN_IND</a>.</li>
<li>HFP/HSP profile connection is completed when receives <a class="el" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a260fb5fa6196b0cca640a30c21b80e73">BT_EVENT_HFP_CONN_CMPL</a>.</li>
<li>HFP/HSP profile disconnection is indicated when receives <a class="el" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a9724a83efcc548be532cf105940434f5">BT_EVENT_HFP_DISCONN_CMPL</a>.</li>
<li>HFP HF and HSP HS call status <a class="el" href="group___b_t___h_f_p.html#gaef1b59a02955bcc23e27fb42721788d1">T_BT_HFP_CALL_STATUS</a> is updated with event <a class="el" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a2e4e92442dda7112614cc76d14f7ee5b">BT_EVENT_HFP_CALL_STATUS</a> when HF recieve related AG indicators or HF take action to change it. <div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="group___b_t___h_f_p.html#ga71dc8535e88cd8ea60bdf8f574317841">t_bt_hfp_call_status</a></div><div class="line">{</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a6e4dbd4c6c100b2d903a4baf6c5057f3">BT_HFP_CALL_IDLE</a>                              = 0x00,</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a43a587aa8a6b8e4ce79990c52b6e432e">BT_HFP_CALL_INCOMING</a>                          = 0x01,</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a75f69b178c6f0ab8ed4397513955fe25">BT_HFP_CALL_OUTGOING</a>                          = 0x02,</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a85f0b0a1b3b00478808a5fcc21d9397a">BT_HFP_CALL_ACTIVE</a>                            = 0x03,</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a9ce300b70efff89827981589e021928a">BT_HFP_CALL_HELD</a>                              = 0x04,</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841ad32405407740084ca83cecacb581384d">BT_HFP_CALL_ACTIVE_WITH_CALL_WAITING</a>          = 0x05,</div><div class="line">    <a class="code" href="group___b_t___h_f_p.html#gga71dc8535e88cd8ea60bdf8f574317841a68c8bd0f734b047cf47ca533ad1c3043">BT_HFP_CALL_ACTIVE_WITH_CALL_HELD</a>             = 0x06,</div><div class="line">} <a class="code" href="group___b_t___h_f_p.html#gaef1b59a02955bcc23e27fb42721788d1">T_BT_HFP_CALL_STATUS</a>;</div></div><!-- fragment --> </li>
</ul>
</div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
