<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="OPP_USER_MANU"></a>
OPP Application Note </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.1</b></center><p><br />
 </p><center><b>2023/12/01</b></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Revision_History"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.0  </td><td class="markdownTableBodyCenter">2023/06/22  </td><td class="markdownTableBodyCenter">Stable release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.1  </td><td class="markdownTableBodyCenter">2023/12/01  </td><td class="markdownTableBodyCenter">Figure adjust   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Content"></a>
Contents</h2>
<ul>
<li><a class="el" href="_o_p_p.html#OPP_Revision_History">Revision History</a></li>
<li><a class="el" href="_o_p_p.html#OPP_Table_List">Table List</a></li>
<li><a class="el" href="_o_p_p.html#OPP_Figure_List">Figure List</a></li>
<li><a class="el" href="_o_p_p.html#OPP_Glossary">Glossary</a></li>
<li><a class="el" href="_o_p_p.html#OPP_Intro">1 Introduction</a><ul>
<li><a class="el" href="_o_p_p.html#OPP_role_featrues">1.1 OPP Role Featrues</a></li>
<li><a class="el" href="_o_p_p.html#OPP_profile_stack">1.2 OPP Profile Stack</a></li>
</ul>
</li>
<li><a class="el" href="_o_p_p.html#OPP_API">2 OPP API Introduction</a><ul>
<li><a class="el" href="_o_p_p.html#OPP_Init">2.1 OPP Init</a></li>
<li><a class="el" href="_o_p_p.html#OPP_Connect">2.2 OPP Connect</a></li>
<li><a class="el" href="_o_p_p.html#OPP_Command">2.3 OPP Command</a></li>
</ul>
</li>
<li><a class="el" href="_o_p_p.html#OPP_Code_Ov">3 Source Code Overview</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Table_List"></a>
Table List</h2>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Figure_List"></a>
Figure List</h2>
<ul>
<li><a href="#figure_1_1">Figure 1-1 OPP Proifle Scenario</a></li>
<li><a href="#figure_1_2">Figure 1-2 OPP Protocol Model</a></li>
<li><a href="#figure_2_1">Figure 2-1 OPP Connect Over L2CAP Request</a></li>
<li><a href="#figure_2_2">Figure 2-2 OPP Connect Over RFC Request</a></li>
<li><a href="#figure_2_3">Figure 2-3 OPP Disconnect Request</a></li>
<li><a href="#figure_2_4">Figure 2-4 OPP Data Transfer</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Glossary"></a>
Glossary</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Terms  </th><th class="markdownTableHeadCenter">Definitions   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">OPP  </td><td class="markdownTableBodyCenter">Object Push Profile   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Intro"></a>
1 Introduction</h2>
<p>The purpose of this document is to give an overview of the Object Push Profile(OPP). OPP is used to transfer object through Bluetooth between two devices.</p>
<h3><a class="anchor" id="OPP_role_featrues"></a>
1.1 OPP Role Featrues</h3>
<p>OPP roles are typically defined as Figure 1-1.</p><ul>
<li>Device A (DevA) - This device pushes and pulls objects to and from the Push Server.<ul>
<li>OPP client</li>
</ul>
</li>
<li>Device B (DevB) - This device provides an object exchange server.<ul>
<li>OPP server <div class="image">
<img src="opp_profile_scenario.jpg" alt="opp_profile_scenario.jpg"/>
</div>
 <center><div id="figure_1_1"><b>Figure 1-1 OPP Proifle Scenario</b></div></center></li>
</ul>
</li>
</ul>
<p><br />
 </p>
<h3><a class="anchor" id="OPP_profile_stack"></a>
1.2 OPP Profile Stack</h3>
<p>Protocols and entities used in OPP profile shown in Figure 1-2. </p><div class="image">
<img src="opp_protocol_model.jpg" alt="opp_protocol_model.jpg"/>
</div>
 <center><div id="figure_1_2"><b>Figure 1-2 Protocol Model</b></div></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_API"></a>
2 OPP API Introduction</h2>
<p>This manual describes the <b>OPP API definition</b>.</p>
<h3><a class="anchor" id="OPP_Init"></a>
2.1 OPP Init</h3>
<p>bool <a class="el" href="group___b_t___o_p_p.html#ga50960ee2e09fac843c11d5e12d4da501" title="Initialize OPP profile. ">bt_opp_init()</a> <br />
 Initialize OPP profile, and configure the maximum link number of opp. Set rfcomm channel number and L2CAP PSM. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> app_opp_init(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <a class="code" href="group___b_t___s_d_p.html#ga929bad3b33b7416db99e39e776641fef">bt_sdp_record_add</a>((<span class="keywordtype">void</span> *)opp_sdp_record);</div><div class="line">    <a class="code" href="group___b_t___o_p_p.html#ga50960ee2e09fac843c11d5e12d4da501">bt_opp_init</a>(2, RFC_OPP_CHANN_NUM, L2CAP_OPP_PSM);</div><div class="line">    <a class="code" href="group___b_t___b_t_m.html#gad5518472fde08b8e93d5fc9c40d72f85">bt_mgr_cback_register</a>(app_opp_bt_cback);</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="OPP_Connect"></a>
2.2 OPP Connect</h3>
<p>bool <a class="el" href="group___b_t___o_p_p.html#ga9f2512d754bc7c15cdcec4634c33a4b8" title="Send a OPP connection request over L2CAP. ">bt_opp_connect_over_l2c_req()</a> <br />
 Initiate a opp connection over l2cap to a remote device , as shown in Figure 2-1. </p><div class="image">
<img src="opp_connect_over_l2cap_request.PNG" alt="opp_connect_over_l2cap_request.PNG"/>
</div>
 <center><div id="figure_2_1"><b>Figure 2-1 OPP Connect Over L2CAP Request</b></div></center><p>bool <a class="el" href="group___b_t___o_p_p.html#ga34fcc1612840970ec26ccaa8da174b49" title="Send a OPP connection request over RFCOMM. ">bt_opp_connect_over_rfc_req()</a> <br />
 Initiate a opp connection over rfcomm to a remote device , as shown in Figure 2-2. </p><div class="image">
<img src="opp_connect_over_rfc_request.PNG" alt="opp_connect_over_rfc_request.PNG"/>
</div>
 <center><div id="figure_2_2"><b>Figure 2-2 OPP Connect Over RFC Request</b></div></center><p>bool <a class="el" href="group___b_t___o_p_p.html#gaf02f083477b1651e6b6afbaac8236606" title="Send a OPP disconnection request. ">bt_opp_disconnect_req()</a> <br />
 Request a opp disconnection, as shown in Figure 2-3. </p><div class="image">
<img src="opp_disconnect_request.PNG" alt="opp_disconnect_request.PNG"/>
</div>
 <center><div id="figure_2_3"><b>Figure 2-3 OPP Disconnect Request</b></div></center><p>bool <a class="el" href="group___b_t___o_p_p.html#gaebfc8d6d6f3aeed821fc4e3b1aa26c53" title="Accept or reject the incoming OPP Connection. ">bt_opp_connect_cfm()</a> <br />
 Accept or reject the incoming opp connection from the remote device.</p>
<h3><a class="anchor" id="OPP_Command"></a>
2.3 OPP Command</h3>
<p>bool <a class="el" href="group___b_t___o_p_p.html#gab99505a35e0bdf4bd9a9f74e59e3d23e" title="Request to push data header. ">bt_opp_push_data_header_req()</a> <br />
 OPP client request to push data header to opp server.<br />
 The type fo data header is MIME type, which can be found in <a href="https://datatracker.ietf.org/doc/html/rfc6838">https://datatracker.ietf.org/doc/html/rfc6838</a>.</p>
<p>bool <a class="el" href="group___b_t___o_p_p.html#ga07d764602ad814b54ceb7d287999df2f" title="Request to push data. ">bt_opp_push_data_req()</a> <br />
 OPP client request to push data to opp server.</p>
<p>bool <a class="el" href="group___b_t___o_p_p.html#gae7f33cfd1dc944159b1fa16656b7bd26" title="Acknowledge on receiving an OPP data indication. ">bt_opp_send_data_rsp()</a> <br />
 OPP server acknowledge on receiving an OPP data Indication.</p>
<p>bool <a class="el" href="group___b_t___o_p_p.html#gad0a85ddad1e6aa46a4ae9f2b3edd5c7d" title="Request to terminate the push operation. ">bt_opp_push_abort()</a> <br />
 Request to terminate the push operation.</p>
<p>Figure 2-4 shows data transfer between opp client with opp server. </p><div class="image">
<img src="opp_data_transfer.PNG" alt="opp_data_transfer.PNG"/>
</div>
 <center><div id="figure_2_4"><b>Figure 2-4 OPP Data Transfer</b></div></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="OPP_Code_Ov"></a>
3 Source Code Overview</h2>
<p>The following sections describe important parts of OPP application.<br />
 As opp client, after sending data, the next data cannot be sent until the BT_EVENT_OPP_DATA_RSP is received.<br />
 As server, after receiving data BT_EVENT_OPP_DATA_IND, app must use bt_opp_send_data_rsp to send response.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define RFC_OPP_CHANN_NUM               24</span></div><div class="line"><span class="preprocessor">#define L2CAP_OPP_PSM                   0x1003</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> uint8_t opp_sdp_record[] =</div><div class="line">{</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x50,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#gae6e31379df951f323d24e4f8b85d42d3">SDP_ATTR_SRV_CLASS_ID_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#gae6e31379df951f323d24e4f8b85d42d3">SDP_ATTR_SRV_CLASS_ID_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x03,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga7a0ee5d3fb1ac8cdb2f22bdcede0164c">UUID_OBEX_OBJECT_PUSH</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga7a0ee5d3fb1ac8cdb2f22bdcede0164c">UUID_OBEX_OBJECT_PUSH</a>),</div><div class="line"></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga3e3afe98f67b0f02ee51ca67e2d257b6">SDP_ATTR_PROTO_DESC_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga3e3afe98f67b0f02ee51ca67e2d257b6">SDP_ATTR_PROTO_DESC_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x11,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x03,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga847ad44f6d4c69761ac39371da15020d">UUID_L2CAP</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga847ad44f6d4c69761ac39371da15020d">UUID_L2CAP</a>),</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x05,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#gae79453f41389da4c5f2bdd1b31814dd0">UUID_RFCOMM</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#gae79453f41389da4c5f2bdd1b31814dd0">UUID_RFCOMM</a>),</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,</div><div class="line">    RFC_OPP_CHANN_NUM,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x03,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga557e72866e03a88e7f8af7936a0ef352">UUID_OBEX</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga557e72866e03a88e7f8af7936a0ef352">UUID_OBEX</a>),</div><div class="line"></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga4aa7aa3090459d3056faa878fcfde257">SDP_ATTR_PROFILE_DESC_LIST</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga4aa7aa3090459d3056faa878fcfde257">SDP_ATTR_PROFILE_DESC_LIST</a>,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x08,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x06,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga9d465beea934f5f89796f9c6901da35c">SDP_UUID16_HDR</a>,</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___u_u_i_d.html#ga7a0ee5d3fb1ac8cdb2f22bdcede0164c">UUID_OBEX_OBJECT_PUSH</a> &gt;&gt; 8),</div><div class="line">    (uint8_t)<a class="code" href="group___b_t___u_u_i_d.html#ga7a0ee5d3fb1ac8cdb2f22bdcede0164c">UUID_OBEX_OBJECT_PUSH</a>,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    0x01,</div><div class="line">    0x02,   <span class="comment">/* version 1.2 */</span></div><div class="line"></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)((<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga3c3fbd0a8e6f368f0a3261835901488d">SDP_ATTR_SRV_NAME</a> + <a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga8724613c287eece3321573a98c81da5b">SDP_BASE_LANG_OFFSET</a>) &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga3c3fbd0a8e6f368f0a3261835901488d">SDP_ATTR_SRV_NAME</a> + <a class="code" href="group___b_t___s_d_p___a_t_t_r_i_b_u_t_e_s.html#ga8724613c287eece3321573a98c81da5b">SDP_BASE_LANG_OFFSET</a>),</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga7e6da9cd524f983c421d0d84d65d8855">SDP_STRING_HDR</a>,</div><div class="line">    0x0B,</div><div class="line">    <span class="charliteral">&#39;R&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="charliteral">&#39;l&#39;</span>, <span class="charliteral">&#39;t&#39;</span>, <span class="charliteral">&#39;e&#39;</span>, <span class="charliteral">&#39;k&#39;</span>, <span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;P&#39;</span>,</div><div class="line"></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)((<a class="code" href="group___b_t___s_d_p___p_r_o_f_i_l_e___a_t_t_r_i_b_u_t_e_s.html#ga39084a08425c2c65188bbc291f86acc9">SDP_ATTR_L2C_PSM</a>) &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___s_d_p___p_r_o_f_i_l_e___a_t_t_r_i_b_u_t_e_s.html#ga39084a08425c2c65188bbc291f86acc9">SDP_ATTR_L2C_PSM</a>),</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)(L2CAP_OPP_PSM &gt;&gt; 8),</div><div class="line">    (uint8_t)(L2CAP_OPP_PSM),</div><div class="line"></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga942a94138894beb2b2bc75daebc6e2d0">SDP_UNSIGNED_TWO_BYTE</a>,</div><div class="line">    (uint8_t)((<a class="code" href="group___b_t___s_d_p___p_r_o_f_i_l_e___a_t_t_r_i_b_u_t_e_s.html#ga1dfb441d1eabd4f64c28646bb9878748">SDP_ATTR_SUPPORTED_FORMATS_LIST</a>) &gt;&gt; 8),</div><div class="line">    (uint8_t)(<a class="code" href="group___b_t___s_d_p___p_r_o_f_i_l_e___a_t_t_r_i_b_u_t_e_s.html#ga1dfb441d1eabd4f64c28646bb9878748">SDP_ATTR_SUPPORTED_FORMATS_LIST</a>),</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga3162e2d0cb09ada26915070f4082f82a">SDP_DATA_ELEM_SEQ_HDR</a>,</div><div class="line">    0x0a,</div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,</div><div class="line">    0x01, <span class="comment">/* vCard 2.1 */</span></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,</div><div class="line">    0x02, <span class="comment">/* vCard 3.0 */</span></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,</div><div class="line">    0x03, <span class="comment">/* vCal 1.0 */</span></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,</div><div class="line">    0x04, <span class="comment">/* vCal 2.0 */</span></div><div class="line">    <a class="code" href="group___b_t___s_d_p___h_e_a_d_e_r.html#ga87b74d21f9c850aa838ad27c2881982a">SDP_UNSIGNED_ONE_BYTE</a>,</div><div class="line">    0xff, <span class="comment">/* any type of object */</span></div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_opp_bt_cback(<a class="code" href="group___b_t___b_t_m.html#ga60f938d2fe9ea1ac81e1bf400fbb5b03">T_BT_EVENT</a> event_type, <span class="keywordtype">void</span> *event_buf, uint16_t buf_len)</div><div class="line">{</div><div class="line">    <a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html">T_BT_EVENT_PARAM</a> *param = event_buf;</div><div class="line">    <span class="keywordtype">bool</span> handle = <span class="keyword">true</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (event_type)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83ad025207cfa152aa6734c0ffde9825f7d">BT_EVENT_OPP_CONN_IND</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="group___b_t___o_p_p.html#gaebfc8d6d6f3aeed821fc4e3b1aa26c53">bt_opp_connect_cfm</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a402106ff4f52c57ab64cf1fb4f1898f0">opp_conn_ind</a>.<a class="code" href="structt__bt__event__param__opp__conn__ind.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, <span class="keyword">true</span>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a83ac117295b87ae5981ed6a1e9eebd0e">BT_EVENT_OPP_CONN_CMPL</a>:</div><div class="line">        {</div><div class="line">            <span class="comment">// bt_opp_push_data_header_req(param-&gt;opp_conn_cmpl.bd_addr, total_len, name, sizeof(name), type, sizeof(type), false);</span></div><div class="line">            <span class="comment">// data_idx += data_len;</span></div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a976fabfe90ac4edf03f8bd4083f37550">BT_EVENT_OPP_DATA_HEADER_IND</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="group__x3d___t_r_a_c_e.html#ga63d3804cafe8ed6f9165f9692b30fd96">APP_PRINT_INFO5</a>(<span class="stringliteral">&quot;app_opp_bt_cback: DATA_HEADER_IND %x, %s, %s, %x, %x&quot;</span>,</div><div class="line">                            param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ab49a797a377f465cc968a4ce7eb19471">opp_data_header_ind</a>.total_len,</div><div class="line">                            <a class="code" href="group__x3d___t_r_a_c_e.html#ga78c7b103f1c05e69c26a3b5d615de7e8">TRACE_STRING</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ab49a797a377f465cc968a4ce7eb19471">opp_data_header_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__header__ind.html#ad18ffb857d1568f56c3b0e49a1569d8b">name</a>), <a class="code" href="group__x3d___t_r_a_c_e.html#ga78c7b103f1c05e69c26a3b5d615de7e8">TRACE_STRING</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ab49a797a377f465cc968a4ce7eb19471">opp_data_header_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__header__ind.html#a60e5615e47d1d875959a9311356ad440">type</a>),</div><div class="line">                            param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ab49a797a377f465cc968a4ce7eb19471">opp_data_header_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__header__ind.html#a0604de392031676ba14d072c32e4c9af">name_len</a>, param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ab49a797a377f465cc968a4ce7eb19471">opp_data_header_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__header__ind.html#aa05b2cc2ba3fda8edb30c6238763ac1e">type_len</a>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aaf386600d8b507346421ac382454f97a">BT_EVENT_OPP_DATA_IND</a>:</div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (!param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a0538ae16259eafef9687c57e1a1a67d3">opp_data_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__ind.html#af22a8e3b49524861f704f410106d60a6">data_end</a>)</div><div class="line">            {</div><div class="line">                <span class="comment">//bt_opp_send_data_rsp(param-&gt;opp_data_ind.bd_addr, BT_OPP_RSP_CONTINUE);</span></div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span></div><div class="line">            {</div><div class="line">                <span class="comment">//bt_opp_send_data_rsp(param-&gt;opp_data_ind.bd_addr, BT_OPP_RSP_SUCCESS);</span></div><div class="line">            }</div><div class="line"></div><div class="line">            <a class="code" href="group__x3d___t_r_a_c_e.html#ga98e2dee240d2fde3119d3380b4d98762">APP_PRINT_INFO3</a>(<span class="stringliteral">&quot;app_opp_bt_cback: DATA_IND 0x%04x, end %x, first_data %x&quot;</span>,</div><div class="line">                            param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a0538ae16259eafef9687c57e1a1a67d3">opp_data_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__ind.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>,</div><div class="line">                            param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a0538ae16259eafef9687c57e1a1a67d3">opp_data_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__ind.html#af22a8e3b49524861f704f410106d60a6">data_end</a>, *(uint8_t *)param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a0538ae16259eafef9687c57e1a1a67d3">opp_data_ind</a>.<a class="code" href="structt__bt__event__param__opp__data__ind.html#a8304c4af5da6e830b86d7199dc9a22e6">p_data</a>);</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83aa7156a77d1eddae6fdd3292b8dc79fc6">BT_EVENT_OPP_DATA_RSP</a>:</div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a6c4d7be313b8fe4e54b5e868ebbe3fa6">opp_data_rsp</a>.<a class="code" href="structt__bt__event__param__opp__data__rsp.html#a12a08a930d4fbff613267ede6b1af68d">cause</a> == <a class="code" href="group___b_t___o_p_p.html#ggaf52f6e692f6019678e508179c6902557a5d4fdcf605e948a196d87f4071c5e1aa">BT_OPP_RSP_CONTINUE</a>)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (data_idx != 0)</div><div class="line">                {</div><div class="line">                    <span class="keywordflow">if</span> (data_idx + data_len &lt; total_len)</div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___b_t___o_p_p.html#ga07d764602ad814b54ceb7d287999df2f">bt_opp_push_data_req</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a6c4d7be313b8fe4e54b5e868ebbe3fa6">opp_data_rsp</a>.<a class="code" href="structt__bt__event__param__opp__data__rsp.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, &amp;data[data_idx], data_len, <span class="keyword">true</span>);</div><div class="line">                        data_idx += data_len;</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">else</span></div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___b_t___o_p_p.html#ga07d764602ad814b54ceb7d287999df2f">bt_opp_push_data_req</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a6c4d7be313b8fe4e54b5e868ebbe3fa6">opp_data_rsp</a>.<a class="code" href="structt__bt__event__param__opp__data__rsp.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, &amp;data[data_idx], total_len - data_idx, <span class="keyword">false</span>);</div><div class="line">                        data_idx = 0;</div><div class="line">                    }</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a4d6b781d7df2a68759c22de424935578">BT_EVENT_SDP_ATTR_INFO</a>:</div><div class="line">        {</div><div class="line">            <a class="code" href="structt__bt__sdp__attr__info.html">T_BT_SDP_ATTR_INFO</a> *sdp_info = &amp;param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a2a26fa4bdf160fc664a921ca0fe0cfd6">sdp_attr_info</a>.<a class="code" href="structt__bt__event__param__sdp__attr__info.html#aede2e502d17f13440b299bd8b5e92f62">info</a>;</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (sdp_info-&gt;<a class="code" href="structt__bt__sdp__attr__info.html#a9fe9edcdd42620e0f0d86d9d6a74367d">srv_class_uuid_data</a>.<a class="code" href="uniont__bt__sdp__uuid__data.html#af4fea99995e2110b688ca292edb5f462">uuid_16</a> == <a class="code" href="group___b_t___u_u_i_d.html#ga7a0ee5d3fb1ac8cdb2f22bdcede0164c">UUID_OBEX_OBJECT_PUSH</a>)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (sdp_info-&gt;<a class="code" href="structt__bt__sdp__attr__info.html#a16fd149b26409662fed5700c916aa813">profile_version</a> &gt;= 0x0102)</div><div class="line">                {</div><div class="line">                    <a class="code" href="group___b_t___o_p_p.html#ga9f2512d754bc7c15cdcec4634c33a4b8">bt_opp_connect_over_l2c_req</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a2a26fa4bdf160fc664a921ca0fe0cfd6">sdp_attr_info</a>.<a class="code" href="structt__bt__event__param__sdp__attr__info.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, sdp_info-&gt;<a class="code" href="structt__bt__sdp__attr__info.html#a592a804a18acf35ae1a0441df2264d54">l2c_psm</a>);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    <a class="code" href="group___b_t___o_p_p.html#ga34fcc1612840970ec26ccaa8da174b49">bt_opp_connect_over_rfc_req</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#a2a26fa4bdf160fc664a921ca0fe0cfd6">sdp_attr_info</a>.<a class="code" href="structt__bt__event__param__sdp__attr__info.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>, sdp_info-&gt;<a class="code" href="structt__bt__sdp__attr__info.html#ace5623b10edbf3417840ed509e9614bb">server_channel</a>);</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    <span class="keywordflow">default</span>:</div><div class="line">        handle = <span class="keyword">false</span>;</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (handle == <span class="keyword">true</span>)</div><div class="line">    {</div><div class="line">        <a class="code" href="group__x3d___t_r_a_c_e.html#ga81687b044a4d8600c4be891734f4839a">APP_PRINT_INFO1</a>(<span class="stringliteral">&quot;app_opp_bt_cback: event_type 0x%04x&quot;</span>, event_type);</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">bool</span> app_opp_connect_req(uint8_t *bd_addr)</div><div class="line">{</div><div class="line">    <a class="code" href="uniont__bt__sdp__uuid__data.html">T_BT_SDP_UUID_DATA</a> uuid;</div><div class="line"></div><div class="line">    uuid.<a class="code" href="uniont__bt__sdp__uuid__data.html#af4fea99995e2110b688ca292edb5f462">uuid_16</a> = <a class="code" href="group___b_t___u_u_i_d.html#ga7a0ee5d3fb1ac8cdb2f22bdcede0164c">UUID_OBEX_OBJECT_PUSH</a>;</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="group___b_t___s_d_p.html#ga395b3d4c700e3aa4bb4635c3f64eabc8">bt_sdp_discov_start</a>(bd_addr, <a class="code" href="group___b_t___b_t_m.html#ggaed1d70fcf775d8765923af0da9b8f278a9b673f3ef8bd5e999c0ec59aada87b20">BT_SDP_UUID16</a>, uuid);</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
