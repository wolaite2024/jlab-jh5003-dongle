<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="Legacy_BT_Gaming_Volume_Page"></a>
Legacy BT Gaming Volume Application Note </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.0</b></center><p><br />
 </p><center><b>2023/5/25</b></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="Legacy_BT_Gaming_Volume_rev"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.0  </td><td class="markdownTableBodyCenter">2023/5/25  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Legacy_BT_Gaming_Volume_Content"></a>
Contents</h2>
<ul>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Legacy_BT_Gaming_Volume_rev">Revision History</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Legacy_BT_Gaming_Volume_Table_List">Table List</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Legacy_BT_Gaming_Volume_Figure_List">Figure List</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Legacy_BT_Gaming_Volume_Glossary">Glossary</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Legacy_BT_Gaming_Volume_Intro">1 Introduction</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Gaming_Volume_Desc">2 Volume In Sync and Out of Sync</a><ul>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Voluem_In_Sync">2.1 Volume In Sync</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Volume_Out_of_Sync">2.2 Volume Out of Sync</a></li>
</ul>
</li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Game_Chat_Volume_Control">3 Game-Chat Volume Control</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Srouce_Code_Overview">4 Source Code Overview</a><ul>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Host_Voluem_Change_Event">4.1 Host Volume Change Event</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Earphone_Voluem_Change_Event">4.2 Earphone Volume Change Event</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Dongle_Set_Absolute_Volume">4.3 Dongle Set Absoult Volume</a></li>
<li><a class="el" href="_a_n099__l_e_g_a_c_y__b_t__g_a_m_i_n_g__v_o_l_u_m_e.html#Dongle_Set_Local_Gain">4.4 Dongle Set Local Gain</a></li>
</ul>
</li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Legacy_BT_Gaming_Volume_Table_List"></a>
Table List</h2>
<ul>
<li><a href="#table_3_1">Table 3-1 SPP Interactive Game/Chat Volume Formate Table</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Legacy_BT_Gaming_Volume_Figure_List"></a>
Figure List</h2>
<ul>
<li><a href="#figure_2_1">Figure 2-1 Voluem in sync diagram</a></li>
<li><a href="#figure_2_2">Figure 2-2 Volume out of sync diagram</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="Legacy_BT_Gaming_Volume_Glossary"></a>
Glossary</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Terms  </th><th class="markdownTableHeadCenter">Definitions   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">API  </td><td class="markdownTableBodyCenter">Application Programming Interface   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">BT  </td><td class="markdownTableBodyCenter">Bluetooth   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">HID  </td><td class="markdownTableBodyCenter">Human Interface Devices   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">SPP  </td><td class="markdownTableBodyCenter">Serial Port Profile   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Sync  </td><td class="markdownTableBodyCenter">Synchronization   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">USB  </td><td class="markdownTableBodyCenter">Universal Serial Bus   </td></tr>
</table>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Legacy_BT_Gaming_Volume_Intro"></a>
1 Introduction</h2>
<p>The purpose of this document is to give an overview of the Legacy BT Gaming Dongle Volume Function. The following topics are included to help users to easily and completely understand this function.<br />
1) Volume In Sync and Out of Sync<br />
2) Game-Chat Volume Control<br />
3) Source Code Overview</p>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Gaming_Volume_Desc"></a>
2 Volume In Sync and Out of Sync</h2>
<p>Legacy BT Gaming Dongle supports volume synchronization and volume asynchrony, and customers can choose a volume strategy based on their actual needs. The current release version supports synchronous volume by default.</p>
<h3><a class="anchor" id="Voluem_In_Sync"></a>
2.1 Volume In Sync</h3>
<p>Adjust the volume from the host end, and dongle sets the volume to the headphones through AVRCP to achieve volume synchronization. Adjust the volume from the earphone end, after Dongle receives the event of earphone volume change, it sends HID command to the host to realize synchronous volume.<br />
Volume In Sync flow diagram is shown in Figure 2-1 </p><div class="image">
<img src="legacy_gaming_volume_sync.png" alt="legacy_gaming_volume_sync.png"/>
</div>
 <center><div id="figure_2_1"><b>Figure 2-1 Legacy BT Gaming Volme Sync </b></div></center><h3><a class="anchor" id="Volume_Out_of_Sync"></a>
2.2 Volume Out of Sync</h3>
<p>Adjust the volume from the host, that is, dongle adjusts the local gain. Adjust the volume from the headphone end, that is, the headphone adjusts the local gain.<br />
Volume Out of Sync flow diagram is shown in Figure 2-2 </p><div class="image">
<img src="legacy_gaming_volume_async.png" alt="legacy_gaming_volume_async.png"/>
</div>
 <center><div id="figure_2_1"><b>Figure 2-2 Legacy BT Gaming Volme Async </b></div></center><div style="page-break-after: always;"></div> <h2><a class="anchor" id="Game_Chat_Volume_Control"></a>
3 Game-Chat Volume Control</h2>
<p>Legacy BT Gaming Dongle Dual UAC version supports game/chat balance control. When using this function, the headphone also needs to support it. Explanation of this feature of headphones can be found in Game-Chat Volume Control. <a class="el" href="_a_n046__gaming__dongle__feature.html#Gaming_Dongle_Feature_Page">Gaming Dongle Feature Application Note </a></p>
<p>This feature is based on volume asynchrony, and the volume of two UAC channels can be adjusted separately from the PC end. The game/chat volume can also be adjusted from the earphone end, the earphone and dongle transmit the gaming/chat volume level through SPP. After Dongle receives the corresponding event, it adjusts the gain of the two channels respectively.</p>
<p>Dongle interacts with headphones through SPP for game/chat volume information, and the specific format of SPP is shown in the table below.</p>
<center><div id="table_3_1"><b>Table 3-1 SPP Interactive Game/Chat Volume Formate Table </b></div></center><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Byte  </th><th class="markdownTableHeadLeft">value  </th><th class="markdownTableHeadLeft">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Byte 0  </td><td class="markdownTableBodyLeft">0x52  </td><td class="markdownTableBodyLeft">Date start byte.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Byte 1  </td><td class="markdownTableBodyLeft">0x01  </td><td class="markdownTableBodyLeft">Playload type.(0: represents voice data; 1: represents command)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Byte 2  </td><td class="markdownTableBodyLeft">0x04  </td><td class="markdownTableBodyLeft">Playlode length.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Byte 3  </td><td class="markdownTableBodyLeft">0x06  </td><td class="markdownTableBodyLeft">Command opcode.(0x06: defined as game/chat volume balance)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Byte 4  </td><td class="markdownTableBodyLeft">0xXX  </td><td class="markdownTableBodyLeft">Command parameter: message type.(0x00: ack; 0x01: dongle inform earphone; <br />
 0x02: earphone update to dongle)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Byte 5  </td><td class="markdownTableBodyLeft">0xXX  </td><td class="markdownTableBodyLeft">Command parameter: game volume level.(range: 0x00 ~ 0x64)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Byte 6  </td><td class="markdownTableBodyLeft">0xXX  </td><td class="markdownTableBodyLeft">Command parameter: chat volume level.(range: 0x00 ~ 0x64)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Byte 7  </td><td class="markdownTableBodyLeft">0x54  </td><td class="markdownTableBodyLeft">Date stop byte.   </td></tr>
</table>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Srouce_Code_Overview"></a>
4 Source Code Overview</h2>
<p>This chapter mainly introduces APIs related to volume functions.</p>
<h3><a class="anchor" id="Host_Voluem_Change_Event"></a>
4.1 Host Volume Change Event</h3>
<p>When the volume of the host changes, the app layer is informed by the following event. </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> trigger_evt_ctrl(<a class="code" href="struct__usb__audio__pipes.html">T_USB_AUDIO_PIPES</a> *pipe, <a class="code" href="group___u_s_b___a_u_d_i_o___i_f.html#gac276ff40c4311436f76a99c35c049483">T_USB_AUDIO_CTRL_EVT</a> evt, uint8_t dir,</div><div class="line">                            uint32_t param)</div><div class="line">{</div><div class="line">    uint32_t pipe_label = pipe-&gt;<a class="code" href="struct__usb__audio__pipes.html#a62ad4e7f13bf311b86bab68b8795ed1a">label</a>;;</div><div class="line">    uint8_t stream_type = DRVTYPE2STREAMTYPE(dir);</div><div class="line">    T_USB_AUDIO_STREAM *stream = usb_audio_stream_search((<a class="code" href="group___u_a_s.html#ga4302f3b651f577d7c95de7b31442d403">T_USB_AUDIO_STREAM_TYPE</a>)stream_type,</div><div class="line">                                                         pipe_label);</div><div class="line">    T_USB_AUDIO_CTRL_ATTR attr = {.content.d32 = param};</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (evt)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___u_s_b___a_u_d_i_o___i_f.html#ggac276ff40c4311436f76a99c35c049483a569f8afe5c16afcd1c772179b285d85f">USB_AUDIO_CTRL_EVT_VOL_SET</a>:</div><div class="line">        {</div><div class="line">            uint16_t vol;</div><div class="line">            vol = attr.content.vol.value;</div><div class="line">            <span class="keywordflow">if</span> (stream_type == <a class="code" href="group___u_a_s.html#gga4302f3b651f577d7c95de7b31442d403a11b592110fd312c52606cd621d1b5a75">USB_AUDIO_STREAM_TYPE_OUT</a>)</div><div class="line">            {</div><div class="line">                <a class="code" href="group___u_a_w.html#ga0c77afb3e90a03ed08e48ff1ab471cd7">app_usb_audio_set_spk_vol</a>(0, vol);</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stream_type == <a class="code" href="group___u_a_s.html#gga4302f3b651f577d7c95de7b31442d403aa40289d13b78a00e9ca8e0c8177094e7">USB_AUDIO_STREAM_TYPE_IN</a>)</div><div class="line">            {</div><div class="line">                <a class="code" href="group___u_a_w.html#ga28604624f54ea8b630730d6aa9163eb7">app_usb_audio_set_mic_vol</a>(vol);</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    ......</div><div class="line"></div><div class="line">    <span class="keywordflow">default</span>:</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Earphone_Voluem_Change_Event"></a>
4.2 Earphone Volume Change Event</h3>
<p>When the volume of the earphone changes, the app layer is informed by the following event. </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> app_avrcp_bt_cback(<a class="code" href="group___b_t___b_t_m.html#ga60f938d2fe9ea1ac81e1bf400fbb5b03">T_BT_EVENT</a> event_type, <span class="keywordtype">void</span> *event_buf, uint16_t buf_len)</div><div class="line">{</div><div class="line">    <a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html">T_BT_EVENT_PARAM</a> *param = event_buf;</div><div class="line">    <a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html">T_APP_BR_LINK</a> *p_link;</div><div class="line"></div><div class="line">    <span class="keywordflow">switch</span> (event_type)</div><div class="line">    {</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___b_t___b_t_m.html#ggad24078c623525f9ed318443fdc4e4c83a579b5c21462876608094e6d229aff5c4">BT_EVENT_AVRCP_VOLUME_CHANGED</a>:</div><div class="line">        {</div><div class="line">            p_link = <a class="code" href="group___a_p_p___l_i_n_k.html#ga02c6038934a5cd3f4a0cf6ddabc090a0">app_find_br_link</a>(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ad73fd0d1055392895b64df68c18e46a2">avrcp_volume_changed</a>.<a class="code" href="structt__bt__event__param__avrcp__volume__changed.html#a624fd24b46be2b40c8731334c9de5d06">bd_addr</a>);</div><div class="line">            <span class="keywordflow">if</span> (p_link != <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line">            {</div><div class="line">                uint16_t vol = param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ad73fd0d1055392895b64df68c18e46a2">avrcp_volume_changed</a>.<a class="code" href="structt__bt__event__param__avrcp__volume__changed.html#a14cc77262954756b30c251feabce7ea6">volume</a>;</div><div class="line">                vol *= 100;</div><div class="line">                vol /= 0x7f;</div><div class="line">                <span class="keywordflow">if</span> (p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#abd163d3d9bb20ba2ca41cc16fe15a0f5">vol_set_needed</a>)</div><div class="line">                {</div><div class="line">                    p_link-&gt;<a class="code" href="struct_t___a_p_p___b_r___l_i_n_k.html#abd163d3d9bb20ba2ca41cc16fe15a0f5">vol_set_needed</a> = 0;</div><div class="line">                    app_dongle_set_avrcp_vol();</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    app_dongle_handle_a2u_set_vol(param-&gt;<a class="code" href="union_t___b_t___e_v_e_n_t___p_a_r_a_m.html#ad73fd0d1055392895b64df68c18e46a2">avrcp_volume_changed</a>.<a class="code" href="structt__bt__event__param__avrcp__volume__changed.html#a14cc77262954756b30c251feabce7ea6">volume</a>, <span class="keyword">false</span>);</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line"></div><div class="line">    ......</div><div class="line"></div><div class="line">    <span class="keywordflow">default</span>:</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Dongle_Set_Absolute_Volume"></a>
4.3 Dongle Set Absoult Volume</h3>
<p>When synchronizing volume, dongle sets absolute volume for earaphone through the following API. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___gaming___b_t___exported___functions.html#ga99ddc928836c027a51e40dd128acbac6">gaming_bt_set_volume</a>(uint32_t vol, uint8_t mute)</div><div class="line">{</div><div class="line">    uint8_t i;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (mute)</div><div class="line">    {</div><div class="line">        vol = 0;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="group___a_p_p___s_r_c___p_o_l_i_c_y.html#ga41ca0142e0dd62f33435f75b317596bb">SINK_DEV_NUM_MAX</a>; i++)</div><div class="line">    {</div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="group___a_p_p___src___policy___exported___functions.html#ga24ec4fdc38da515d0489e54f223cc8e2">profile_is_connected</a>(<a class="code" href="group___a_p_p___src___policy___exported___functions.html#ga8903b8462bd3f9156b6f22e315bece73">sink_dev_list</a>[i].remote_info.bd_addr,</div><div class="line">                                 <a class="code" href="group___a_p_p___l_i_n_k.html#ga1216017b50a3d0ab20cfe5b97a808c13">AVRCP_PROFILE_MASK</a>))</div><div class="line">        {</div><div class="line">            <span class="keywordflow">if</span> (<a class="code" href="group___b_t___a_v_r_c_p.html#ga38744545c440dc811e25ddc06392e0eb">bt_avrcp_absolute_volume_set</a>(<a class="code" href="group___a_p_p___src___policy___exported___functions.html#ga8903b8462bd3f9156b6f22e315bece73">sink_dev_list</a>[i].remote_info.bd_addr, vol))</div><div class="line">            {</div><div class="line">                <a class="code" href="group___t_r_a_c_e.html#gacede19f539147e375272a511869b7a77">APP_PRINT_INFO2</a>(<span class="stringliteral">&quot;gaming_bt_set_volume: %b set vol 0x%02x succeeded&quot;</span>,</div><div class="line">                                <a class="code" href="group___t_r_a_c_e.html#ga21deae8960b0d6088c2d18b04a151e66">TRACE_BDADDR</a>(<a class="code" href="group___a_p_p___src___policy___exported___functions.html#ga8903b8462bd3f9156b6f22e315bece73">sink_dev_list</a>[i].remote_info.bd_addr),</div><div class="line">                                vol);</div><div class="line">            }</div><div class="line">            <span class="keywordflow">else</span></div><div class="line">            {</div><div class="line">                <a class="code" href="group___t_r_a_c_e.html#gacede19f539147e375272a511869b7a77">APP_PRINT_INFO2</a>(<span class="stringliteral">&quot;gaming_bt_set_volume: %b set vol 0x%02x failed&quot;</span>,</div><div class="line">                                <a class="code" href="group___t_r_a_c_e.html#ga21deae8960b0d6088c2d18b04a151e66">TRACE_BDADDR</a>(<a class="code" href="group___a_p_p___src___policy___exported___functions.html#ga8903b8462bd3f9156b6f22e315bece73">sink_dev_list</a>[i].remote_info.bd_addr),</div><div class="line">                                vol);</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Dongle_Set_Local_Gain"></a>
4.4 Dongle Set Local Gain</h3>
<p>Local gain can be set through the following API. </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> app_audio_path_set_gain(uint8_t it, uint8_t ot, uint16_t gain)</div><div class="line">{</div><div class="line">    <a class="code" href="structt__audio__path.html">T_AUDIO_PATH</a> *path;</div><div class="line">    T_UALIST_HEAD *pos = <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line">    T_UALIST_HEAD *n = <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line">    uint8_t i;</div><div class="line">    uint8_t ctype;</div><div class="line"></div><div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; AUDIO_PATH_TYPE_MAX; i++)</div><div class="line">    {</div><div class="line">        ualist_for_each_safe(pos, n, &amp;audio_path_types[i].path_list)</div><div class="line">        {</div><div class="line">            path = ualist_entry(pos, <a class="code" href="structt__audio__path.html">T_AUDIO_PATH</a>, list);</div><div class="line"></div><div class="line">            <span class="keywordflow">if</span> (path-&gt;<a class="code" href="structt__audio__path.html#a9295640264f17eb9997e34e27ca183a1">it</a> == it &amp;&amp; path-&gt;<a class="code" href="structt__audio__path.html#ada592c67d5472310212ec2b127421f9b">ot</a> == ot)</div><div class="line">            {</div><div class="line">                <span class="keywordflow">if</span> (path-&gt;<a class="code" href="structt__audio__path.html#a1d127017fb298b889f4ba24752d08b8e">type</a> == AUDIO_PATH_TYPE_PIPE)</div><div class="line">                {</div><div class="line">                    ctype = app_audio_path_pipe_codec(path);</div><div class="line">                    <span class="keywordflow">if</span> (ctype == 0xff)</div><div class="line">                    {</div><div class="line">                        <a class="code" href="group___t_r_a_c_e.html#gaf20aac2fd019420214bcab2eadd15156">APP_PRINT_ERROR0</a>(<span class="stringliteral">&quot;app_audio_path_set_gain: No pipe&quot;</span>);</div><div class="line">                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">                    }</div><div class="line">                    <span class="keywordflow">return</span> app_audio_pipe_set_gain(ctype, gain);</div><div class="line">                }</div><div class="line">                <span class="keywordflow">else</span></div><div class="line">                {</div><div class="line">                    <a class="code" href="group___t_r_a_c_e.html#ga57c6954e0ebb68c0ca06a0052659be48">APP_PRINT_ERROR1</a>(<span class="stringliteral">&quot;app_audio_path_set_gain: type (%u) is not supported&quot;</span>,</div><div class="line">                                     path-&gt;<a class="code" href="structt__audio__path.html#a1d127017fb298b889f4ba24752d08b8e">type</a>);</div><div class="line">                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">                }</div><div class="line">            }</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
