<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="CLI_CFG_Page"></a>
Command Line Interface User Manual    </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.3</b></center><p><br />
 </p><center><b>2023/06/13</b></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_DOC_rev"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.0.0.0  </td><td class="markdownTableBodyCenter">2021/10/21  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.0.0.1  </td><td class="markdownTableBodyCenter">2022/08/15  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.2  </td><td class="markdownTableBodyCenter">2023/06/12  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.3  </td><td class="markdownTableBodyCenter">2023/06/13  </td><td class="markdownTableBodyCenter">Stable Release   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2>Contents</h2>
<ul>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_DOC_rev">Revision History</a></li>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_Table_List">Table List</a></li>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_Figure_List">Figure List</a></li>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_Glossary">Glossary</a></li>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_Introduction">1 Introduction</a></li>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_Configuration_of_MCU_Config_Tool">2 Configuration</a></li>
<li><a class="el" href="_a_n026__c_l_i__c_f_g.html#CLI_CFG_Add_commands">3 How to add commands</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_Table_List"></a>
Table List</h2>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_Figure_List"></a>
Figure List</h2>
<ul>
<li><a href="#figure_2_1">Figure 2-1 Enable UART on MCU Config Tool</a></li>
<li><a href="#figure_2_2">Figure 2-2 Configure pinmux on MCU Config Tool</a></li>
<li><a href="#figure_2_3">Figure 2-3 Baud rate and Console Mode on MCU Config Tool</a></li>
<li><a href="#figure_2_4">Figure 2-4 Baud rate on serial communication software</a></li>
<li><a href="#figure_2_4">Figure 2-5 'help' command</a></li>
</ul>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_Glossary"></a>
Glossary</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Terms  </th><th class="markdownTableHeadCenter">Definitions   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">CLI  </td><td class="markdownTableBodyCenter">Command Line Interface   </td></tr>
</table>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_Introduction"></a>
1 Introduction</h2>
<p>CLI, which stands for Command Line Interface, is a user interface that allows interaction with a computer system through text-based input. It enables users to communicate with and control the computer system by entering commands. Within the CLI, users can input specific commands, and the system will execute corresponding operations based on those commands. CLI_CFG module provides an example for adding CLI commands on RWS app to test or debug during the development.</p>
<div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_Configuration_of_MCU_Config_Tool"></a>
2 Configuration</h2>
<p>Before using the CLI, it is necessary to enable the UART functionality through the MCU Config Tool. On the HW Feature page, select the "enable data UART" option and configure the desired pins as DATA_UART_TX and DATA_UART_RX. If you intend to use the USB cable as the serial cable, it is recommended to configure P3_0 as UART RX and P3_1 as UART TX (Figure 2-1 and Figure 2-2).</p>
<div class="image">
<img src="CLI_MP_MCU_CONFIG_1.png" alt="CLI_MP_MCU_CONFIG_1.png"/>
</div>
 <center><div id="figure_2_1"><b>Figure 2-1 Enable UART on MCU Config Tool</b></div></center><div class="image">
<img src="CLI_MP_MCU_CONFIG_2.png" alt="CLI_MP_MCU_CONFIG_2.png"/>
</div>
 <center><div id="figure_2_2"><b>Figure 2-2 Configure pinmux on MCU Config Tool</b></div></center><p>Additionally, on the peripheral page, you need to configure the console mode as "String Mode" and select the desired baud rate (Figure 2-3). After completing these steps, connect the device to the computer using a USB to TTL serial cable or a USB cable, and open the corresponding serial port using serial communication software to establish communication. Make sure the baud rate is consistant with that configured for device (Figure 2-4).</p>
<div class="image">
<img src="baudrate_and_console_mode.png" alt="baudrate_and_console_mode.png"/>
</div>
 <center><div id="figure_2_3"><b>Figure 2-3 Baud rate and Console Mode on MCU Config Tool</b></div></center><div class="image">
<img src="TeraBaudRate.png" alt="TeraBaudRate.png"/>
</div>
 <center><div id="figure_2_4"><b>Figure 2-4 Baud rate on serial communication software</b></div></center><div style="page-break-after: always;"></div><h2><a class="anchor" id="CLI_CFG_Add_commands"></a>
3 How to add commands</h2>
<p>Users can register a series of CLI commands as a complete module in the RWS app. The module should includes a main command to enter the module and some sub-commands supported by that module. The format of a command is as follows:</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structt__cli__cmd.html">t_cli_cmd</a></div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structt__cli__cmd.html">t_cli_cmd</a> *<a class="code" href="structt__cli__cmd.html#aba165023021d0d392488d507fe148fe6">p_next</a>;       </div><div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structt__cli__cmd.html">t_cli_cmd</a> *<a class="code" href="structt__cli__cmd.html#a0930e89477c7ff98c526543c6cbca24d">p_next_sub</a>;   </div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span>       <a class="code" href="structt__cli__cmd.html#a3a7bb52387fde2599a77496451845fbd">p_cmd</a>;        </div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span>       <a class="code" href="structt__cli__cmd.html#aff4157fc0eeebe4b0aaddafe9ea830e5">p_help</a>;       </div><div class="line">    <span class="keyword">const</span> <a class="code" href="group___c_l_i.html#ga5d434714833783498b5f3b41cd4223b8">P_CLI_CALLBACK</a>    <a class="code" href="structt__cli__cmd.html#a5dd909473e463e6203cf34d5f16df17d">p_callback</a>;   </div><div class="line">    int32_t                 <a class="code" href="structt__cli__cmd.html#afdede1374a9d3ffe2099c980b887d6b1">param_num</a>;    </div><div class="line">    <span class="keyword">const</span> <a class="code" href="group___c_l_i.html#gac718f1b7d770a3659256d740651a0ea5">P_CLI_MATCH</a>       <a class="code" href="structt__cli__cmd.html#af35c49c53aaae484dc8f7425ca4e3edb">p_match</a>;      </div><div class="line">} <a class="code" href="group___c_l_i.html#gaef140d3de94cdd9dc5c7d289f1e981d2">T_CLI_CMD</a>;</div></div><!-- fragment --><ul>
<li>The <b>p_next</b> field refers to the next command, which is set to Null for the main command and points to the next sub-command for the sub-command. The sub-commands are linked through the p_next field.</li>
<li>The <b>p_next_sub</b> field points to the first sub-command (usually the help command) for the main command. The main command and the first sub-command are linked through the p_next_sub field.</li>
<li>The <b>p_cmd</b> field contains the command text used in the serial communication software.</li>
<li>The <b>p_help</b> field provides a description of the command's functionality.</li>
<li>The <b>p_callback</b> field points to the callback function associated with the command, which would be executed when the command is invoked.</li>
<li>The <b>param_num</b> filed represents the number of parameters supported by the command.</li>
<li>The <b>p_match</b> field is a matching function used to match the input text with the command. In most cases, setting it to NULL will use the default matching method.</li>
</ul>
<p>Taking the CLI_CFG module as an example, the supported commands are as follows: </p><div class="fragment"><div class="line">cfg          <span class="comment">//Main command to enter cfg module</span></div><div class="line">help         <span class="comment">//The first sub-command to list all the registered commands</span></div><div class="line">exit         <span class="comment">//The second sub-command to exit from cfg module</span></div><div class="line">dump [app/appnv/sys/sysnv/mem]   <span class="comment">//The third sub-command</span></div></div><!-- fragment --><p>The cfg_mode command is the main command to enter the CLI_CFG module, and its p_next field points to the first sub-command, 'help'.</p>
<div style="page-break-after: always;"></div> <div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code" href="structt__cli__cmd.html">T_CLI_CMD</a> cfg_cmd_entry  =</div><div class="line">{</div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,           <span class="comment">/* Next command will be determined when registered into file system. */</span></div><div class="line">    &amp;cfg_cmd_help,  <span class="comment">/* Next subcommand pointer to &quot;help&quot; subcommand. */</span></div><div class="line">    <span class="stringliteral">&quot;cfg&quot;</span>,          <span class="comment">/* The command string to type. */</span></div><div class="line">    <span class="stringliteral">&quot;\r\ncfg:\r\n Enters cfg mode\r\n&quot;</span>,</div><div class="line">    cfg_mode,       <span class="comment">/* The function to run. */</span></div><div class="line">    0,              <span class="comment">/* Zero or One parameter is expected. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>            <span class="comment">/* Default command match pattern. */</span></div><div class="line">};</div></div><!-- fragment --><p>To enter the CLI_CFG module, you need to register the main command into the CLI module using the <a class="el" href="group___c_l_i.html#gabd42ee74941f70366427f085272be724" title="Register the command passed in using the cli_cmd parameter. ">cli_cmd_register()</a> function: </p><div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code" href="group___a_p_p___r_w_s___c_l_i___c_f_g.html#gaa0759d6225a793a3adb62cfc007e29dd">cfg_cmd_register</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="group___c_l_i.html#gabd42ee74941f70366427f085272be724">cli_cmd_register</a>(&amp;cfg_cmd_entry);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group___a_p_p___c_o_n_s_o_l_e___u_a_r_t___exported___variables.html#ga280711c17d4d5a8565a10a481f546e00">app_console_init</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">...</div><div class="line">#<span class="keywordflow">if</span> <a class="code" href="group___a_p_p___f_l_a_g_s.html#ga8e58dbf35907fd1482925b646f96daba">F_APP_CLI_CFG_SUPPORT</a></div><div class="line">    <a class="code" href="group___a_p_p___r_w_s___c_l_i___c_f_g.html#gaa0759d6225a793a3adb62cfc007e29dd">cfg_cmd_register</a>();</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">...</div><div class="line">}</div></div><!-- fragment --><p>The CLI_CFG module implements three sub-commands: 'help', 'exit', and 'dump'. The 'help' command is the default sub-command required by all modules: </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="structt__cli__cmd.html">T_CLI_CMD</a> cfg_cmd_help  =</div><div class="line">{</div><div class="line">    &amp;cfg_cmd_exit,  <span class="comment">/* Next command pointed to &quot;exit&quot; command. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,           <span class="comment">/* Next subcommand. */</span></div><div class="line">    <span class="stringliteral">&quot;help&quot;</span>,         <span class="comment">/* The command string to type. */</span></div><div class="line">    <span class="stringliteral">&quot;\r\nhelp:\r\n Lists all the registered commands\r\n&quot;</span>,</div><div class="line">    cfg_help,       <span class="comment">/* The function to run. */</span></div><div class="line">    -1,             <span class="comment">/* Zero or One parameter is expected. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>            <span class="comment">/* Default command match pattern. */</span></div><div class="line">};</div></div><!-- fragment --><p>Its p_callback is cfg_help, in witch the <a class="el" href="group___c_l_i.html#gab9b636bcb141a9d261e5f5bff5df2729" title="Traverse and echo the help prompts of the specified command list. ">cli_help_set()</a> would be executed to print all the sub-commands supported by current module:</p>
<div style="page-break-after: always;"></div> <div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * The callback function that is executed when &quot;help&quot; is entered.</span></div><div class="line"><span class="comment"> * This is the default subcommand that is always present.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> cfg_help(<span class="keyword">const</span> <span class="keywordtype">char</span> *cmd_str, <span class="keywordtype">char</span> *p_buf, <span class="keywordtype">size_t</span> buf_len)</div><div class="line">{</div><div class="line">    <span class="keywordflow">return</span> <a class="code" href="group___c_l_i.html#gab9b636bcb141a9d261e5f5bff5df2729">cli_help_set</a>(&amp;cfg_cmd_help, cmd_str, p_buf, buf_len);</div><div class="line">}</div></div><!-- fragment --><div class="image">
<img src="cli_cfg_help_result.png" alt="cli_cfg_help_result.png"/>
</div>
 <center><div id="figure_2_5"><b>Figure 2-5 'help' command</b></div></center><p>The 'exit' command is usually the default second sub-command used to exit the current module. </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="structt__cli__cmd.html">T_CLI_CMD</a> cfg_cmd_exit  =</div><div class="line">{</div><div class="line">    &amp;cfg_cmd_dump, <span class="comment">/* Next command pointed to &quot;reset&quot;. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,           <span class="comment">/* Next subcommand. */</span></div><div class="line">    <span class="stringliteral">&quot;exit&quot;</span>,         <span class="comment">/* The command string to type. */</span></div><div class="line">    <span class="stringliteral">&quot;\r\nexit:\r\n Exits from cfg mode\r\n&quot;</span>,</div><div class="line">    cfg_exit,       <span class="comment">/* The function to run. */</span></div><div class="line">    0,              <span class="comment">/* Zero parameter is expected. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>            <span class="comment">/* Default command match pattern. */</span></div><div class="line">};</div></div><!-- fragment --><p>The 'dump' command is a sample command that you can use as a reference to implement other commands as needed. </p><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="structt__cli__cmd.html">T_CLI_CMD</a> cfg_cmd_dump  =</div><div class="line">{</div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,   <span class="comment">/* Next command pointed to NULL. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,           <span class="comment">/* Next subcommand. */</span></div><div class="line">    <span class="stringliteral">&quot;dump&quot;</span>,         <span class="comment">/* The command string to type. */</span></div><div class="line">    <span class="stringliteral">&quot;\r\ndump:\r\n example:dump app/appnv/sys/sysnv\r\n&quot;</span>,</div><div class="line">    <a class="code" href="group___a_p_p___r_w_s___c_l_i___c_f_g.html#ga041a776343fd7061a05738980bc022de">cfg_dump</a>,       <span class="comment">/* The function to run. */</span></div><div class="line">    1,              <span class="comment">/* One parameter is expected. */</span></div><div class="line">    <a class="code" href="group___platform___types___exported___macros.html#ga070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>            <span class="comment">/* Default command match pattern. */</span></div><div class="line">};</div></div><!-- fragment --> </div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
