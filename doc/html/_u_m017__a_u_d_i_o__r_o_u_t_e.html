<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BT AUDIO SDK: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
<link href="my_customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="bbpro-h55px.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BT AUDIO SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,true,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p>
<h1><a class="anchor" id="AudioRoute_Page"></a>
Audio Route User Manual </h1>
<p><br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
 </p><center><b>V1.1</b></center><p><br />
 </p><center><b>2024/01/22</b></center><div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Rev"></a>
Revision History</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Version  </th><th class="markdownTableHeadCenter">Date  </th><th class="markdownTableHeadCenter">Description   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">V1.0  </td><td class="markdownTableBodyCenter">2023/05/30  </td><td class="markdownTableBodyCenter">Initial version   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">V1.1  </td><td class="markdownTableBodyCenter">2024/01/22  </td><td class="markdownTableBodyCenter">Fix some display errors   </td></tr>
</table>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Content"></a>
Contents</h2>
<ul>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Rev">Revision History</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Table_List">Table List</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Figure_List">Figure List</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Glossary">Glossary</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Intro">1 Introduction</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Definition">2 Audio Route Definition</a><ul>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Category">2.1 Audio Category Definition</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Endpoint_Definition">2.2 Endpoint Definition</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Logical_IO_Definition">2.3 Logical IO Definition</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Path">2.4 Audio Route Path Definition</a></li>
</ul>
</li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Audio_Route_Functions">3 Audio Route Functions</a><ul>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_ADC_Gain">3.1 Configure ADC Gain</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Gateway">3.2 Configure Gateway</a><ul>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_External_Device">3.2.1 Configure external device</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_MCLK">3.2.2 Configure MCLK</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_BCLK">3.2.3 Configure BCLK</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_SPORT_MODE">3.2.4 Configure SPORT Mode</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_SPORT_Data_Length">3.2.5 Configure SPORT Data Length</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_SPORT_Channel_Length">3.2.6 Configure SPORT Channel Length</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_SPORT_Sample_Rate">3.2.7 Configure SPORT Sample Rate</a></li>
</ul>
</li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Codec_Mix">3.3 Configure Codec Mixing Function</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Codec_Interpolation_Filter">3.4 Configure Codec Interpolation Filter Type</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Logical_IO">3.5 Configure Audio Logical Device</a><ul>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Audio_Category">3.5.1 Configure Audio Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Voice_Category">3.5.2 Configure Voice Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Record_Category">3.5.3 Configure Record Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Line_Category">3.5.4 Configure Line Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Ringtone_Category">3.5.5 Configure Ringtone Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_Voice_Prompt_Category">3.5.6 Configure Voice Prompt Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_APT_Category">3.5.7 Configure APT Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_LLAPT_Category">3.5.8 Configure LLAPT Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_ANC_Category">3.5.9 Configure ANC Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_VAD_Category">3.5.10 Configure VAD Category</a></li>
<li><a class="el" href="_u_m017__a_u_d_i_o__r_o_u_t_e.html#Configure_AEC_REF">3.5.11 Configure AEC_REF</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Table_List"></a>
Table List</h2>
<ul>
<li><a href="#table_2_1">Table 2-1 Audio Route Path List</a></li>
</ul>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Figure_List"></a>
Figure List</h2>
<ul>
<li><a href="#figure_2-1">Figure 2-1 Audio Route</a></li>
<li><a href="#figure_2-2">Figure 2-2 Audio Category</a></li>
<li><a href="#figure_2-3">Figure 2-3 Endpoint Type</a></li>
<li><a href="#figure_2-4">Figure 2-4 Logical_IO Type</a></li>
<li><a href="#figure_2-5">Figure 2-5 Audio Route Path</a></li>
<li><a href="#figure_3-1">Figure 3-1 Voice Primary In AMIC1</a></li>
<li><a href="#figure_3-2">Figure 3-2 ADC GAIN</a></li>
<li><a href="#figure_3-3">Figure 3-3 Gateway</a></li>
<li><a href="#figure_3-4">Figure 3-4 External Bridge</a></li>
<li><a href="#figure_3-5">Figure 3-5 MCLK</a></li>
<li><a href="#figure_3-6">Figure 3-6 BCLK</a></li>
<li><a href="#figure_3-7">Figure 3-7 Data Length and Channel Length</a></li>
<li><a href="#figure_3-8">Figure 3-8 Sample Rate</a></li>
<li><a href="#figure_3-9">Figure 3-9 Codec Mix instance</a></li>
<li><a href="#figure_3-10">Figure 3-10 Codec Mix UI</a></li>
<li><a href="#figure_3-11">Figure 3-11 Codec Interpolation Filter</a></li>
<li><a href="#figure_3-12">Figure 3-12 Physical Path Configuration</a></li>
<li><a href="#figure_3-13">Figure 3-13 Audio Physical Path</a></li>
<li><a href="#figure_3-14">Figure 3-14 Voice Physical Path</a></li>
<li><a href="#figure_3-15">Figure 3-15 Voice Dual Mic</a></li>
<li><a href="#figure_3-16">Figure 3-16 Record Physical Path</a></li>
<li><a href="#figure_3-17">Figure 3-17 Audio Line Physical Path</a></li>
<li><a href="#figure_3-18">Figure 3-18 Ringtone Physical Path</a></li>
<li><a href="#figure_3-19">Figure 3-19 Voice Prompt Physical Path</a></li>
<li><a href="#figure_3-20">Figure 3-20 APT Physical Path</a></li>
<li><a href="#figure_3-21">Figure 3-21 Enable APT UI</a></li>
<li><a href="#figure_3-22">Figure 3-22 LLAPT Physical Path</a></li>
<li><a href="#figure_3-23">Figure 3-23 ANC Physical Path</a></li>
<li><a href="#figure_3-24">Figure 3-24 VAD Physical Path</a></li>
<li><a href="#figure_3-25">Figure 3-25 AEC REF</a></li>
<li><a href="#figure_3-26">Figure 3-26 AEC REF Cases</a></li>
<li><a href="#figure_3-27">Figure 3-27 AEC REF between Audio and Record</a></li>
<li><a href="#figure_3-28">Figure 3-28 AEC REF of Voice</a></li>
<li><a href="#figure_3-29">Figure 3-29 AEC REF of APT</a></li>
<li><a href="#figure_3-30">Figure 3-30 AEC REF of the second case</a></li>
<li><a href="#figure_3-31">Figure 3-31 AEC REF of the third case</a></li>
</ul>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Glossary"></a>
Glossary</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Terms  </th><th class="markdownTableHeadCenter">Definitions   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">MCLK  </td><td class="markdownTableBodyCenter">Master Clock   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">BCLK  </td><td class="markdownTableBodyCenter">Bit clock   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">IO  </td><td class="markdownTableBodyCenter">Input Output   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">SPK  </td><td class="markdownTableBodyCenter">Speaker   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">AMP  </td><td class="markdownTableBodyCenter">Amplifier   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">ADC  </td><td class="markdownTableBodyCenter">Analog Digital Channel   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">DAC  </td><td class="markdownTableBodyCenter">Digital Analog Channel   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">AEC  </td><td class="markdownTableBodyCenter">Acoustic Echo Cancelation   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">APT  </td><td class="markdownTableBodyCenter">Ambient Pass-through   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">LLAPT  </td><td class="markdownTableBodyCenter">Low Lantency Ambient Pass-through   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">ANC  </td><td class="markdownTableBodyCenter">Active Noise Cancellation   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">VAD  </td><td class="markdownTableBodyCenter">Voice Activity Detection   </td></tr>
</table>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Intro"></a>
1 Introduction</h2>
<p>The purpose of this document is to describe how to use the audio route module in the MCUConfig TOOl. The audio route capability of each IC can be demonstrated using the MCUConfig Tool. The customers can configure the routing relationship of each audio stream by using MCUConfig Tool. This document contains the following information:</p><ol type="1">
<li>Definition of audio route.</li>
<li>Functions of audio route.</li>
</ol>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Definition"></a>
2 Audio Route Definition</h2>
<p>Audio Route indicates the static configuration of the physical data path. The audio route module consists of Gateway configuration, Endpoint configuration and Logical IO configuration. The audio route module is classified according to the Audio Category.</p>
<p>Figure 2-1 shows a simplified audio route path between Codec and DSP. </p><div class="image">
<img src="audio_route.png" alt="audio_route.png"/>
</div>
 <center><div id="figure_2-1"><b>Figure 2-1 Audio Route </b></div></center><p>As shown in Figure 2-1, the data collected by the primary mic passes through an adc channel of Codec and flows to a SPORT RX channel to reach DSP. After the data is processed by DSP, it passes through a SPORT TX channel and then passes through the DAC channel of Codec, and at last plays it out through the specific speaker.</p>
<p>The main function of the audio route module is to configure Gateway and Logical IO related parameters for an audio route path. Gateway controls the inflow and outflow of multiple stream routing paths. These stream routing paths shall have the same configurations which are sample rate, data length, channel length and channel mode. Logical IO defines the functional attributes of the stream routing path. The Controller is isolated from the Physical Peripheral, and needs Logical IO to obtain the stream routing context.</p>
<h3><a class="anchor" id="Audio_Category"></a>
2.1 Audio Category Definition</h3>
<p>Audio Category is used to classify all streams transferred between the Host and the Controller. The streams that have the same control flows, usage scenarios, and functionalities shall be classified as follows:</p>
<p>Figure 2-2 shows the types of Audio Category. </p><div class="image">
<img src="Audio_Category.png" alt="Audio_Category.png"/>
</div>
 <center><div id="figure_2-2"><b>Figure 2-2 Audio Category </b></div></center><h3><a class="anchor" id="Endpoint_Definition"></a>
2.2 Endpoint Definition</h3>
<p>Endpoint consists of SPK, MIC, AUX and SPDIF physical entity input and output.</p>
<p>Figure 2-3 shows types of Endpoint. </p><div class="image">
<img src="endpoint_Type.png" alt="endpoint_Type.png"/>
</div>
 <center><div id="figure_2-3"><b>Figure 2-3 Endpoint Type </b></div></center><h3><a class="anchor" id="Logical_IO_Definition"></a>
2.3 Logical IO Definition</h3>
<p>Logical IO refers to the logical input and output related to the functions provided by the DSP. Logical IO consists of Primary Out, Secondary Out, Primary In, Secondary In, Fusion In, Bone In, External In, Internal In, Primary Aux, Secondary Aux, Primary SPDIF, Primary Ref In, Secondary Ref In, Primary Ref Out, Secondary Ref Out.</p>
<p>Figure 2-4 shows types of Logical_IO. </p><div class="image">
<img src="Logical_IO_Type.png" alt="Logical_IO_Type.png"/>
</div>
 <center><div id="figure_2-4"><b>Figure 2-4 Logical_IO Type </b></div></center><div style="page-break-after: always;"></div> <h3><a class="anchor" id="Audio_Route_Path"></a>
2.4 Audio Route Path Definition</h3>
<p>An audio path is constructed from one or more audio route paths.</p>
<p>Figure 2-5 shows the components of an audio route path. </p><div class="image">
<img src="Audio_Route_Path.png" alt="Audio_Route_Path.png"/>
</div>
 <center><div id="figure_2-5"><b>Figure 2-5 Audio Route Path </b></div></center><p>As shown in Figure 2-5, an audio route path consists of Logical IO type, Endpoint type, SPK and MIC parameters, Gateway index and SPORT channel. The parameter of SPK contains SPK type, SPK gain and DAC channel. The parameter of MIC contains MIC index, MIC type, MIC gain and ADC channel. Endpoint type and Logical IO type are shown in Figure 2-3 and Figure 2-4 respectively.</p>
<p>Table 2-1 shows the parameter description of audio route path. </p><center><div id="table_2_1"><b>Table 2-1 Audio Route Path List </b></div></center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Parameter Name  </th><th class="markdownTableHeadLeft">Parameter List   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">SPK ID  </td><td class="markdownTableBodyLeft">Speaker1/2.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">SPK Type  </td><td class="markdownTableBodyLeft">Single-End/Differential.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">DAC Channel  </td><td class="markdownTableBodyLeft">DAC0/1/2/3.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">MIC ID  </td><td class="markdownTableBodyLeft">AMIC1/2/3, DMIC1/2.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">MIC Type  </td><td class="markdownTableBodyLeft">Single-End/Differential/Falling Edge/Rising Edge.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">ADC Channel  </td><td class="markdownTableBodyLeft">ADC0/1/2/3.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Gateway ID  </td><td class="markdownTableBodyLeft">SPORT0/1/2/3, SPDIF0.   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Gateway Channel  </td><td class="markdownTableBodyLeft">TX Channel0/1/2/3, RX Channel0/1/2/3.   </td></tr>
</table>
<div style="page-break-after: always;"></div> <h2><a class="anchor" id="Audio_Route_Functions"></a>
3 Audio Route Functions</h2>
<p>The audio route module is mainly used to configure related parameters of Gateway and Logical IO parameters of physical data stream. <br />
 The main configurable functions are as follows:</p><ol type="1">
<li>Configure ADC Gain for the device MIC.</li>
<li>Configure the Gateway hardware parameters.</li>
<li>Configure the Codec Mixing function.</li>
<li>Configure Logical IO parameters for the audio stream.</li>
</ol>
<h3><a class="anchor" id="Configure_ADC_Gain"></a>
3.1 Configure ADC Gain</h3>
<p>ADC Gain is mainly used to configure the analog boost gain of the selected physical MIC or AUX.</p>
<p>Figure 3-1 shows that Voice Primary In select AMIC1. </p><div class="image">
<img src="Voice_Amic1.png" alt="Voice_Amic1.png"/>
</div>
 <center><div id="figure_3-1"><b>Figure 3-1 Voice Primary In AMIC1</b></div></center><p>Figure 3-2 shows how to configure ADC Gain. </p><div class="image">
<img src="ADC_GAIN.png" alt="ADC_GAIN.png"/>
</div>
 <center><div id="figure_3-2"><b>Figure 3-2 ADC GAIN</b></div></center><p>For example, if the Voice Primary In is configured in the voice category and AMIC1 is selected as shown in the Figure 3-1, then the ADC Gain value of AMIC1 is required to be configured as shown in the Figure 3-2.</p>
<p>After clicking the Set ADC Gain button, the ADC Gain configuration box appears. Then you can select Analog Boost Gain through the drop-down box of AMIC1. The analog boost gain of the physical MIC or AUX can be set to 0, 3, 6, 9, 12, 18, 24, or 30dB.</p>
<p>Notes:</p><ol type="1">
<li>MIC ADC Gain can be adjusted using the Set ADC Gain button only if AMIC is selected.</li>
<li>You can adjust AUX ADC Gain by setting the Set ADC Gain button only when AUX is selected.</li>
<li>DMIC Gain cannot be adjusted by the Set ADC Gain button.</li>
<li>Configure ADC Gain for the AMIC index as required.</li>
</ol>
<h3><a class="anchor" id="Configure_Gateway"></a>
3.2 Configure Gateway</h3>
<p>In the current Gateway parameters, the SPORT and SPDIF hardware parameters are configured by default. If there is no special requirement, you do not need to set them. If customers need to configure SPORT and SPDIF parameters, ask related developer to configure the parameters and provide them to customers. The default configuration for SPORT and SPDIF varies with different IC.</p>
<p>Figure 3-3 shows how to configure Gateway parameters. </p><div class="image">
<img src="Gateway.png" alt="Gateway.png"/>
</div>
 <center><div id="figure_3-3"><b>Figure 3-3 Gateway</b></div></center><p>Configuration parameter description:</p><ol type="1">
<li>SPORT 0/1/2/3: Select this option to enable the SPORT of the corresponding index.</li>
<li>SPDIF0: Select this option to enable the SPDIF of the corresponding index.</li>
<li>Bridge: SPORT supports single-direction TX and RX configurations. The value can be internal or external. It is worth noting that when this option is configured as external, you need to go to the HW Feature tab to configure the corresponding pinmux.</li>
<li>Role: Configure the SPORT role. The value can be maste or slave.</li>
<li>BCLK SRC: Configure the SPORT bclk and jitter functions. The optional value is XTAL/PLL.</li>
<li>RX/TX FIFO Mode: Configure the manner in which the RX and TX directions of SPORT align FIFO data. The optional value is Non-interlaced/Interlaced.</li>
<li>RX/TX Channel Mode: Configure the transfer mode in the RX and TX directions. The value is TDM2/4/6/8.</li>
<li>RX/TX Format: Configure the format of SPORT data in the RX and TX directions. The value can be I2S/Left Justified/PCM_A/PCM_B.</li>
<li>RX/TX Data Length: Configure the data length in the RX and TX directions of SPORT. The value is 8/16/20/24/32 bit.</li>
<li>RX/TX Channel Length: Configure the length of the channel in the RX and TX directions. The optional value is 16/20/24/32 bit.</li>
<li>RX/TX Sample Rate: Configure the RX and TX direction of SPORT support sampling rate conversion, optional value of 8/16/32/44.1/48/88.2/96/192/12/24/11.025/22.05KHZ.</li>
</ol>
<div style="page-break-after: always;"></div> <h4><a class="anchor" id="Configure_External_Device"></a>
3.2.1 Configure external device</h4>
<p>Figure 3-4 shows how to configure external bridge. </p><div class="image">
<img src="External_Bridge.png" alt="External_Bridge.png"/>
</div>
 <center><div id="figure_3-4"><b>Figure 3-4 External Bridge</b></div></center><p>If you need to configure an external device, you need to use the TX and RX drop-down boxes in the SPORT Bridge field to configure the external device in one direction. For example, if RX and TX in the Bridge of SPORT0 are configured as External, you need to configure the corresponding pinmux of SPORT0_LRC, SPORT0_BCLK, SPORT0_DACDAT, SPORT0_ADCDAT in the HW Feature tab.</p>
<p>Notes:</p><ol type="1">
<li>When the Role field is set to Master, the Bridge field RX/TX allows users to freely select External/Internal.<br />
 When Role is set to "Slave", the RX/TX of the Bridge field can only be changed to the fixed value "External".</li>
<li>RTL87X3G: For SPORT0/SPORT1, You can configure the Bridge field based on the Role field.</li>
<li>RTL87X3E: For SPORT0/SPORT1, You can configure the Bridge field based on the Role field. For SPORT2, the Rx/Tx of its Bridge field is a fixed value "External ", regardless of its Role.</li>
<li>RTL87X3D: For SPORT0/SPORT1/SPORT2, You can configure the Bridge field based on the Role field. For SPORT3, the Rx/Tx of its Bridge field is the fixed value "External", regardless of its Role value.</li>
</ol>
<h4><a class="anchor" id="Configure_MCLK"></a>
3.2.2 Configure MCLK</h4>
<p>Figure 3-5 shows how to configure MCLK. </p><div class="image">
<img src="MCLK.png" alt="MCLK.png"/>
</div>
 <center><div id="figure_3-5"><b>Figure 3-5 MCLK</b></div></center><p>MCLK is mainly used to configure the mclk sample rate of the external dsp. After RX and TX in the Bridge in SPORTs are configured as External, Frequency configuration takes effect only after MCLK Enable is selected.</p>
<p>Notes:</p><ol type="1">
<li>MCLK Enable: If this option is selected, external mclk configuration is enabled.</li>
<li>MCLK Rate: With the MCLK Enable option checked, the optional mclk rate is 1024KHZ, 1411.2KHZ, 2048KHZ, 2822.4KHZ, 3072KHZ, 4096KHZ, 5644.8KHZ, 6144KHZ, 8192KHZ, 11289.6KHZ, 12288KHZ, 16384KHZ, 22579.2K HZ, 24576KHZ, 32768KHZ.</li>
</ol>
<h4><a class="anchor" id="Configure_BCLK"></a>
3.2.3 Configure BCLK</h4>
<p>Figure 3-6 shows how to configure BCLK. </p><div class="image">
<img src="BCLK.png" alt="BCLK.png"/>
</div>
 <center><div id="figure_3-6"><b>Figure 3-6 BCLK</b></div></center><p>If there is no special requirement, the XTAL crystal oscillator is used as the clock source by default. You can also select PLL as the clock source by using the BCLK SRC drop-down box.</p>
<h4><a class="anchor" id="Configure_SPORT_MODE"></a>
3.2.4 Configure SPORT Mode</h4>
<p>SPORT Mode is configured by default. If you need to configure the Mode fields of TX and RX in SPORTs, the optional value is TDM2/4/6/8.</p>
<p>RTL87X3C&amp;RTL87X3E&amp;RTL87X3G: RX default TDM4,TX default TDM2.<br />
 RTL87X3D: RX default TDM6,TX default TDM2.</p>
<h4><a class="anchor" id="Configure_SPORT_Data_Length"></a>
3.2.5 Configure SPORT Data Length</h4>
<p>Figure 3-7 shows how to configure SPORT Data Length. </p><div class="image">
<img src="Data_Channel_Length.png" alt="Data_Channel_Length.png"/>
</div>
 <center><div id="figure_3-7"><b>Figure 3-7 Data Length</b></div></center><p>SPORT Data Length is configured by default. The Data Length fields of TX and RX in SPORTs need to be configured when there is a special requirement.</p>
<p>For RTL87X3C, RTL87X3E, RTL87X3G and RTL87X3D: Set the Data Length to 24BIT.</p>
<h4><a class="anchor" id="Configure_SPORT_Channel_Length"></a>
3.2.6 Configure SPORT Channel Length</h4>
<p>Figure 3-7 shows how to configure SPORT Channel Length. SPORT Channel Length is configured by default. The Channel Length fields of TX and RX in SPORTs need to be configured when there is a special requirement.</p>
<p>For RTL87X3C:</p><ol type="1">
<li>If Bridge is set to Internal, set Channel Length to 24BIT.</li>
<li>When Bridge is set to External, set Channel Length to 32BIT.</li>
</ol>
<p>For RTL87X3E, RTL87X3G and RTL87X3D: Set the Channel Length to 32BIT.</p>
<h4><a class="anchor" id="Configure_SPORT_Sample_Rate"></a>
3.2.7 Configure SPORT Sample Rate</h4>
<p>Figure 3-8 shows how to configure SPORT Sample Rate. </p><div class="image">
<img src="Gateway_Sample_Rate.png" alt="Gateway_Sample_Rate.png"/>
</div>
 <center><div id="figure_3-8"><b>Figure 3-8 Sample Rate</b></div></center><p>The SPORT Sample Rate is configured by default. If you have special requirements, you need to configure the TX and RX Sample Rate fields in SPORTs. Dynamic indicates that the physical data flow uses its own sample rate, and other fields indicate that the physical data flow uses a fixed sample rate.</p>
<h3><a class="anchor" id="Configure_Codec_Mix"></a>
3.3 Configure Codec Mixing Function</h3>
<p>Definition: Codec provides two mix data nodes, which can ignore the influence of sample rate and simultaneously play mixed data of two or three channels.</p>
<p>Figure 3-9 shows a sample of Codec Mixing function. </p><div class="image">
<img src="Codec_Mix_instance.png" alt="Codec_Mix_instance.png"/>
</div>
 <center><div id="figure_3-9"><b>Figure 3-9 Codec Mixing Sample</b></div></center><p>As shown in Figure 3-9, audio or voice and vp are mixed deployed and played on DAC0.<br />
 For UI confioguration, Codec Mixing supports the configuration of DAC0 and DAC1 to select the mix path of the demand. This field is also configured by default.</p>
<p>Figure 3-10 shows how to configure Codec Mixing. </p><div class="image">
<img src="Codec_Mix_UI.png" alt="Codec_Mix_UI.png"/>
</div>
 <center><div id="figure_3-10"><b>Figure 3-10 Codec Mix UI</b></div></center><p>If you have special requirements, you can configure the following check boxes.</p><ol type="1">
<li>If dac1 is checked in dac0, data from DAC_R can be mixed to DAC_L. DAC_L corresponds to DAC0. DAC_R corresponds to DAC1.</li>
<li>If dac0 is checked in dac1, data from DAC_L can be mixed to DAC_R.</li>
</ol>
<h3><a class="anchor" id="Configure_Codec_Interpolation_Filter"></a>
3.4 Configure Codec Interpolation Filter Type</h3>
<p>When you have the requirement to reduce the latency of DAC Channel, you should configure Codec Interpolation Filter Type.</p>
<p>Figure 3-11 shows how to configure Codec Interpolation Filter Type. </p><div class="image">
<img src="Codec_Interpolation.png" alt="Codec_Interpolation.png"/>
</div>
 <center><div id="figure_3-11"><b>Figure 3-11 Codec Interpolation Filter</b></div></center><p>Each Codec DAC channel can choose either linear or minimum interpolation filter type.</p>
<h3><a class="anchor" id="Configure_Logical_IO"></a>
3.5 Configure Audio Logical Device</h3>
<p>Audio Logic Device supports the configuration of Logic IO parameters for data streams such as Audio, Voice, Record, Line, Ringtone, Voice Prompt, APT, LLAPT, ANC and VAD.</p>
<p>Figure 3-12 shows how to configure audio route path for different Audio Category. </p><div class="image">
<img src="Physical_Path.png" alt="Physical_Path.png"/>
</div>
 <center><div id="figure_3-12"><b>Figure 3-12 Physical Path Configuration</b></div></center><p>If you need to configure the Logical IO parameter for the Audio Category, you should click the appropriate audio category button. The corresponding configuration box will then pop up.</p>
<h4><a class="anchor" id="Configure_Audio_Category"></a>
3.5.1 Configure Audio Category</h4>
<p>Figure 3-13 shows how to configure audio route path for audio category. </p><div class="image">
<img src="Audio_Physical_Path.png" alt="Audio_Physical_Path.png"/>
</div>
 <center><div id="figure_3-13"><b>Figure 3-13 Audio Route Path</b></div></center><p>Audio Category supports Audio Primary Out, Audio Secondary Out, Audio Primary Reference Out and Audio Seconary Reference Out:</p>
<ol type="1">
<li>Audio Primary Out is used to set the Audio physical route of the primary SPK.</li>
<li>Audio Secondary Out is used to set the Audio physical route of the secondary SPK.</li>
<li>Audio Primary Reference Out is used to set the Audio physical AEC loopback path of the primary SPK.</li>
<li>Audio Secondary Reference Out is used to set the Audio physical AEC loopback path of the secondary SPK.</li>
</ol>
<p>Note: When the Record Primary Reference In and Record Secondary Reference In corresponding to the Record Category are also configured, the AEC loopback path of Audio and Record can be really connected. AEC means that linear removal of echo signal mixing in microphone input without affecting the quality of the desired speech signal.</p>
<h4><a class="anchor" id="Configure_Voice_Category"></a>
3.5.2 Configure Voice Category</h4>
<p>Figure 3-14 shows how to configure audio route path for voice category. </p><div class="image">
<img src="Voice_Physical_Path.png" alt="Voice_Physical_Path.png"/>
</div>
 <center><div id="figure_3-14"><b>Figure 3-14 Voice Route Path</b></div></center><p>Voice Category supports Voice Primary Out, Voice Secondary Out, Voice Primary Reference Out, Voice Seconary Reference Out, Voice Primary Reference In, Voice Secondary Reference In, Voice Primary Reference In, Voice Primary In, Voice Secondary In, Voice Fusion In and Voice Bone In:</p>
<ol type="1">
<li>Voice Primary Out is used to set the Voice physical route of the primary SPK.</li>
<li>Voice Secondary Out is used to set the Voice physical route of the secondary SPK.</li>
<li>Voice Primary Reference Out is used to set the Voice physical AEC loopback path of the primary SPK.</li>
<li>Voice Secondary Reference Out is used to set the Voice physical AEC loopback path of the secondary SPK.</li>
<li>Voice Primary Reference In is used to set the Voice physical AEC loopback path of the primary MIC.</li>
<li>Voice Secondary Reference In is used to set the Voice physical AEC loopback path of the secondary MIC.</li>
<li>Voice Primary In is used to set the Voice physical route for the primary MIC.</li>
<li>Voice Secondary In is used to set the Voice physical route of the secondary MIC.</li>
<li>Voice Fusion In is used to set the Voice physical route for fusion MIC.</li>
<li>Voice Bone In is used to set the Voice physical route for the bonse sensor MIC.<br />
</li>
</ol>
<p>Note:</p><ol type="1">
<li>The Voice Secondary In can be configured only after Enable Voice Dual Mic is selected in the HW Feature tab. This linkage will be removed from the future version and opened directly on the audio route module. <div class="image">
<img src="Voice_Dual_Mic.png" alt="Voice_Dual_Mic.png"/>
</div>
 <center><div id="figure_3-15"><b>Figure 3-15 Voice Dual Mic</b></div></center></li>
<li>When the Voice Primary Reference Out and Voice Primary Reference In corresponding to the Voice Category, or when the Voice Secondary Reference Out and Voice Secondary Reference In are configured, the AEC loopback path is actually connected.</li>
</ol>
<h4><a class="anchor" id="Configure_Record_Category"></a>
3.5.3 Configure Record Category</h4>
<p>Figure 3-16 shows how to configure audio route path for record category. </p><div class="image">
<img src="Record_Physical_Path.png" alt="Record_Physical_Path.png"/>
</div>
 <center><div id="figure_3-16"><b>Figure 3-16 Record Route Path</b></div></center><p>Record Category supports Record Primary In, Record Secondary In, Record Primary Reference In, Record Secondary Reference In, Record Left AUX, Record Right AUX, Record Fusion In and Record Bone In:</p>
<ol type="1">
<li>Record Primary In is used to set the Record physical route of the primary MIC.</li>
<li>Record Secondary In is used to set the Record physical route of the secondary MIC.</li>
<li>Record Primary Reference In is used to set the Record physical AEC loopback path of the primary MIC.</li>
<li>Record Secondary Reference In is used to set the Record physical AEC loopback path of the secondary MIC.</li>
<li>Record Left AUX is used to set the Record physical route for the AUX left channel.</li>
<li>Record Right AUX is used to set the physical route of the Record the AUX right channel.</li>
<li>Record Fusion In is used to set the Record physical route of fusion MIC.</li>
<li>Record Bone In is used to set the Record physical route of the bonse sensor MIC.</li>
</ol>
<p>Note: When the Primary Reference SPK and Secondary Reference SPK corresponding to Audio Category, Ringtone Category or Voice Prompt Category are configured, The AEC loopback path for Audio and Record, Ringtone and Record, or Voice Prompt and Record is open.</p>
<h4><a class="anchor" id="Configure_Line_Category"></a>
3.5.4 Configure Line Category</h4>
<p>Figure 3-17 shows how to configure audio route path for line category. </p><div class="image">
<img src="Audio_Line_Physical_Path.png" alt="Audio_Line_Physical_Path.png"/>
</div>
 <center><div id="figure_3-17"><b>Figure 3-17 Line Route Path</b></div></center><p>Line Category supports Line Primary Out, Line Secondary Out, Line Primary Reference Out, Line Seconary Reference Out, Line Category Line primary Out, Line secondary Out, Line primary reference Out, Line seconary referenceOut, Line Left AUX-IN, Line Right AUX-IN, Line Primary Reference In and Line Secondary Reference In:</p>
<ol type="1">
<li>Line Primary Out is used to set the Line physical route of the primary SPK.</li>
<li>Line Secondary Out is used to set the Line physical route of the secondary SPK.</li>
<li>Line Primary Reference Out is used to set the Line physical AEC loopback path of the primary SPK.</li>
<li>Line Secondary Reference Out is used to set the Line physical AEC loopback path of the secondary SPK.</li>
<li>Line Primary Reference In is used to set the Line physical AEC loopback path of the primary MIC.</li>
<li>Line Secondary Reference In Is used to set the Line physical AEC loopback path of the secondary MIC.</li>
<li>Line Primary In is used to set the Line physical route of the primary MIC.</li>
<li>Line Secondary In is used to set the Line physical route of the Line secondary MIC.</li>
<li>Line Left AUX is used to set the Line physical route for the AUX left channel.</li>
<li>Line Right AUX is used to set the physical route of the Line the AUX right channel.</li>
</ol>
<p>Note: When the Line Primary Reference Out and Line Primary Reference In corresponding to the Line Category, or when the Line Secondary Reference Out and Line Secondary Reference In are configured, the loopback path of the AEC is actually connected.</p>
<div style="page-break-after: always;"></div> <h4><a class="anchor" id="Configure_Ringtone_Category"></a>
3.5.5 Configure Ringtone Category</h4>
<p>Figure 3-18 shows how to configure audio route path for Ringtone category. </p><div class="image">
<img src="Ringtone_Physical_Path.png" alt="Ringtone_Physical_Path.png"/>
</div>
 <center><div id="figure_3-18"><b>Figure 3-18 Ringtone Route Path</b></div></center><p>Ringtone Category supports Ringtone Primary Out, Ringtone Secondary Out, Ringtone Primary Reference Out and Ringtone Seconary Reference Out:</p>
<ol type="1">
<li>Ringtone Primary Out is used to set the Ringtone physical route of the primary SPK.</li>
<li>Ringtone Secondary Out is used to set the Ringtone physical route of the secondary SPK.</li>
<li>Ringtone Primary Reference Out is used to set the Ringtone physical AEC loopback path of the primary SPK.</li>
<li>Ringtone Secondary Reference Out is used to set the Ringtone physical AEC loopback path of the secondary SPK.</li>
</ol>
<p>Note: When the Record Primary Reference In and Record Secondary Reference In corresponding to the Record Category are also configured, The AEC loopback path of Ringtone and Record is really open.</p>
<h4><a class="anchor" id="Configure_Voice_Prompt_Category"></a>
3.5.6 Configure Voice Prompt Category</h4>
<p>Figure 3-19 shows how to configure audio route path for Voice Prompt category. </p><div class="image">
<img src="Voice_Prompt_Physical_Path.png" alt="Voice_Prompt_Physical_Path.png"/>
</div>
 <center><div id="figure_3-19"><b>Figure 3-19 Voice Prompt Route Path</b></div></center><p>Voice Prompt Category supports Voice Prompt Primary Out, Voice Prompt Secondary Out, Voice Prompt Primary Reference Out and Voice Prompt Seconary Reference Out:</p>
<ol type="1">
<li>Voice Prompt Primary Out is used to set the Voice Prompt physical route path of the primary SPK.</li>
<li>Voice Prompt Secondary Out is used to set the Voice Prompt physical route path of the secondary SPK.</li>
<li>Voice Prompt Primary Reference Out is used to set the physical AEC loopback path of the Voice Prompt in the primary SPK.</li>
<li>Voice Prompt Secondary Reference Out is used to set the physical AEC loopback path of the Voice Prompt of the secondary SPK.</li>
</ol>
<p>Note: When the Record Primary Reference In and Record Secondary Reference In corresponding to the Record Category are also configured, The AEC loopback path of the Voice Prompt and the Record is really open.</p>
<h4><a class="anchor" id="Configure_APT_Category"></a>
3.5.7 Configure APT Category</h4>
<p>Figure 3-20 shows how to configure audio route path for APT category. </p><div class="image">
<img src="APT_Physical_Path.png" alt="APT_Physical_Path.png"/>
</div>
 <center><div id="figure_3-20"><b>Figure 3-20 APT Route Path</b></div></center><p>APT Category supports APT Primary Out, APT Secondary Out, APT Primary Reference Out, APT Seconary Reference Out, APT Primary Reference In, APT Secondary Reference In, APT Primary Left In, APT Primary Right In, APT Secondary Left In and APT Secondary Right In:</p>
<ol type="1">
<li>APT Primary Out is used to set the APT physical route of the primary SPK.</li>
<li>APT Secondary Out is used to set the APT physical route of the secondary SPK.</li>
<li>APT Primary Reference Out is used to set the APT physical AEC loopback path of the primary SPK.</li>
<li>APT Secondary Reference Out is used to set the APT physical AEC loopback path of the secondary SPK.</li>
<li>APT Primary Reference In is used to set the APT physical AEC loopback channel of the primary MIC.</li>
<li>APT Secondary Reference In is used to set the APT physical AEC loopback channel of the secondary MIC.</li>
<li>APT Primary Left In is used to set the APT physical route of the primary left MIC.</li>
<li>APT Primary Right In is used to set the APT physical route of the primary right MIC.</li>
<li>APT Secondary Left In is used to set the APT physical route of the secondary left MIC.</li>
<li>APT Secondary Right In is used to set the APT physical route of the secondary right MIC.</li>
</ol>
<p>Note:</p><ol type="1">
<li>APT Primary Left In can be configured only after Enable Normal APT is checked in the HW Feature tab. This linkage will be removed from the future version and opened directly on AudioRoute. <div class="image">
<img src="Enable_APT.png" alt="Enable_APT.png"/>
</div>
 <center><div id="figure_3-21"><b>Figure 3-21 Enable APT UI</b></div></center></li>
<li>When APT Primary Reference Out and APT Primary Reference In corresponding to APT Category, Or when APT Secondary Reference Out and APT Secondary Reference In are configured, the AEC loopback path can be really opened.</li>
</ol>
<h4><a class="anchor" id="Configure_LLAPT_Category"></a>
3.5.8 Configure LLAPT Category</h4>
<p>Figure 3-22 shows how to configure audio route path for LLAPT category. </p><div class="image">
<img src="LLAPT_Physical_Path.png" alt="LLAPT_Physical_Path.png"/>
</div>
 <center><div id="figure_3-22"><b>Figure 3-22 LLAPT Route Path</b></div></center><p>LL-APT Category supports LL-APT Primary Out, LL-APT Secondary Out, LL-APT Primary Reference Out, LL-APT Seconary Reference Out, LL-APT Primary Reference In, LL-APT Secondary Reference In, LL-APT Left In and LL-APT Right In:</p>
<ol type="1">
<li>LL-APT Primary Out is used to set the LL-APT physical route of the primary SPK.</li>
<li>LL-APT Secondary Out is used to set the LL-APT physical route of the secondary SPK.</li>
<li>LL-APT Primary Reference Out is used to set the LL-APT physical AEC loopback path of the primary SPK.</li>
<li>LL-APT Secondary Reference Out is used to set the LL-APT physical AEC loopback path of the secondary SPK.</li>
<li>LL-APT Primary Reference In is used to set the LL-APT physical AEC loopback path of the primary MIC.</li>
<li>LL-APT Secondary Reference In is used to set the LL-APT physical AEC loopback path of the secondary MIC.</li>
<li>LL-APT Left In is used to set the LL-APT physical route of the left MIC.</li>
<li>LL-APT Right In is used to set the LL-APT physical route of the right MIC.</li>
</ol>
<p>Note:</p><ol type="1">
<li>LL-APT Left In and LL-APT Right In can be configured only after Enable Low Latency APT is selected in the HW Feature tab. This linkage will be removed from the future version and opened directly on audio route module.</li>
<li>When LL-APT Primary Reference Out and LL-APT Primary Reference In corresponding to LL-APT Category, Or when the LL-APT Secondary Reference Out and LL-APT Secondary Reference In are configured, the AEC loopback path can be really connected.</li>
</ol>
<div style="page-break-after: always;"></div> <h4><a class="anchor" id="Configure_ANC_Category"></a>
3.5.9 Configure ANC Category</h4>
<p>Figure 3-23 shows how to configure audio route path for ANC category. </p><div class="image">
<img src="ANC_Physical_Path.png" alt="ANC_Physical_Path.png"/>
</div>
 <center><div id="figure_3-23"><b>Figure 3-23 ANC Route Path</b></div></center><p>ANC Category supports ANC Primary Out, ANC Secondary Out, ANC Primary Reference Out, ANC Seconary Reference Out, ANC Seconary Reference Out, ANC Primary Reference In, ANC Secondary Reference In, ANC FF Left In, ANC FF Right In, ANC FB Left In and ANC FB Right In:</p>
<ol type="1">
<li>ANC Primary Out is used to set the ANC physical route of the primary SPK.</li>
<li>ANC Secondary Out is used to set ANC physical route of secondary SPK.</li>
<li>ANC Primary Reference Out is used to set the ANC physical AEC loopback path of the primary SPK.</li>
<li>ANC Secondary Reference Out is used to set the ANC physical AEC loopback path of the secondary SPK.</li>
<li>ANC Primary Reference In is used to set the ANC physical AEC loopback path of the primary MIC.</li>
<li>ANC Secondary Reference In is used to set ANC physical AEC loopback path of secondary MIC.</li>
<li>ANC FF Left In is used to set the ANC physical route with Feedforward left MIC.</li>
<li>ANC FF Right In is used to set the ANC physical route with Feedforward right MIC.</li>
<li>ANC FB Left In is used to set the ANC physical route of Feddback left MIC.</li>
<li>ANC FB Right In is used to set ANC physical route of Feddback right MIC.</li>
</ol>
<p>Note:</p><ol type="1">
<li>ANC FF In can be configured only when ANC Type in HW Feature tab is set to ANC FF Only. <br />
 ANC FB MIC can be configured only when ANC FB Only is set to ANC Hybrid. <br />
 ANC FF MIC and ANC FB MIC can be configured simultaneously.</li>
<li>When ANC Primary Reference Out and ANC Primary Reference In corresponding to ANC Category, Or when the ANC Secondary Reference Out and ANC Secondary Reference In are well configured, the AEC loopback path can be really opened.</li>
</ol>
<div style="page-break-after: always;"></div> <h4><a class="anchor" id="Configure_VAD_Category"></a>
3.5.10 Configure VAD Category</h4>
<p>Figure 3-24 shows how to configure audio route path for VAD category. </p><div class="image">
<img src="VAD_Physical_Path.png" alt="VAD_Physical_Path.png"/>
</div>
 <center><div id="figure_3-24"><b>Figure 3-24 VAD Route Path</b></div></center><p>VAD Category supports VAD Primary Reference In, VAD Secondary Reference In, VAD Primary In, and VAD Secondary In:</p>
<ol type="1">
<li>VAD Reference In is used to set the loopback path of the VAD physical AEC for the MIC.</li>
<li>VAD Secondary Reference In is used to set VAD physical AEC loopback path of secondary MIC.</li>
<li>VAD Primary In is used to set the VAD physical route of the primary MIC.</li>
<li>VAD Secondary In is used to set the VAD physical route of the secondary MIC.</li>
</ol>
<h4><a class="anchor" id="Configure_AEC_REF"></a>
3.5.11 Configure AEC_REF</h4>
<p>Figure 3-25 shows the working principle of the AEC_REF function. </p><div class="image">
<img src="AEC_REF.png" alt="AEC_REF.png"/>
</div>
 <center><div id="figure_3-25"><b>Figure 3-25 AEC REF</b></div></center><p>AEC_REF: Linear removal of echo signal mixing in microphone input without affecting the quality of the desired speech signal.<br />
 For UI configuration, when you need to configure the AEC_REF function, select Primary Reference Out and Primary Reference In of Audio Category. The AEC_REF configuration can be performed in the following three cases:</p>
<p>Figure 3-26 shows three types of AEC_REF functions. </p><div class="image">
<img src="AEC_REF_Cases.png" alt="AEC_REF_Cases.png"/>
</div>
 <center><div id="figure_3-26"><b>Figure 3-26 AEC REF Cases</b></div></center><ol type="1">
<li>Case1: REF signal from HW Codec DAC[5M]=&gt;ADC[5M]=&gt;SPORT RX=&gt;DSP<br />
 In this case, select Primary Reference Out and Primary Reference In and set them as Reference Speaker and Reference Mic for UI configuration. There are three existing requirements as follows:<br />
 Audio Primary Reference Out + Record Primary Reference In: DAC1-&gt;ADC3.<br />
 Figure 3-27 shows the UI configuration of AEC_REF function between Audio and Record. <div class="image">
<img src="Audio_Record_AEC.png" alt="Audio_Record_AEC.png"/>
</div>
 <center><div id="figure_3-27"><b>Figure 3-27 AEC REF between Audio and Record</b></div></center> Voice Primary Reference Out + Voice Primary Reference In: DAC1-&gt;ADC3.<br />
 Figure 3-28 shows the UI configuration of AEC_REF function of Voice. <div class="image">
<img src="Voice_AEC.png" alt="Voice_AEC.png"/>
</div>
 <center><div id="figure_3-28"><b>Figure 3-28 AEC REF of Voice</b></div></center> RHA ref: Apt_Pri_Ref_Out + Apt_Pri_Ref_In: DAC0-&gt;ADC2.<br />
 Figure 3-29 shows the UI configuration of AEC_REF function of APT. <div class="image">
<img src="APT_AEC.png" alt="APT_AEC.png"/>
</div>
 <center><div id="figure_3-29"><b>Figure 3-29 AEC REF of APT</b></div></center></li>
<li>Case2: REF signal from HW Codec DAC[5M]=&gt;DAC[Analog]=&gt;ADC[5M]=&gt;SPORT RX=&gt;DSP.<br />
 In this case, for UI configuration, select Primary Reference Out and set them to physical speaker and select Primary Reference In and set them to physical mic.<br />
 Figure 3-30 shows the UI configuration of AEC_REF function for the second case. <div class="image">
<img src="Second_AEC.png" alt="Second_AEC.png"/>
</div>
 <center><div id="figure_3-30"><b>Figure 3-30 AEC REF of the second case</b></div></center></li>
<li>Case3: REF signal from External Codec DAC=&gt; ADC=&gt;SPORT RX=&gt;DSP.<br />
 In this case, for UI configuration, select Primary Reference Out and configure Primary Reference In as External Speaker and External Mic. Figure 3-31 shows the UI configuration of AEC_REF function for the third case. <div class="image">
<img src="Third_AEC.png" alt="Third_AEC.png"/>
</div>
 <center><div id="figure_3-31"><b>Figure 3-31 AEC REF of the third case</b></div></center></li>
</ol>
<p>Notes:</p><ol type="1">
<li>On RTL87X3C, DAC0 can only loopback to ADC2 and DAC1 can only loopback to ADC3.</li>
<li>On RTL87X3G, DAC0 can only loopback to ADC2 and DAC1 can only loopback to ADC3.</li>
<li>On RTL87X3E, DAC0 can loopback to ADCn(n = 0, 2, 4), DAC1 can loopback to ADCm(m = 1, 3, 5).</li>
<li>On RTL87X3D, DAC0 can loopback to ADCn(n = 0, 2, 4), DAC1 can loopback to ADCm(m = 1, 3, 5). </li>
</ol>
</div></div><!-- contents -->

<HR SIZE=5>
<font size="3" color="black">Copyright(c) 2020, <a href=" http://www.realtek.com.tw/"><font size="3" color="#6FB7B7"><b>Realtek Semiconductor Corporation</b></font></a>. All rights reserved.</font> 
